{"version":3,"sources":["webpack:///main.60520676bce6cba89df2.bundle.js","webpack:///./~/angular2-hmr/src/hmr-decorator.ts","webpack:///./~/angular2-hmr/src/hmr-store.ts","webpack:///./~/angular2-hmr/src/index.ts","webpack:///./~/angular2-hmr/src/webpack-hmr.ts","webpack:///./~/normalize.css/normalize.css","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.css","webpack:///./src/app/app.service.ts","webpack:///./src/app/game/game.component.ts","webpack:///./src/app/game/game.css","webpack:///./src/app/game/game.html","webpack:///./src/app/game/index.ts","webpack:///./src/app/home/home.component.ts","webpack:///./src/app/home/home.css","webpack:///./src/app/home/home.html","webpack:///./src/app/home/index.ts","webpack:///./src/app/index.ts","webpack:///./src/app/online/currentUserFilter.pipe.ts","webpack:///./src/app/online/domain/index.ts","webpack:///./src/app/online/domain/login/index.ts","webpack:///./src/app/online/domain/match/FBLiveMatch.ts","webpack:///./src/app/online/domain/match/FBMatches.ts","webpack:///./src/app/online/domain/match/Match.ts","webpack:///./src/app/online/domain/match/index.ts","webpack:///./src/app/online/domain/user_bus/BusMessage.ts","webpack:///./src/app/online/domain/user_bus/FBUserBus.ts","webpack:///./src/app/online/domain/user_bus/FBUserBusFactory.service.ts","webpack:///./src/app/online/domain/user_bus/index.ts","webpack:///./src/app/online/domain/users/FBUser.ts","webpack:///./src/app/online/domain/users/FBUsers.service.ts","webpack:///./src/app/online/domain/users/User.ts","webpack:///./src/app/online/domain/users/index.ts","webpack:///./src/app/online/index.ts","webpack:///./src/app/online/online.component.ts","webpack:///./src/app/online/online.css","webpack:///./src/app/online/online.html","webpack:///./src/app/online/onlineFilter.pipe.ts","webpack:///./src/main.browser.ts","webpack:///./src/platform/browser/angular2-material2/index.ts","webpack:///./src/platform/browser/directives.ts","webpack:///./src/platform/browser/firebase/index.ts","webpack:///./src/platform/browser/index.ts","webpack:///./src/platform/browser/pipes.ts","webpack:///./src/platform/browser/providers.ts","webpack:///./src/platform/environment.ts"],"names":["webpackJsonp","617","module","exports","__webpack_require__","setDev","newDev","_dev","indexOf","Error","HmrState","namespaceOrConfig","config","decoratorFactory","target","decoratedPropertyName","descriptor","key","constructor","name","hmr_store_1","HmrStore","select","get","Object","defineProperty","set","newValue","currentValue","assign","_initialValues","enumerable","configurable","_env","process","ENV","NODE_ENV","HMR","undefined","144","OpaqueToken","_desc","this","prototype","toString","HMR_STATE","prop","value","_state","getState","_states","push","defaultData","currentData","dispose","initialState","reduce","memo","item","toJSON","dev","618","__export","m","p","hasOwnProperty","provideHmrState","provide","useValue","619","hotModuleReplacement","bootloader","options","appState","json","LOCAL","console","time","localStorage","setItem","LOCALSTORAGE_KEY","JSON","stringify","timeEnd","beforeunload","event","injector","COMPONENT_REF","getOptional","TOKEN","GET_STATE","hot","warn","document","addEventListener","storeToken","DISPOSE","globalDispose","DATA","data","state","disposed","log","parse","getItem","e","readyState","then","cmpRef","window","removeEventListener","removeItem","accept","componentNode","location","nativeElement","newNode","createElement","tagName","currentDisplay","style","display","parentNode","insertBefore","destroy","549","503","core_1","router_deprecated_1","app_service_1","home_1","game_1","online_1","domain_1","App","loading","__decorate","Component","selector","pipes","providers","FIREBASE_DOMAIN_PROVIDERS","slice","encapsulation","ViewEncapsulation","None","styles","template","RouteConfig","path","component","Home","useAsDefault","Game","Online","__metadata","AppState","550","213","angular2_hmr_1","_clone","object","Injectable","504","sidenav_1","ng2_chess_1","dom_svg_board_1","chessjs_ai_1","Player","color","type","aiIndex","PlayerType","aiLevels","black","PieceColor","BLACK","AI","white","WHITE","HUMAN","workerSupported","ngAfterViewInit","_this","ctrl","board","init","sidenav","toggle","ngOnDestroy","onPlayerTypeChange","player","setPlayer","onAILevelChange","$event","Number","srcElement","selectedIndex","getLevel","onNewGame","newGame","isInit","onStop","aiStop","hint","aiNextMove","mv","highlight","to","from","idx","ViewChild","MdSidenav","ChessBoard","CHESSJS_AI_CHESS_GAME_PROVIDERS","directives","DOM_SVG_KIT_DIRECTIVES","551","552","505","506","chessjs_1","CHESSJS_CHESS_GAME_PROVIDERS","553","554","507","508","app_service_2","APP_PROVIDERS","509","CurrentUserFilter","transform","user$key","filter","u","$key","Pipe","355","login_1","users_1","match_1","user_bus_1","LoginFirebase","FBUsers","FBMatches","FBUserBusFactory","356","angularfire2_1","PromiseCompleter","promise","Promise","res","rej","resolve","reject","af","logout","auth","facebook","login","provider","AuthProviders","Facebook","method","AuthMethods","Popup","twitter","Twitter","Redirect","AngularFire","357","FBLiveMatch","matchSvc","match$key","user","moves","w","b","rxWaste","match$","getMatch$","blackMoves$","getMatchMoves$","whiteMoves$","subscribe","myMoves$","movesValid","l","length","turn","myTurn","match","setState","getMatchMetaState$","mySide","setMove","move","sendMsg","opponent$key","msgFactory","unsubscribe","pop","load","matchId","liveMatch","FBLiveMatch_","take","toPromise","pc","_super","apply","arguments","__extends","510","Match_1","FBLiveMatch_1","createMatch","mref","Match","settings","database","loadMatch","side","list","getMatchMeta$","358","MATCH_TYPE","SuddenDeath","blackMeta","MatchRefState","Ready","whiteMeta","214","FBMatches_1","359","validate","bus","BUS_MESSAGE_TYPE","typeValidators","validators","i","err","register","validator","Array","isArray","END_GAME_REQUEST_TYPE","BusMessage","sender","timestamp","Date","now","MessageFactory","senderId","invite","create","Invite","token","inviteResponse","response","reason","Move","outOfSync","OutOfSync","invalid","orgMessage","Invalid","endGame","endGameRequest","EndGame","isInvite","msg","isMove","isOutOfSync","isInvalid","360","ReplaySubject_1","FBUserBus","_subject","ReplaySubject","incoming$","asObservable","getUserBus$","remove","onIncomingMessage","send","id","message","messages","_i","messages_1","removeBusMessage","next","511","node_uuid_1","BusMessage_1","FBUserBus_1","url","busMsg","v1","error","msg$key","138","FBUserBusFactory_service_1","361","index_1","FBUser","users","user$","getUser$","matchRefs$","getMatchRefs$","map","refs","forEach","user_","getUser","update","setPlaying","playing","keepAlive","getUserResource$","getTime","invitee","createMatchRef","MatchRefRole","Inviter","responedToInvite","acceptInvitation","updateMatchRefState","catch","withdrawInvitation","notify","all","getMatchRef$","role","uuid","getMatchRefState$","getMatchRef","512","Subject_1","User_1","FBUser_1","match_refs","currentUserEmitter","Subject","currentUser$","users$","subscription","uid","User","authDone","resource","set$Key","matchRef$key","VALID_FB_KEY","obj","k","exec","362","info","displayName","pic","profileImageURL","139","FBUsers_service_1","513","514","currentUserFilter_pipe_1","onlineFilter_pipe_1","subs","first","setTimeout","clearCode","setInterval","clearInterval","subs_1","onBusMessage","onAvailabilityChange","available","checked","userStatus","isFree","canInvite","su","selectedUser","acceptInvite","initGame","InPlay","onMoved$","pieceColor","blockUi","toLongAlgebraic","GAME_STATE","ACTIVE","CHECK","endGameRoutine","Done","tryHandleInviteResponse","isMatchOf","tryMoveOpponent","Canceled","Invitee","chessMove","util","fromLongAlgebraic","piece","getPiece","block","getBlock","promotion","r","OnlineFilter","555","556","515","d","gap","lastSeen","0","main","initialHmrState","platform_browser_dynamic_1","bootstrap","app_1","browser_1","PROVIDERS","concat","environment_1","ENV_PROVIDERS","DIRECTIVES","PIPES","371","button_1","card_1","checkbox_1","input_1","list_1","progress_bar_1","progress_circle_1","radio_1","toolbar_1","icon_1","MATERIAL_PIPES","MATERIAL_DIRECTIVES","MD_SIDENAV_DIRECTIVES","MdAnchor","MdButton","MdToolbar","MdCheckbox","MdRadioButton","MdRadioGroup","MdSpinner","MdProgressBar","MdProgressCircle","MD_INPUT_DIRECTIVES","MD_LIST_DIRECTIVES","MD_CARD_DIRECTIVES","MD_ICON_DIRECTIVES","MATERIAL_PROVIDERS","MdRadioDispatcher","MdIconRegistry","543","angular2_material2_1","APPLICATION_DIRECTIVES","ROUTER_DIRECTIVES","PLATFORM_DIRECTIVES","multi","544","FIREBASE_PROVIDERS","defaultFirebase","545","546","APPLICATION_PIPES","PLATFORM_PIPES","547","common_1","http_1","firebase_1","APPLICATION_PROVIDERS","FORM_PROVIDERS","HTTP_PROVIDERS","ROUTER_PROVIDERS","LocationStrategy","useClass","HashLocationStrategy","548","enableProdMode"],"mappings":"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","file":"main.60520676bce6cba89df2.bundle.js","sourcesContent":["webpackJsonp([3],{\n\n/***/ 617:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar hmr_store_1 = __webpack_require__(144);\n\t// noop in parentNode\n\t// TODO: find a better way to noop\n\tvar _env = typeof process !== 'undefined' &&\n\t    process &&\n\t    ({\"ENV\":\"production\",\"NODE_ENV\":\"production\",\"HMR\":false}) &&\n\t    ((\"production\") ||\n\t        (\"production\"));\n\tvar _dev = ((_env &&\n\t    typeof _env === 'string' &&\n\t    (_env.indexOf('dev') > -1)) ||\n\t    _env === undefined);\n\tfunction setDev(newDev) {\n\t    if (typeof newDev === 'string') {\n\t        return _dev = (newDev.indexOf('dev') > -1);\n\t    }\n\t    else if (typeof newDev === 'boolean') {\n\t        return _dev = newDev;\n\t    }\n\t    throw new Error('Please provide a string or boolean');\n\t}\n\texports.setDev = setDev;\n\tfunction HmrState(namespaceOrConfig, config) {\n\t    function decoratorFactory(target, decoratedPropertyName, descriptor) {\n\t        if (!_dev) {\n\t            return descriptor;\n\t        }\n\t        var key = namespaceOrConfig || target.constructor.name + '#' + decoratedPropertyName;\n\t        hmr_store_1.HmrStore.select(key, function () { return hmr_store_1.HmrStore.get(key); });\n\t        Object.defineProperty(target, decoratedPropertyName, {\n\t            get: function () { return hmr_store_1.HmrStore.get(key); },\n\t            set: function (newValue) {\n\t                var currentValue = hmr_store_1.HmrStore.get(key);\n\t                if (!currentValue) {\n\t                    hmr_store_1.HmrStore._initialValues[key] = newValue;\n\t                }\n\t                else {\n\t                    newValue = Object.assign(newValue, currentValue);\n\t                }\n\t                return hmr_store_1.HmrStore.set(key, newValue);\n\t            },\n\t            enumerable: true,\n\t            configurable: true\n\t        });\n\t        return descriptor;\n\t    }\n\t    return decoratorFactory;\n\t}\n\texports.HmrState = HmrState;\n\n\n/***/ },\n\n/***/ 144:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tvar OpaqueToken = (function () {\n\t    function OpaqueToken(_desc) {\n\t        this._desc = _desc;\n\t    }\n\t    OpaqueToken.prototype.toString = function () { return \"Token \" + this._desc; };\n\t    return OpaqueToken;\n\t}());\n\texports.OpaqueToken = OpaqueToken;\n\texports.HMR_STATE = new OpaqueToken('hmrState');\n\tvar HmrStore = (function () {\n\t    function HmrStore() {\n\t    }\n\t    HmrStore.set = function (prop, value) {\n\t        HmrStore._state[prop] = value;\n\t        return HmrStore._state[prop];\n\t    };\n\t    HmrStore.get = function (prop) {\n\t        return HmrStore._state[prop];\n\t    };\n\t    HmrStore.select = function (name, getState) {\n\t        HmrStore._states.push({ name: name, getState: getState });\n\t        var defaultData = getState();\n\t        var currentData = HmrStore.get(name);\n\t        if (defaultData && !currentData) {\n\t            return HmrStore.set(name, defaultData);\n\t        }\n\t        else if (defaultData && currentData) {\n\t            return HmrStore.set(name, Object.assign({}, defaultData, currentData));\n\t        }\n\t        else {\n\t            return HmrStore.set(name, currentData || defaultData);\n\t        }\n\t    };\n\t    HmrStore.dispose = function () {\n\t        HmrStore._states = [];\n\t        HmrStore._state = {};\n\t        HmrStore._initialValues = {};\n\t    };\n\t    HmrStore.getState = function () {\n\t        var initialState = Object.assign({}, HmrStore._state);\n\t        return HmrStore._states\n\t            .reduce(function (memo, item) {\n\t            memo[item.name] = item.getState();\n\t            return memo;\n\t        }, initialState);\n\t    };\n\t    HmrStore.toJSON = function () {\n\t        return HmrStore.getState();\n\t    };\n\t    HmrStore.dev = false;\n\t    HmrStore._state = {};\n\t    HmrStore._initialValues = {};\n\t    HmrStore._states = [];\n\t    return HmrStore;\n\t}());\n\texports.HmrStore = HmrStore;\n\n\n/***/ },\n\n/***/ 618:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tfunction __export(m) {\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t}\n\tvar hmr_store_1 = __webpack_require__(144);\n\t__export(__webpack_require__(619));\n\t__export(__webpack_require__(617));\n\t__export(__webpack_require__(144));\n\tfunction provideHmrState(initialState) {\n\t    if (initialState === void 0) { initialState = {}; }\n\t    return [\n\t        { provide: hmr_store_1.HMR_STATE, useValue: initialState },\n\t        { provide: hmr_store_1.HmrStore, useValue: hmr_store_1.HmrStore }\n\t    ];\n\t}\n\texports.provideHmrState = provideHmrState;\n\n\n/***/ },\n\n/***/ 619:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar hmr_store_1 = __webpack_require__(144);\n\tfunction hotModuleReplacement(bootloader, module, options) {\n\t    if (options === void 0) { options = {}; }\n\t    if (!module.hot) {\n\t        console.warn('Warning: please use webpack hot flag');\n\t        return document.addEventListener('DOMContentLoaded', function () { return bootloader(); });\n\t    }\n\t    hmr_store_1.HmrStore.dev = true;\n\t    var LOCALSTORAGE_KEY = options.LOCALSTORAGE_KEY || '@@WEBPACK_INITIAL_DATA';\n\t    var LOCAL = options.localStorage || false;\n\t    var TOKEN = options.storeToken || hmr_store_1.HmrStore;\n\t    var DISPOSE = options.globalDispose || 'WEBPACK_HMR_beforeunload';\n\t    var GET_STATE = options.getState || getState;\n\t    var DATA = options.data || module.hot.data && module.hot.data.state;\n\t    var COMPONENT_REF = null;\n\t    var disposed = false;\n\t    function getState(appState) {\n\t        var json = appState.toJSON();\n\t        if (LOCAL) {\n\t            console.time('localStorage');\n\t            localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(appState));\n\t            console.timeEnd('localStorage');\n\t        }\n\t        return json;\n\t    }\n\t    console.log('DATA', DATA);\n\t    if (!DATA && LOCAL) {\n\t        try {\n\t            console.time('start localStorage');\n\t            DATA = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY)) || DATA;\n\t            console.timeEnd('start localStorage');\n\t        }\n\t        catch (e) {\n\t            console.log('JSON.parse Error', e);\n\t        }\n\t    }\n\t    console.time('bootstrap');\n\t    if (document.readyState === 'complete') {\n\t        bootloader(DATA)\n\t            .then(function (cmpRef) { return COMPONENT_REF = cmpRef; })\n\t            .then((function (cmpRef) { return (console.timeEnd('bootstrap'), cmpRef); }));\n\t    }\n\t    else {\n\t        document.addEventListener('DOMContentLoaded', function () {\n\t            bootloader(DATA)\n\t                .then(function (cmpRef) { return COMPONENT_REF = cmpRef; })\n\t                .then((function (cmpRef) { return (console.timeEnd('bootstrap'), cmpRef); }));\n\t        });\n\t    }\n\t    function beforeunload(event) {\n\t        var injector = COMPONENT_REF.injector;\n\t        var appState;\n\t        if ('getOptional' in injector) {\n\t            appState = COMPONENT_REF.injector.getOptional(TOKEN) || TOKEN;\n\t        }\n\t        else {\n\t            appState = COMPONENT_REF.injector.get(TOKEN, TOKEN);\n\t        }\n\t        return GET_STATE(appState);\n\t    }\n\t    window[DISPOSE] = function () {\n\t        disposed = true;\n\t        window.removeEventListener('beforeunload', beforeunload);\n\t        if (LOCAL) {\n\t            localStorage.removeItem(LOCALSTORAGE_KEY);\n\t        }\n\t    };\n\t    module.hot.accept();\n\t    window.addEventListener('beforeunload', beforeunload);\n\t    module.hot.dispose(function (data) {\n\t        console.time('dispose');\n\t        var componentNode = COMPONENT_REF.location.nativeElement;\n\t        var newNode = document.createElement(componentNode.tagName);\n\t        // display none\n\t        var currentDisplay = newNode.style.display;\n\t        newNode.style.display = 'none';\n\t        var parentNode = componentNode.parentNode;\n\t        parentNode.insertBefore(newNode, componentNode);\n\t        var injector = COMPONENT_REF.injector;\n\t        var appState;\n\t        if ('getOptional' in injector) {\n\t            appState = COMPONENT_REF.injector.getOptional(TOKEN) || TOKEN;\n\t        }\n\t        else {\n\t            appState = COMPONENT_REF.injector.get(TOKEN, TOKEN);\n\t        }\n\t        var json = GET_STATE(appState, COMPONENT_REF);\n\t        data.state = json;\n\t        if ('destroy' in COMPONENT_REF) {\n\t            COMPONENT_REF.destroy();\n\t        }\n\t        else if ('dispose' in COMPONENT_REF) {\n\t            COMPONENT_REF.dispose();\n\t        }\n\t        newNode.style.display = currentDisplay;\n\t        if (!disposed) {\n\t            window.removeEventListener('beforeunload', beforeunload);\n\t        }\n\t        disposed = true;\n\t        console.timeEnd('dispose');\n\t    });\n\t}\n\texports.hotModuleReplacement = hotModuleReplacement;\n\n\n/***/ },\n\n/***/ 549:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"/*! normalize.css v4.1.1 | MIT License | github.com/necolas/normalize.css */\\n\\n/**\\n * 1. Change the default font family in all browsers (opinionated).\\n * 2. Prevent adjustments of font size after orientation changes in IE and iOS.\\n */\\n\\nhtml {\\n  font-family: sans-serif; /* 1 */\\n  -ms-text-size-adjust: 100%; /* 2 */\\n  -webkit-text-size-adjust: 100%; /* 2 */\\n}\\n\\n/**\\n * Remove the margin in all browsers (opinionated).\\n */\\n\\nbody {\\n  margin: 0;\\n}\\n\\n/* HTML5 display definitions\\n   ========================================================================== */\\n\\n/**\\n * Add the correct display in IE 9-.\\n * 1. Add the correct display in Edge, IE, and Firefox.\\n * 2. Add the correct display in IE.\\n */\\n\\narticle,\\naside,\\ndetails, /* 1 */\\nfigcaption,\\nfigure,\\nfooter,\\nheader,\\nmain, /* 2 */\\nmenu,\\nnav,\\nsection,\\nsummary { /* 1 */\\n  display: block;\\n}\\n\\n/**\\n * Add the correct display in IE 9-.\\n */\\n\\naudio,\\ncanvas,\\nprogress,\\nvideo {\\n  display: inline-block;\\n}\\n\\n/**\\n * Add the correct display in iOS 4-7.\\n */\\n\\naudio:not([controls]) {\\n  display: none;\\n  height: 0;\\n}\\n\\n/**\\n * Add the correct vertical alignment in Chrome, Firefox, and Opera.\\n */\\n\\nprogress {\\n  vertical-align: baseline;\\n}\\n\\n/**\\n * Add the correct display in IE 10-.\\n * 1. Add the correct display in IE.\\n */\\n\\ntemplate, /* 1 */\\n[hidden] {\\n  display: none;\\n}\\n\\n/* Links\\n   ========================================================================== */\\n\\n/**\\n * 1. Remove the gray background on active links in IE 10.\\n * 2. Remove gaps in links underline in iOS 8+ and Safari 8+.\\n */\\n\\na {\\n  background-color: transparent; /* 1 */\\n  -webkit-text-decoration-skip: objects; /* 2 */\\n}\\n\\n/**\\n * Remove the outline on focused links when they are also active or hovered\\n * in all browsers (opinionated).\\n */\\n\\na:active,\\na:hover {\\n  outline-width: 0;\\n}\\n\\n/* Text-level semantics\\n   ========================================================================== */\\n\\n/**\\n * 1. Remove the bottom border in Firefox 39-.\\n * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari.\\n */\\n\\nabbr[title] {\\n  border-bottom: none; /* 1 */\\n  text-decoration: underline; /* 2 */\\n  text-decoration: underline dotted; /* 2 */\\n}\\n\\n/**\\n * Prevent the duplicate application of `bolder` by the next rule in Safari 6.\\n */\\n\\nb,\\nstrong {\\n  font-weight: inherit;\\n}\\n\\n/**\\n * Add the correct font weight in Chrome, Edge, and Safari.\\n */\\n\\nb,\\nstrong {\\n  font-weight: bolder;\\n}\\n\\n/**\\n * Add the correct font style in Android 4.3-.\\n */\\n\\ndfn {\\n  font-style: italic;\\n}\\n\\n/**\\n * Correct the font size and margin on `h1` elements within `section` and\\n * `article` contexts in Chrome, Firefox, and Safari.\\n */\\n\\nh1 {\\n  font-size: 2em;\\n  margin: 0.67em 0;\\n}\\n\\n/**\\n * Add the correct background and color in IE 9-.\\n */\\n\\nmark {\\n  background-color: #ff0;\\n  color: #000;\\n}\\n\\n/**\\n * Add the correct font size in all browsers.\\n */\\n\\nsmall {\\n  font-size: 80%;\\n}\\n\\n/**\\n * Prevent `sub` and `sup` elements from affecting the line height in\\n * all browsers.\\n */\\n\\nsub,\\nsup {\\n  font-size: 75%;\\n  line-height: 0;\\n  position: relative;\\n  vertical-align: baseline;\\n}\\n\\nsub {\\n  bottom: -0.25em;\\n}\\n\\nsup {\\n  top: -0.5em;\\n}\\n\\n/* Embedded content\\n   ========================================================================== */\\n\\n/**\\n * Remove the border on images inside links in IE 10-.\\n */\\n\\nimg {\\n  border-style: none;\\n}\\n\\n/**\\n * Hide the overflow in IE.\\n */\\n\\nsvg:not(:root) {\\n  overflow: hidden;\\n}\\n\\n/* Grouping content\\n   ========================================================================== */\\n\\n/**\\n * 1. Correct the inheritance and scaling of font size in all browsers.\\n * 2. Correct the odd `em` font sizing in all browsers.\\n */\\n\\ncode,\\nkbd,\\npre,\\nsamp {\\n  font-family: monospace, monospace; /* 1 */\\n  font-size: 1em; /* 2 */\\n}\\n\\n/**\\n * Add the correct margin in IE 8.\\n */\\n\\nfigure {\\n  margin: 1em 40px;\\n}\\n\\n/**\\n * 1. Add the correct box sizing in Firefox.\\n * 2. Show the overflow in Edge and IE.\\n */\\n\\nhr {\\n  box-sizing: content-box; /* 1 */\\n  height: 0; /* 1 */\\n  overflow: visible; /* 2 */\\n}\\n\\n/* Forms\\n   ========================================================================== */\\n\\n/**\\n * 1. Change font properties to `inherit` in all browsers (opinionated).\\n * 2. Remove the margin in Firefox and Safari.\\n */\\n\\nbutton,\\ninput,\\nselect,\\ntextarea {\\n  font: inherit; /* 1 */\\n  margin: 0; /* 2 */\\n}\\n\\n/**\\n * Restore the font weight unset by the previous rule.\\n */\\n\\noptgroup {\\n  font-weight: bold;\\n}\\n\\n/**\\n * Show the overflow in IE.\\n * 1. Show the overflow in Edge.\\n */\\n\\nbutton,\\ninput { /* 1 */\\n  overflow: visible;\\n}\\n\\n/**\\n * Remove the inheritance of text transform in Edge, Firefox, and IE.\\n * 1. Remove the inheritance of text transform in Firefox.\\n */\\n\\nbutton,\\nselect { /* 1 */\\n  text-transform: none;\\n}\\n\\n/**\\n * 1. Prevent a WebKit bug where (2) destroys native `audio` and `video`\\n *    controls in Android 4.\\n * 2. Correct the inability to style clickable types in iOS and Safari.\\n */\\n\\nbutton,\\nhtml [type=\\\"button\\\"], /* 1 */\\n[type=\\\"reset\\\"],\\n[type=\\\"submit\\\"] {\\n  -webkit-appearance: button; /* 2 */\\n}\\n\\n/**\\n * Remove the inner border and padding in Firefox.\\n */\\n\\nbutton::-moz-focus-inner,\\n[type=\\\"button\\\"]::-moz-focus-inner,\\n[type=\\\"reset\\\"]::-moz-focus-inner,\\n[type=\\\"submit\\\"]::-moz-focus-inner {\\n  border-style: none;\\n  padding: 0;\\n}\\n\\n/**\\n * Restore the focus styles unset by the previous rule.\\n */\\n\\nbutton:-moz-focusring,\\n[type=\\\"button\\\"]:-moz-focusring,\\n[type=\\\"reset\\\"]:-moz-focusring,\\n[type=\\\"submit\\\"]:-moz-focusring {\\n  outline: 1px dotted ButtonText;\\n}\\n\\n/**\\n * Change the border, margin, and padding in all browsers (opinionated).\\n */\\n\\nfieldset {\\n  border: 1px solid #c0c0c0;\\n  margin: 0 2px;\\n  padding: 0.35em 0.625em 0.75em;\\n}\\n\\n/**\\n * 1. Correct the text wrapping in Edge and IE.\\n * 2. Correct the color inheritance from `fieldset` elements in IE.\\n * 3. Remove the padding so developers are not caught out when they zero out\\n *    `fieldset` elements in all browsers.\\n */\\n\\nlegend {\\n  box-sizing: border-box; /* 1 */\\n  color: inherit; /* 2 */\\n  display: table; /* 1 */\\n  max-width: 100%; /* 1 */\\n  padding: 0; /* 3 */\\n  white-space: normal; /* 1 */\\n}\\n\\n/**\\n * Remove the default vertical scrollbar in IE.\\n */\\n\\ntextarea {\\n  overflow: auto;\\n}\\n\\n/**\\n * 1. Add the correct box sizing in IE 10-.\\n * 2. Remove the padding in IE 10-.\\n */\\n\\n[type=\\\"checkbox\\\"],\\n[type=\\\"radio\\\"] {\\n  box-sizing: border-box; /* 1 */\\n  padding: 0; /* 2 */\\n}\\n\\n/**\\n * Correct the cursor style of increment and decrement buttons in Chrome.\\n */\\n\\n[type=\\\"number\\\"]::-webkit-inner-spin-button,\\n[type=\\\"number\\\"]::-webkit-outer-spin-button {\\n  height: auto;\\n}\\n\\n/**\\n * 1. Correct the odd appearance in Chrome and Safari.\\n * 2. Correct the outline style in Safari.\\n */\\n\\n[type=\\\"search\\\"] {\\n  -webkit-appearance: textfield; /* 1 */\\n  outline-offset: -2px; /* 2 */\\n}\\n\\n/**\\n * Remove the inner padding and cancel buttons in Chrome and Safari on OS X.\\n */\\n\\n[type=\\\"search\\\"]::-webkit-search-cancel-button,\\n[type=\\\"search\\\"]::-webkit-search-decoration {\\n  -webkit-appearance: none;\\n}\\n\\n/**\\n * Correct the text style of placeholders in Chrome, Edge, and Safari.\\n */\\n\\n::-webkit-input-placeholder {\\n  color: inherit;\\n  opacity: 0.54;\\n}\\n\\n/**\\n * 1. Correct the inability to style clickable types in iOS and Safari.\\n * 2. Change font properties to `inherit` in Safari.\\n */\\n\\n::-webkit-file-upload-button {\\n  -webkit-appearance: button; /* 1 */\\n  font: inherit; /* 2 */\\n}\\n\"\n\n/***/ },\n\n/***/ 503:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar router_deprecated_1 = __webpack_require__(133);\r\n\tvar app_service_1 = __webpack_require__(213);\r\n\tvar home_1 = __webpack_require__(507);\r\n\tvar game_1 = __webpack_require__(505);\r\n\tvar online_1 = __webpack_require__(513);\r\n\tvar domain_1 = __webpack_require__(355);\r\n\t/*\r\n\t * App Component\r\n\t * Top Level Component\r\n\t */\r\n\tvar App = (function () {\r\n\t    function App(appState) {\r\n\t        this.appState = appState;\r\n\t        this.loading = false;\r\n\t        this.name = 'Angular 2 Chess';\r\n\t    }\r\n\t    App = __decorate([\r\n\t        core_1.Component({\r\n\t            selector: 'app',\r\n\t            pipes: [],\r\n\t            providers: domain_1.FIREBASE_DOMAIN_PROVIDERS.slice(),\r\n\t            encapsulation: core_1.ViewEncapsulation.None,\r\n\t            styles: [\r\n\t                __webpack_require__(549),\r\n\t                __webpack_require__(550)\r\n\t            ],\r\n\t            template: \"\\n    <md-content>\\n      <md-toolbar color=\\\"primary\\\">\\n          <span>{{ name }}</span>\\n          <span class=\\\"fill\\\"></span>\\n          <button md-button [routerLink]=\\\" ['Home'] \\\">Home</button>\\n          <button md-button [routerLink]=\\\" ['Game'] \\\">Single</button>\\n          <button md-button [routerLink]=\\\" ['Online'] \\\">Online Chess</button>\\n      </md-toolbar>\\n\\n      <md-progress-bar mode=\\\"indeterminate\\\" color=\\\"primary\\\" *ngIf=\\\"loading\\\"></md-progress-bar>\\n\\n      <router-outlet></router-outlet>\\n    </md-content>\\n  \"\r\n\t        }),\r\n\t        router_deprecated_1.RouteConfig([\r\n\t            { path: '/home', name: 'Home', component: home_1.Home, useAsDefault: true },\r\n\t            { path: '/game', name: 'Game', component: game_1.Game },\r\n\t            { path: '/online', name: 'Online', component: online_1.Online }\r\n\t        ]), \r\n\t        __metadata('design:paramtypes', [app_service_1.AppState])\r\n\t    ], App);\r\n\t    return App;\r\n\t}());\r\n\texports.App = App;\r\n\n\n/***/ },\n\n/***/ 550:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"html, body{\\n  height: 100%;\\n  background: #F4FAFA;\\n}\\nbutton.active{\\n  background: #fff;\\n  color: #009688;\\n}\\nbutton.active:hover{\\n  color: #fff;\\n}\\n.fill{\\n  flex: 1 1 auto;\\n}\\n.app-state{\\n  margin: 15px;\\n  flex: 1;\\n}\\n.home{\\n  flex: 1;\\n}\\nmd-content{\\n  display: flex;\\n  flex-direction: column;\\n  height: 100%;\\n}\\nfooter{\\n  flex: 0 0 60px;\\n  padding: 10px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  background: #fff;\\n}\\n\"\n\n/***/ },\n\n/***/ 213:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar angular2_hmr_1 = __webpack_require__(618);\r\n\tvar AppState = (function () {\r\n\t    function AppState() {\r\n\t        // @HmrState() is used by HMR to track the state of any object during a hot module replacement\r\n\t        this._state = {};\r\n\t    }\r\n\t    Object.defineProperty(AppState.prototype, \"state\", {\r\n\t        // already return a clone of the current state\r\n\t        get: function () {\r\n\t            return this._state = this._clone(this._state);\r\n\t        },\r\n\t        // never allow mutation\r\n\t        set: function (value) {\r\n\t            throw new Error('do not mutate the `.state` directly');\r\n\t        },\r\n\t        enumerable: true,\r\n\t        configurable: true\r\n\t    });\r\n\t    AppState.prototype.get = function (prop) {\r\n\t        // use our state getter for the clone\r\n\t        var state = this.state;\r\n\t        return state[prop] || state;\r\n\t    };\r\n\t    AppState.prototype.set = function (prop, value) {\r\n\t        // internally mutate our state\r\n\t        return this._state[prop] = value;\r\n\t    };\r\n\t    AppState.prototype._clone = function (object) {\r\n\t        // simple object clone\r\n\t        return JSON.parse(JSON.stringify(object));\r\n\t    };\r\n\t    __decorate([\r\n\t        angular2_hmr_1.HmrState(), \r\n\t        __metadata('design:type', Object)\r\n\t    ], AppState.prototype, \"_state\", void 0);\r\n\t    AppState = __decorate([\r\n\t        core_1.Injectable(), \r\n\t        __metadata('design:paramtypes', [])\r\n\t    ], AppState);\r\n\t    return AppState;\r\n\t}());\r\n\texports.AppState = AppState;\r\n\n\n/***/ },\n\n/***/ 504:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar sidenav_1 = __webpack_require__(137);\r\n\tvar ng2_chess_1 = __webpack_require__(47);\r\n\tvar dom_svg_board_1 = __webpack_require__(86);\r\n\tvar chessjs_ai_1 = __webpack_require__(365);\r\n\tvar Player = (function () {\r\n\t    function Player(color, type, aiIndex) {\r\n\t        this.color = color;\r\n\t        this.type = type;\r\n\t        this.aiIndex = aiIndex;\r\n\t    }\r\n\t    Object.defineProperty(Player.prototype, \"rawtype\", {\r\n\t        get: function () {\r\n\t            return ng2_chess_1.PlayerType[this.type];\r\n\t        },\r\n\t        set: function (value) {\r\n\t            this.type = ng2_chess_1.PlayerType[value];\r\n\t        },\r\n\t        enumerable: true,\r\n\t        configurable: true\r\n\t    });\r\n\t    return Player;\r\n\t}());\r\n\tvar Game = (function () {\r\n\t    function Game() {\r\n\t        this.aiLevels = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\r\n\t        this.black = new Player(ng2_chess_1.PieceColor.BLACK, ng2_chess_1.PlayerType.AI, 9);\r\n\t        this.white = new Player(ng2_chess_1.PieceColor.WHITE, ng2_chess_1.PlayerType.HUMAN, 9);\r\n\t        this.workerSupported = typeof (Worker) !== \"undefined\";\r\n\t    }\r\n\t    Game.prototype.ngAfterViewInit = function () {\r\n\t        var _this = this;\r\n\t        this.ctrl = this.board.ctrl;\r\n\t        this.ctrl.init()\r\n\t            .then(function () { return _this.sidenav.toggle(true); });\r\n\t    };\r\n\t    Game.prototype.ngOnDestroy = function () {\r\n\t        this.ctrl.destroy();\r\n\t    };\r\n\t    Game.prototype.onPlayerTypeChange = function (event, player) {\r\n\t        this.ctrl.setPlayer(player.color, ng2_chess_1.PlayerType[event.value]);\r\n\t    };\r\n\t    Game.prototype.onAILevelChange = function ($event, player) {\r\n\t        player.aiIndex = Number($event.srcElement.selectedIndex);\r\n\t        this.ctrl.setPlayer(player.color, player.type, this.getLevel(player.aiIndex));\r\n\t    };\r\n\t    Game.prototype.onNewGame = function () {\r\n\t        this.ctrl\r\n\t            .setPlayer(this.black.color, this.black.type, this.getLevel(this.black.aiIndex))\r\n\t            .setPlayer(this.white.color, this.white.type, this.getLevel(this.white.aiIndex))\r\n\t            .newGame();\r\n\t        this.isInit = true;\r\n\t    };\r\n\t    Game.prototype.onStop = function () {\r\n\t        this.ctrl.aiStop();\r\n\t    };\r\n\t    Game.prototype.hint = function () {\r\n\t        var _this = this;\r\n\t        this.ctrl.aiNextMove().then(function (mv) { return _this.ctrl.highlight(mv.to, mv.from); });\r\n\t    };\r\n\t    Game.prototype.getLevel = function (idx) {\r\n\t        return this.aiLevels[idx];\r\n\t    };\r\n\t    __decorate([\r\n\t        core_1.ViewChild('sidenav'), \r\n\t        __metadata('design:type', sidenav_1.MdSidenav)\r\n\t    ], Game.prototype, \"sidenav\", void 0);\r\n\t    __decorate([\r\n\t        core_1.ViewChild('board'), \r\n\t        __metadata('design:type', ng2_chess_1.ChessBoard)\r\n\t    ], Game.prototype, \"board\", void 0);\r\n\t    Game = __decorate([\r\n\t        core_1.Component({\r\n\t            selector: 'game',\r\n\t            providers: chessjs_ai_1.CHESSJS_AI_CHESS_GAME_PROVIDERS.slice(),\r\n\t            directives: dom_svg_board_1.DOM_SVG_KIT_DIRECTIVES.slice(),\r\n\t            pipes: [],\r\n\t            styles: [__webpack_require__(551)],\r\n\t            template: __webpack_require__(552)\r\n\t        }), \r\n\t        __metadata('design:paramtypes', [])\r\n\t    ], Game);\r\n\t    return Game;\r\n\t}());\r\n\texports.Game = Game;\r\n\n\n/***/ },\n\n/***/ 551:\n/***/ function(module, exports) {\n\n\tmodule.exports = \":host {\\n  height: 100%;\\n  display: flex;\\n}\\n\\n.md-sidenav-side {\\n  width: 250px;\\n}\\n\\n.settings-button {\\n  position: absolute;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  z-index: 5000;\\n}\\n\\n.sidenav-layout {\\n  flex: 1;\\n}\\n\\n.settings-container {\\n  padding: 24px;\\n\\n  display: flex;\\n  flex-flow: row wrap;\\n  align-items: stretch;\\n\\n  flex: 0 0 250px;\\n}\\n\\n.settings-container > div {\\n  flex: 1 100%;\\n}\\n\\n.form-row {\\n  margin: 15px 0;\\n}\\n\\n.config-section h3 {\\n  border-bottom: 1px solid #009688;\\n}\\n\\n.config-section {\\n  margin-bottom: 50px;\\n}\\n\\n.config-section:last-of-type {\\n  border-top: 1px solid #009688;\\n  border-bottom: 1px solid #009688;\\n  margin-bottom: 0;\\n}\\n\\n.board-container {\\n  flex: 5 0px;\\n}\\n.board-container, .board-container:hover {\\n  box-shadow: none;\\n  background-color: transparent;\\n}\\n\\n.game-toolbar {\\n  display: flex;\\n  justify-content: center;\\n}\\n\\n.game-toolbar > * {\\n  margin: 5px;\\n}\\n.svg-chess-board {\\n  margin: auto;\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n@media (min-height: 400px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 200px;\\n    max-height: 200px;\\n  }\\n}\\n\\n@media (min-height: 600px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 400px;\\n    max-height: 400px;\\n  }\\n}\\n\\n@media (min-height: 700px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 500px;\\n    max-height: 500px;\\n  }\\n}\\n\\n@media (min-height: 800px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 600px;\\n    max-height: 600px;\\n  }\\n}\\n\\n@media (min-height: 900px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 700px;\\n    max-height: 700px;\\n  }\\n}\\n\"\n\n/***/ },\n\n/***/ 552:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<button class=\\\"settings-button\\\" md-fab (click)=\\\"sidenav.toggle()\\\">\\n  <md-icon class=\\\"md-24\\\">settings</md-icon>\\n</button>\\n<md-sidenav-layout class=\\\"sidenav-layout\\\">\\n  <md-sidenav #sidenav mode=\\\"side\\\">\\n    <div class=\\\"settings-container\\\">\\n      <div class=\\\"config-section\\\">\\n        <h3>Black:</h3>\\n        <form>\\n          <div class=\\\"form-row\\\">\\n            <md-radio-group [(ngModel)]=\\\"black.rawtype\\\" (change)=\\\"onPlayerTypeChange($event, black)\\\">\\n              <md-radio-button value=\\\"HUMAN\\\">Human</md-radio-button>\\n              <md-radio-button value=\\\"AI\\\">Computer</md-radio-button>\\n            </md-radio-group>\\n          </div>\\n          <div class=\\\"form-row\\\">\\n            <label>AI Level:</label>\\n            <select (change)=\\\"onAILevelChange($event, black)\\\">\\n              <option *ngFor=\\\"let i of aiLevels\\\" [attr.value]=\\\"i\\\"\\n                      [attr.selected]=\\\"black.aiIndex === i\\\">{{i}}</option>\\n            </select>\\n          </div>\\n        </form>\\n      </div>\\n      <div class=\\\"config-section\\\">\\n        <h3>White:</h3>\\n        <form>\\n          <div class=\\\"form-row\\\">\\n            <md-radio-group [(ngModel)]=\\\"white.rawtype\\\" (change)=\\\"onPlayerTypeChange($event, white)\\\">\\n              <md-radio-button value=\\\"HUMAN\\\">Human</md-radio-button>\\n              <md-radio-button value=\\\"AI\\\">Computer</md-radio-button>\\n            </md-radio-group>\\n          </div>\\n          <div class=\\\"form-row\\\">\\n            <label>AI Level:</label>\\n            <select (change)=\\\"onAILevelChange($event, white)\\\">\\n              <option *ngFor=\\\"let i of aiLevels\\\" [attr.value]=\\\"i\\\"\\n                      [attr.selected]=\\\"white.aiIndex === i\\\">{{i}}</option>\\n            </select>\\n          </div>\\n        </form>\\n      </div>\\n      <div class=\\\"config-section\\\">\\n        <button md-button color=\\\"primary\\\" (click)=\\\"onNewGame()\\\">New Game</button>\\n        <button md-button color=\\\"accent\\\" (click)=\\\"onStop()\\\" [disabled]=\\\"!board.ctrl.aiProcessing\\\">Stop</button>\\n      </div>\\n    </div>\\n  </md-sidenav>\\n  <md-card class=\\\"board-container\\\">\\n    <br>\\n    <chess-board class=\\\"svg-chess-board\\\" #board></chess-board>\\n    <div class=\\\"game-toolbar\\\">\\n      <button md-mini-fab (click)=\\\"ctrl.undo()\\\" [disabled]=\\\"board.ctrl.aiProcessing || !isInit\\\">\\n        <md-icon class=\\\"md-24\\\">undo</md-icon>\\n      </button>\\n      <button md-mini-fab (click)=\\\"hint()\\\" [disabled]=\\\"board.ctrl.aiProcessing || !isInit\\\" *ngIf=\\\"board.ctrl.aiSupported\\\">\\n        <md-icon class=\\\"md-24\\\">remove_red_eye</md-icon>\\n      </button>\\n    </div>\\n  </md-card>\\n  <div>\\n    <p style=\\\"text-align: center; margin-top: 0\\\" *ngIf=\\\"!workerSupported\\\">Your broswer does not support web workers, expect UI lags while computer thinks</p>\\n  </div>\\n</md-sidenav-layout>\\n\\n\"\n\n/***/ },\n\n/***/ 505:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(504));\r\n\n\n/***/ },\n\n/***/ 506:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar ng2_chess_1 = __webpack_require__(47);\r\n\tvar dom_svg_board_1 = __webpack_require__(86);\r\n\tvar chessjs_1 = __webpack_require__(141);\r\n\tvar Home = (function () {\r\n\t    function Home() {\r\n\t    }\r\n\t    Home.prototype.ngAfterViewInit = function () {\r\n\t        var _this = this;\r\n\t        this.board.ctrl\r\n\t            .init()\r\n\t            .then(function () {\r\n\t            _this.board.ctrl\r\n\t                .setPlayer(ng2_chess_1.PieceColor.BLACK, ng2_chess_1.PlayerType.HUMAN)\r\n\t                .setPlayer(ng2_chess_1.PieceColor.WHITE, ng2_chess_1.PlayerType.HUMAN)\r\n\t                .newGame();\r\n\t        });\r\n\t    };\r\n\t    __decorate([\r\n\t        core_1.ViewChild('board'), \r\n\t        __metadata('design:type', ng2_chess_1.ChessBoard)\r\n\t    ], Home.prototype, \"board\", void 0);\r\n\t    Home = __decorate([\r\n\t        core_1.Component({\r\n\t            selector: 'home',\r\n\t            providers: chessjs_1.CHESSJS_CHESS_GAME_PROVIDERS.slice(),\r\n\t            directives: dom_svg_board_1.DOM_SVG_KIT_DIRECTIVES.slice(),\r\n\t            pipes: [],\r\n\t            styles: [__webpack_require__(553)],\r\n\t            template: __webpack_require__(554)\r\n\t        }), \r\n\t        __metadata('design:paramtypes', [])\r\n\t    ], Home);\r\n\t    return Home;\r\n\t}());\r\n\texports.Home = Home;\r\n\n\n/***/ },\n\n/***/ 553:\n/***/ function(module, exports) {\n\n\tmodule.exports = \".home {\\n  padding-left: 24px;\\n  padding-right: 24px;\\n  text-align: center;\\n  color: #009688;\\n}\\n\\n.home h1 {\\n  color: #9c27b0;\\n}\\n.home p > a {\\n  font-size: 1.15em;\\n}\\n.board-container {\\n  padding-top: 25px;\\n  padding-left: 25%;\\n  width: 50%;\\n}\\n\"\n\n/***/ },\n\n/***/ 554:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"home\\\">\\n  <h1>Angular 2 Chess</h1>\\n  <p>A plugin oriented chess module built with Angular 2.</p>\\n  <p>To play, click of the \\\"Game\\\" menu on the top-right corner.</p>\\n  <p>For more infomation please visit the <a href=\\\"https://github.com/shlomiassaf/ng2-chess\\\" target=\\\"_blank\\\">GitHub page</a></p>\\n  <div class=\\\"board-container\\\">\\n    <chess-board class=\\\"svg-chess-board\\\" #board></chess-board>\\n  </div>\\n  <p style=\\\"color: #1fad83\\\">Angular 2 Chess is in early stages, currently alpha.</p>\\n</div>\\n\"\n\n/***/ },\n\n/***/ 507:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(506));\r\n\n\n/***/ },\n\n/***/ 508:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t// App\r\n\t__export(__webpack_require__(503));\r\n\t__export(__webpack_require__(213));\r\n\tvar app_service_2 = __webpack_require__(213);\r\n\t// Application wide providers\r\n\texports.APP_PROVIDERS = [\r\n\t    app_service_2.AppState\r\n\t];\r\n\n\n/***/ },\n\n/***/ 509:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar CurrentUserFilter = (function () {\r\n\t    function CurrentUserFilter() {\r\n\t    }\r\n\t    CurrentUserFilter.prototype.transform = function (value, user$key) {\r\n\t        return value && user$key ? value.filter(function (u) { return u.$key !== user$key; }) : value;\r\n\t    };\r\n\t    CurrentUserFilter = __decorate([\r\n\t        core_1.Pipe({\r\n\t            name: 'currentUser'\r\n\t        }), \r\n\t        __metadata('design:paramtypes', [])\r\n\t    ], CurrentUserFilter);\r\n\t    return CurrentUserFilter;\r\n\t}());\r\n\texports.CurrentUserFilter = CurrentUserFilter;\r\n\n\n/***/ },\n\n/***/ 355:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\tvar login_1 = __webpack_require__(356);\r\n\tvar users_1 = __webpack_require__(139);\r\n\tvar match_1 = __webpack_require__(214);\r\n\tvar user_bus_1 = __webpack_require__(138);\r\n\t__export(__webpack_require__(356));\r\n\t__export(__webpack_require__(139));\r\n\t__export(__webpack_require__(214));\r\n\t__export(__webpack_require__(138));\r\n\texports.FIREBASE_DOMAIN_PROVIDERS = [\r\n\t    login_1.LoginFirebase,\r\n\t    users_1.FBUsers,\r\n\t    match_1.FBMatches,\r\n\t    user_bus_1.FBUserBusFactory\r\n\t];\r\n\n\n/***/ },\n\n/***/ 356:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar angularfire2_1 = __webpack_require__(72);\r\n\tvar PromiseCompleter = (function () {\r\n\t    function PromiseCompleter() {\r\n\t        var _this = this;\r\n\t        this.promise = new Promise(function (res, rej) {\r\n\t            _this.resolve = res;\r\n\t            _this.reject = rej;\r\n\t        });\r\n\t    }\r\n\t    return PromiseCompleter;\r\n\t}());\r\n\texports.PromiseCompleter = PromiseCompleter;\r\n\tvar LoginFirebase = (function () {\r\n\t    function LoginFirebase(af) {\r\n\t        this.af = af;\r\n\t    }\r\n\t    LoginFirebase.prototype.logout = function () {\r\n\t        this.af.auth.logout();\r\n\t    };\r\n\t    LoginFirebase.prototype.facebook = function () {\r\n\t        this.af.auth.login({\r\n\t            provider: angularfire2_1.AuthProviders.Facebook,\r\n\t            method: angularfire2_1.AuthMethods.Popup\r\n\t        });\r\n\t    };\r\n\t    LoginFirebase.prototype.twitter = function () {\r\n\t        this.af.auth.login({\r\n\t            provider: angularfire2_1.AuthProviders.Twitter,\r\n\t            method: angularfire2_1.AuthMethods.Redirect\r\n\t        });\r\n\t    };\r\n\t    LoginFirebase = __decorate([\r\n\t        core_1.Injectable(), \r\n\t        __metadata('design:paramtypes', [angularfire2_1.AngularFire])\r\n\t    ], LoginFirebase);\r\n\t    return LoginFirebase;\r\n\t}());\r\n\texports.LoginFirebase = LoginFirebase;\r\n\n\n/***/ },\n\n/***/ 357:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar ng2_chess_1 = __webpack_require__(47);\r\n\tvar FBLiveMatch = (function () {\r\n\t    function FBLiveMatch(matchSvc, match$key, user) {\r\n\t        var _this = this;\r\n\t        this.matchSvc = matchSvc;\r\n\t        this.match$key = match$key;\r\n\t        this.user = user;\r\n\t        this.moves = { w: [], b: [] };\r\n\t        this.rxWaste = [];\r\n\t        this.match$ = matchSvc.getMatch$(match$key);\r\n\t        this.blackMoves$ = matchSvc.getMatchMoves$(match$key, 'black');\r\n\t        this.whiteMoves$ = matchSvc.getMatchMoves$(match$key, 'white');\r\n\t        this.rxWaste.push(this.blackMoves$.subscribe(function (m) { return _this.moves.b = m; }));\r\n\t        this.rxWaste.push(this.whiteMoves$.subscribe(function (m) { return _this.moves.w = m; }));\r\n\t    }\r\n\t    Object.defineProperty(FBLiveMatch.prototype, \"mySide\", {\r\n\t        get: function () {\r\n\t            return this.myMoves$ === this.blackMoves$ ? 'black' : 'white';\r\n\t        },\r\n\t        enumerable: true,\r\n\t        configurable: true\r\n\t    });\r\n\t    FBLiveMatch.prototype.movesValid = function () {\r\n\t        var l = this.moves.w.length - this.moves.b.length;\r\n\t        return l === 0 || l === 1;\r\n\t    };\r\n\t    FBLiveMatch.prototype.turn = function () {\r\n\t        return this.moves.w.length > this.moves.b.length ? ng2_chess_1.PieceColor.BLACK : ng2_chess_1.PieceColor.WHITE;\r\n\t    };\r\n\t    FBLiveMatch.prototype.myTurn = function () {\r\n\t        switch (this.turn()) {\r\n\t            case ng2_chess_1.PieceColor.WHITE:\r\n\t                return this.match.white === this.user.user$key;\r\n\t            case ng2_chess_1.PieceColor.BLACK:\r\n\t                return this.match.black === this.user.user$key;\r\n\t        }\r\n\t    };\r\n\t    FBLiveMatch.prototype.setState = function (state) {\r\n\t        return this.matchSvc.getMatchMetaState$(this.match$key, this.mySide).set(state);\r\n\t    };\r\n\t    FBLiveMatch.prototype.setMove = function (move) {\r\n\t        var _this = this;\r\n\t        if (this.myTurn()) {\r\n\t            // TODO: Ping/Pong - get approval from remote?.\r\n\t            return this.user.sendMsg(this.opponent$key, this.user.msgFactory.move(this.match$key, move))\r\n\t                .then(function () { return _this.myMoves$.push(move); });\r\n\t        }\r\n\t        else {\r\n\t            return Promise.reject(new Error('Not your turn.'));\r\n\t        }\r\n\t    };\r\n\t    FBLiveMatch.prototype.destroy = function () {\r\n\t        this.unsubscribe();\r\n\t    };\r\n\t    /**\r\n\t     * clear all registered subscriptions\r\n\t     */\r\n\t    FBLiveMatch.prototype.unsubscribe = function () {\r\n\t        while (this.rxWaste.length > 0) {\r\n\t            this.rxWaste.pop().unsubscribe();\r\n\t        }\r\n\t    };\r\n\t    FBLiveMatch.load = function (matchSvc, matchId, user) {\r\n\t        var liveMatch = new FBLiveMatch_(matchSvc, matchId, user);\r\n\t        return liveMatch.match$.take(1).toPromise().then(function (m) {\r\n\t            liveMatch.match = m;\r\n\t            liveMatch.myMoves$ = m.black === user.user$key ? liveMatch.blackMoves$ : liveMatch.whiteMoves$;\r\n\t            liveMatch.opponent$key = m.black === user.user$key ? m.white : m.black;\r\n\t            var pc;\r\n\t            if (user.user$key === m.black) {\r\n\t                pc = ng2_chess_1.PieceColor.BLACK;\r\n\t            }\r\n\t            else if (user.user$key === m.white) {\r\n\t                pc = ng2_chess_1.PieceColor.WHITE;\r\n\t            }\r\n\t            else {\r\n\t                return Promise.reject('Player is not assigned to black/white on this match.');\r\n\t            }\r\n\t            Object.defineProperty(liveMatch, 'pieceColor', { value: pc });\r\n\t            return liveMatch;\r\n\t        });\r\n\t    };\r\n\t    return FBLiveMatch;\r\n\t}());\r\n\texports.FBLiveMatch = FBLiveMatch;\r\n\tvar FBLiveMatch_ = (function (_super) {\r\n\t    __extends(FBLiveMatch_, _super);\r\n\t    function FBLiveMatch_() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return FBLiveMatch_;\r\n\t}(FBLiveMatch));\r\n\n\n/***/ },\n\n/***/ 510:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar angularfire2_1 = __webpack_require__(72);\r\n\tvar Match_1 = __webpack_require__(358);\r\n\tvar FBLiveMatch_1 = __webpack_require__(357);\r\n\tvar PromiseCompleter = (function () {\r\n\t    function PromiseCompleter() {\r\n\t        var _this = this;\r\n\t        this.promise = new Promise(function (res, rej) {\r\n\t            _this.resolve = res;\r\n\t            _this.reject = rej;\r\n\t        });\r\n\t    }\r\n\t    return PromiseCompleter;\r\n\t}());\r\n\tvar FBMatches = (function () {\r\n\t    function FBMatches(af) {\r\n\t        this.af = af;\r\n\t    }\r\n\t    /**\r\n\t     * Creates a match and returns a promise of the match id.\r\n\t     * @param matchId\r\n\t     * @param mrefSettings Settings for the game\r\n\t     * @returns {Promise<void>}\r\n\t       */\r\n\t    FBMatches.prototype.createMatch = function (mref) {\r\n\t        var match = new Match_1.Match(mref.settings.white, mref.settings.black, mref.settings.type);\r\n\t        return this.af.database.object(\"/matches/\" + mref.matchId).set(match);\r\n\t    };\r\n\t    /**\r\n\t     * Loads a match\r\n\t     * @param matchId\r\n\t     * @param user The current logged in user.\r\n\t     * @returns {FBLiveMatch}\r\n\t       */\r\n\t    FBMatches.prototype.loadMatch = function (matchId, user) {\r\n\t        return FBLiveMatch_1.FBLiveMatch.load(this, matchId, user);\r\n\t    };\r\n\t    ;\r\n\t    FBMatches.prototype.getMatch$ = function (match$key) {\r\n\t        return this.af.database.object(\"/matches/\" + match$key);\r\n\t    };\r\n\t    FBMatches.prototype.getMatchMoves$ = function (match$key, side) {\r\n\t        return this.af.database.list(\"/matches/\" + match$key + \"/\" + side + \"Meta/moves\");\r\n\t    };\r\n\t    FBMatches.prototype.getMatchMeta$ = function (match$key, side) {\r\n\t        return this.af.database.object(\"/matches/\" + match$key + \"/\" + side + \"Meta\");\r\n\t    };\r\n\t    FBMatches.prototype.getMatchMetaState$ = function (match$key, side) {\r\n\t        return this.af.database.object(\"/matches/\" + match$key + \"/\" + side + \"Meta/state\");\r\n\t    };\r\n\t    FBMatches = __decorate([\r\n\t        core_1.Injectable(), \r\n\t        __metadata('design:paramtypes', [angularfire2_1.AngularFire])\r\n\t    ], FBMatches);\r\n\t    return FBMatches;\r\n\t}());\r\n\texports.FBMatches = FBMatches;\r\n\n\n/***/ },\n\n/***/ 358:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar users_1 = __webpack_require__(139);\r\n\t(function (MATCH_TYPE) {\r\n\t    MATCH_TYPE[MATCH_TYPE[\"SuddenDeath\"] = 0] = \"SuddenDeath\";\r\n\t})(exports.MATCH_TYPE || (exports.MATCH_TYPE = {}));\r\n\tvar MATCH_TYPE = exports.MATCH_TYPE;\r\n\tvar Match = (function () {\r\n\t    function Match(white, black, type) {\r\n\t        if (type === void 0) { type = MATCH_TYPE.SuddenDeath; }\r\n\t        this.black = black;\r\n\t        this.white = white;\r\n\t        this.type = type;\r\n\t        this.blackMeta = {\r\n\t            state: users_1.MatchRefState.Ready,\r\n\t            moves: []\r\n\t        };\r\n\t        this.whiteMeta = {\r\n\t            state: users_1.MatchRefState.Ready,\r\n\t            moves: []\r\n\t        };\r\n\t    }\r\n\t    return Match;\r\n\t}());\r\n\texports.Match = Match;\r\n\n\n/***/ },\n\n/***/ 214:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar Match_1 = __webpack_require__(358);\r\n\texports.Match = Match_1.Match;\r\n\texports.MATCH_TYPE = Match_1.MATCH_TYPE;\r\n\tvar FBMatches_1 = __webpack_require__(510);\r\n\texports.FBMatches = FBMatches_1.FBMatches;\r\n\tvar FBLiveMatch_1 = __webpack_require__(357);\r\n\texports.FBLiveMatch = FBLiveMatch_1.FBLiveMatch;\r\n\n\n/***/ },\n\n/***/ 359:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t(function (BUS_MESSAGE_TYPE) {\r\n\t    BUS_MESSAGE_TYPE[BUS_MESSAGE_TYPE[\"Invite\"] = 0] = \"Invite\";\r\n\t    BUS_MESSAGE_TYPE[BUS_MESSAGE_TYPE[\"Move\"] = 1] = \"Move\";\r\n\t    BUS_MESSAGE_TYPE[BUS_MESSAGE_TYPE[\"OutOfSync\"] = 2] = \"OutOfSync\";\r\n\t    BUS_MESSAGE_TYPE[BUS_MESSAGE_TYPE[\"Invalid\"] = 3] = \"Invalid\";\r\n\t    BUS_MESSAGE_TYPE[BUS_MESSAGE_TYPE[\"EndGame\"] = 4] = \"EndGame\";\r\n\t})(exports.BUS_MESSAGE_TYPE || (exports.BUS_MESSAGE_TYPE = {}));\r\n\tvar BUS_MESSAGE_TYPE = exports.BUS_MESSAGE_TYPE;\r\n\t(function (END_GAME_REQUEST_TYPE) {\r\n\t    END_GAME_REQUEST_TYPE[END_GAME_REQUEST_TYPE[\"Forfit\"] = 0] = \"Forfit\";\r\n\t    END_GAME_REQUEST_TYPE[END_GAME_REQUEST_TYPE[\"Draw\"] = 1] = \"Draw\";\r\n\t})(exports.END_GAME_REQUEST_TYPE || (exports.END_GAME_REQUEST_TYPE = {}));\r\n\tvar END_GAME_REQUEST_TYPE = exports.END_GAME_REQUEST_TYPE;\r\n\tvar validators = {};\r\n\tfunction validate(bus) {\r\n\t    if (typeof BUS_MESSAGE_TYPE[bus.type] === 'undefined') {\r\n\t        return new Error(\"Unknown MESSAGE_BUS_TYPE \" + bus.type);\r\n\t    }\r\n\t    var typeValidators = validators[bus.type];\r\n\t    if (typeValidators) {\r\n\t        var i = typeValidators.length, err = void 0;\r\n\t        while (i--) {\r\n\t            if (err = typeValidators[i](bus)) {\r\n\t                return err;\r\n\t            }\r\n\t        }\r\n\t    }\r\n\t}\r\n\texports.validate = validate;\r\n\tfunction register(type, validator) {\r\n\t    if (typeof validator !== 'function') {\r\n\t        throw new Error('Validator must be a function.');\r\n\t    }\r\n\t    else if (!Array.isArray(validators[type])) {\r\n\t        validators[type] = [];\r\n\t    }\r\n\t    validators[type].push(validator);\r\n\t}\r\n\texports.register = register;\r\n\tvar BusMessage = (function () {\r\n\t    function BusMessage(type, sender, data) {\r\n\t        this.type = type;\r\n\t        this.sender = sender;\r\n\t        this.timestamp = Date.now();\r\n\t        if (data !== undefined) {\r\n\t            this.data = data;\r\n\t        }\r\n\t    }\r\n\t    return BusMessage;\r\n\t}());\r\n\texports.BusMessage = BusMessage;\r\n\tvar MessageFactory = (function () {\r\n\t    function MessageFactory(senderId) {\r\n\t        this.senderId = senderId;\r\n\t    }\r\n\t    MessageFactory.prototype.invite = function (mref) {\r\n\t        return this.create(BUS_MESSAGE_TYPE.Invite, {\r\n\t            token: mref.matchId,\r\n\t            settings: mref.settings\r\n\t        });\r\n\t    };\r\n\t    MessageFactory.prototype.inviteResponse = function (mref, response, reason) {\r\n\t        if (reason === void 0) { reason = null; }\r\n\t        return this.create(BUS_MESSAGE_TYPE.Invite, { token: mref.matchId, response: response, reason: reason });\r\n\t    };\r\n\t    MessageFactory.prototype.move = function (matchId, move) {\r\n\t        return this.create(BUS_MESSAGE_TYPE.Move, { matchId: matchId, move: move });\r\n\t    };\r\n\t    MessageFactory.prototype.outOfSync = function (matchId, reason) {\r\n\t        return this.create(BUS_MESSAGE_TYPE.OutOfSync, { matchId: matchId, reason: reason });\r\n\t    };\r\n\t    MessageFactory.prototype.invalid = function (orgMessage, reason) {\r\n\t        return this.create(BUS_MESSAGE_TYPE.Invalid, { orgMessage: orgMessage, reason: reason });\r\n\t    };\r\n\t    MessageFactory.prototype.endGame = function (endGameRequest) {\r\n\t        return this.create(BUS_MESSAGE_TYPE.EndGame, endGameRequest);\r\n\t    };\r\n\t    MessageFactory.prototype.create = function (type, data) {\r\n\t        return new BusMessage(type, this.senderId, data);\r\n\t    };\r\n\t    MessageFactory.isInvite = function (msg) {\r\n\t        return msg && msg.type === BUS_MESSAGE_TYPE.Invite;\r\n\t    };\r\n\t    MessageFactory.isMove = function (msg) {\r\n\t        return msg && msg.type === BUS_MESSAGE_TYPE.Move;\r\n\t    };\r\n\t    MessageFactory.isOutOfSync = function (msg) {\r\n\t        return msg && msg.type === BUS_MESSAGE_TYPE.OutOfSync;\r\n\t    };\r\n\t    MessageFactory.isInvalid = function (msg) {\r\n\t        return msg && msg.type === BUS_MESSAGE_TYPE.Invalid;\r\n\t    };\r\n\t    return MessageFactory;\r\n\t}());\r\n\texports.MessageFactory = MessageFactory;\r\n\n\n/***/ },\n\n/***/ 360:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar ReplaySubject_1 = __webpack_require__(216);\r\n\tvar FBUserBus = (function () {\r\n\t    function FBUserBus(bus, user$key) {\r\n\t        var _this = this;\r\n\t        this.bus = bus;\r\n\t        this.user$key = user$key;\r\n\t        this.rxWaste = [];\r\n\t        this._subject = new ReplaySubject_1.ReplaySubject(1);\r\n\t        this.incoming$ = this._subject.asObservable();\r\n\t        bus.getUserBus$(user$key).remove()\r\n\t            .then(function () {\r\n\t            _this.rxWaste.push(bus.getUserBus$(user$key).subscribe(function (msg) { return _this.onIncomingMessage(msg); }));\r\n\t        });\r\n\t    }\r\n\t    FBUserBus.prototype.send = function (id, message) {\r\n\t        return this.bus.send(id, message);\r\n\t    };\r\n\t    FBUserBus.prototype.destroy = function () {\r\n\t        this.unsubscribe();\r\n\t    };\r\n\t    /**\r\n\t     * clear all registered subscriptions\r\n\t     */\r\n\t    FBUserBus.prototype.unsubscribe = function () {\r\n\t        while (this.rxWaste.length > 0) {\r\n\t            this.rxWaste.pop().unsubscribe();\r\n\t        }\r\n\t    };\r\n\t    FBUserBus.prototype.onIncomingMessage = function (messages) {\r\n\t        if (messages.length === 0)\r\n\t            return;\r\n\t        for (var _i = 0, messages_1 = messages; _i < messages_1.length; _i++) {\r\n\t            var m = messages_1[_i];\r\n\t            this.bus.removeBusMessage(this.user$key, m.$key);\r\n\t            this._subject.next(m);\r\n\t        }\r\n\t    };\r\n\t    return FBUserBus;\r\n\t}());\r\n\texports.FBUserBus = FBUserBus;\r\n\n\n/***/ },\n\n/***/ 511:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar node_uuid_1 = __webpack_require__(246);\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar angularfire2_1 = __webpack_require__(72);\r\n\tvar BusMessage_1 = __webpack_require__(359);\r\n\tvar FBUserBus_1 = __webpack_require__(360);\r\n\texports.url = {\r\n\t    bus: function (id) { return (\"/user_bus/\" + id); },\r\n\t    busMsg: function (id) { return (exports.url.bus(id) + \"/\" + node_uuid_1.v1()); },\r\n\t};\r\n\tvar PromiseCompleter = (function () {\r\n\t    function PromiseCompleter() {\r\n\t        var _this = this;\r\n\t        this.promise = new Promise(function (res, rej) {\r\n\t            _this.resolve = res;\r\n\t            _this.reject = rej;\r\n\t        });\r\n\t    }\r\n\t    return PromiseCompleter;\r\n\t}());\r\n\tvar FBUserBusFactory = (function () {\r\n\t    function FBUserBusFactory(af) {\r\n\t        this.af = af;\r\n\t    }\r\n\t    FBUserBusFactory.prototype.send = function (id, message) {\r\n\t        var error = BusMessage_1.validate(message);\r\n\t        if (error) {\r\n\t            return Promise.reject(error);\r\n\t        }\r\n\t        else {\r\n\t            return this.af.database.object(exports.url.busMsg(id)).set(message);\r\n\t        }\r\n\t    };\r\n\t    FBUserBusFactory.prototype.create = function (user$key) {\r\n\t        return new FBUserBus_1.FBUserBus(this, user$key);\r\n\t    };\r\n\t    FBUserBusFactory.prototype.getUserBus$ = function (user$key) {\r\n\t        return this.af.database.list(exports.url.bus(user$key));\r\n\t    };\r\n\t    FBUserBusFactory.prototype.removeBusMessage = function (user$key, msg$key) {\r\n\t        return this.af.database.object(exports.url.bus(user$key) + \"/\" + msg$key).remove();\r\n\t    };\r\n\t    FBUserBusFactory = __decorate([\r\n\t        core_1.Injectable(), \r\n\t        __metadata('design:paramtypes', [angularfire2_1.AngularFire])\r\n\t    ], FBUserBusFactory);\r\n\t    return FBUserBusFactory;\r\n\t}());\r\n\texports.FBUserBusFactory = FBUserBusFactory;\r\n\n\n/***/ },\n\n/***/ 138:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(359));\r\n\tvar FBUserBusFactory_service_1 = __webpack_require__(511);\r\n\texports.FBUserBusFactory = FBUserBusFactory_service_1.FBUserBusFactory;\r\n\tvar FBUserBus_1 = __webpack_require__(360);\r\n\texports.FBUserBus = FBUserBus_1.FBUserBus;\r\n\n\n/***/ },\n\n/***/ 361:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar node_uuid_1 = __webpack_require__(246);\r\n\tvar index_1 = __webpack_require__(139);\r\n\tvar user_bus_1 = __webpack_require__(138);\r\n\tvar match_1 = __webpack_require__(214);\r\n\tvar FBUser = (function () {\r\n\t    function FBUser(user$key, users, bus) {\r\n\t        var _this = this;\r\n\t        this.user$key = user$key;\r\n\t        this.users = users;\r\n\t        this.bus = bus;\r\n\t        this.rxWaste = [];\r\n\t        this.user$ = users.getUser$(user$key);\r\n\t        this.rxWaste.push(this.user$.subscribe(function (user) { return _this.user = user; }));\r\n\t        this.matchRefs$ = users.getMatchRefs$(user$key)\r\n\t            .map(function (refs) {\r\n\t            refs.forEach(function (m) {\r\n\t                if (!m.user_) {\r\n\t                    users.getUser(m.user).then(function (u) { return m.user_ = u; });\r\n\t                }\r\n\t            });\r\n\t            return refs;\r\n\t        });\r\n\t        this.msgFactory = new user_bus_1.MessageFactory(user$key);\r\n\t    }\r\n\t    FBUser.prototype.update = function () {\r\n\t        return this.users.update(this.user$key, this.user);\r\n\t    };\r\n\t    FBUser.prototype.setPlaying = function (playing) {\r\n\t        return this.users.update(this.user$key, { playing: playing });\r\n\t    };\r\n\t    /**\r\n\t     * Send a bug message to a user.\r\n\t     * @param to the ID of the user ($key)\r\n\t     * @param msg The message\r\n\t     * @returns {Promise<void>}\r\n\t     */\r\n\t    FBUser.prototype.sendMsg = function (to, msg) {\r\n\t        return this.bus.send(to, msg);\r\n\t    };\r\n\t    FBUser.prototype.keepAlive = function () {\r\n\t        this.users.getUserResource$(this.user$key, 'lastSeen').set(new Date().getTime());\r\n\t    };\r\n\t    /**\r\n\t     * Invite a user ($key) to an online match.\r\n\t     * The user is the invitee, the inviter is the current user.\r\n\t     * @param invitee\r\n\t     * @returns {Promise<void>}\r\n\t     **/\r\n\t    FBUser.prototype.invite = function (invitee) {\r\n\t        var _this = this;\r\n\t        if (!invitee.$key) {\r\n\t            return Promise.reject(new Error('Invalid user $key.'));\r\n\t        }\r\n\t        else {\r\n\t            // TODO: Allow user to choose sides. (currently hard coded - inviter === white)\r\n\t            return this.createMatchRef(index_1.MatchRefRole.Inviter, this.user$key, invitee.$key)\r\n\t                .then(function (mref) { return _this.sendMsg(invitee.$key, _this.msgFactory.invite(mref)); });\r\n\t        }\r\n\t    };\r\n\t    FBUser.prototype.responedToInvite = function (mref, response, reason) {\r\n\t        return this.sendMsg(mref.user, this.msgFactory.inviteResponse(mref, response, reason));\r\n\t    };\r\n\t    FBUser.prototype.acceptInvitation = function (mref) {\r\n\t        var _this = this;\r\n\t        return this.updateMatchRefState(mref.matchId, index_1.MatchRefState.Ready)\r\n\t            .then(function () { })\r\n\t            .then(function () { return _this.sendMsg(mref.user, _this.msgFactory.inviteResponse(mref, true)); })\r\n\t            .catch(function () { return _this.withdrawInvitation(mref, true); });\r\n\t    };\r\n\t    /**\r\n\t     * Remove an invite the user has received.\r\n\t     */\r\n\t    FBUser.prototype.withdrawInvitation = function (mref, notify) {\r\n\t        return Promise.all([\r\n\t            notify ? this.sendMsg(mref.user, this.msgFactory.inviteResponse(mref, false)) : Promise.resolve(),\r\n\t            this.users.getMatchRef$(this.user$key, mref.matchId).remove()\r\n\t        ]);\r\n\t    };\r\n\t    /**\r\n\t     * Creates a new `MatchRef` and returns a promise of the new match id ($key)\r\n\t     * @param role\r\n\t     * @param white the firebase user $key of the player who plays white\r\n\t     * @param black the firebase user $key of the player who plays black\r\n\t     * @param uuid optional matchId, if not supplied created automatically.\r\n\t     * @returns {Promise<string>}\r\n\t     */\r\n\t    FBUser.prototype.createMatchRef = function (role, white, black, uuid) {\r\n\t        var matchId = uuid ? uuid : node_uuid_1.v1(), mref = {\r\n\t            timestamp: Date.now(),\r\n\t            role: role,\r\n\t            user: white === this.user$key ? black : white,\r\n\t            state: index_1.MatchRefState.Invite,\r\n\t            matchId: matchId,\r\n\t            settings: { black: black, white: white, type: match_1.MATCH_TYPE.SuddenDeath }\r\n\t        };\r\n\t        return this.users.getMatchRef$(this.user$key, matchId).set(mref).then(function () { return mref; });\r\n\t    };\r\n\t    FBUser.prototype.updateMatchRefState = function (matchId, state) {\r\n\t        return this.users.getMatchRefState$(this.user$key, matchId).set(state);\r\n\t    };\r\n\t    FBUser.prototype.getMatchRef = function (matchId) {\r\n\t        return this.users.getMatchRef(this.user$key, matchId);\r\n\t    };\r\n\t    FBUser.prototype.destroy = function () {\r\n\t        this.unsubscribe();\r\n\t    };\r\n\t    /**\r\n\t     * clear all registered subscriptions\r\n\t     */\r\n\t    FBUser.prototype.unsubscribe = function () {\r\n\t        while (this.rxWaste.length > 0) {\r\n\t            this.rxWaste.pop().unsubscribe();\r\n\t        }\r\n\t    };\r\n\t    return FBUser;\r\n\t}());\r\n\texports.FBUser = FBUser;\r\n\n\n/***/ },\n\n/***/ 512:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar angularfire2_1 = __webpack_require__(72);\r\n\tvar Subject_1 = __webpack_require__(31);\r\n\t__webpack_require__(71);\r\n\tvar User_1 = __webpack_require__(362);\r\n\tvar user_bus_1 = __webpack_require__(138);\r\n\tvar FBUser_1 = __webpack_require__(361);\r\n\tvar url = {\r\n\t    users: function () { return \"/users\"; },\r\n\t    user: function (id) { return (url.users() + \"/\" + id); },\r\n\t    match_refs: function (id) { return (url.user(id) + \"/match_refs\"); }\r\n\t};\r\n\tvar FBUsers = (function () {\r\n\t    function FBUsers(af, bus) {\r\n\t        var _this = this;\r\n\t        this.af = af;\r\n\t        this.bus = bus;\r\n\t        this.rxWaste = [];\r\n\t        this.currentUserEmitter = new Subject_1.Subject();\r\n\t        this.currentUser$ = this.currentUserEmitter.asObservable();\r\n\t        this.users$ = af.database.list(url.users());\r\n\t        var subscription = af.auth.subscribe(function (auth) {\r\n\t            if (auth && auth.uid) {\r\n\t                _this.getUser(auth.uid)\r\n\t                    .then(function (user) {\r\n\t                    if (user) {\r\n\t                        return user;\r\n\t                    }\r\n\t                    else {\r\n\t                        return _this.getUser$(auth.uid).set(User_1.User.create(auth))\r\n\t                            .then(function () { return _this.getUser(auth.uid); });\r\n\t                    }\r\n\t                })\r\n\t                    .then(function (user) {\r\n\t                    _this.currentUserEmitter.next(new FBUser_1.FBUser(user.$key, _this, bus.create(user.$key)));\r\n\t                    _this.authDone = true;\r\n\t                });\r\n\t            }\r\n\t            else {\r\n\t                _this.currentUserEmitter.next(null);\r\n\t                _this.users$ = undefined;\r\n\t                _this.unsubscribe();\r\n\t                _this.authDone = true;\r\n\t            }\r\n\t        });\r\n\t        this.rxWaste.push(subscription);\r\n\t    }\r\n\t    FBUsers.prototype.getUser$ = function ($key) {\r\n\t        return this.af.database.object(url.user($key));\r\n\t    };\r\n\t    /**\r\n\t     * Returns a specific resource in the user object\r\n\t     * i.e: /users/1234567/resource\r\n\t     * @param $key\r\n\t     * @param resource\r\n\t     * @returns {FirebaseObjectObservable<any>}\r\n\t       */\r\n\t    FBUsers.prototype.getUserResource$ = function ($key, resource) {\r\n\t        return this.af.database.object(url.user($key) + (\"/\" + resource));\r\n\t    };\r\n\t    /**\r\n\t     * A User fetch operation, only 1 call not a stream.\r\n\t     * @param $key\r\n\t     * @param set$Key If true will set the $key property on the user, since this is a direct object fetch\r\n\t     *                firebase will not plant the $key as it does with lists.\r\n\t     * @returns {Promise<User>}\r\n\t       */\r\n\t    FBUsers.prototype.getUser = function ($key, set$Key) {\r\n\t        if (set$Key === void 0) { set$Key = true; }\r\n\t        return this.af.database.object(url.user($key))\r\n\t            .take(1)\r\n\t            .toPromise()\r\n\t            .then(function (user) {\r\n\t            if (user && set$Key)\r\n\t                user.$key = $key;\r\n\t            return user;\r\n\t        });\r\n\t    };\r\n\t    FBUsers.prototype.getMatchRefs$ = function (user$key) {\r\n\t        return this.af.database.list(url.match_refs(user$key));\r\n\t    };\r\n\t    FBUsers.prototype.getMatchRef$ = function (user$key, matchRef$key) {\r\n\t        return this.af.database.object(url.match_refs(user$key) + (\"/\" + matchRef$key));\r\n\t    };\r\n\t    FBUsers.prototype.getMatchRefState$ = function (user$key, matchRef$key) {\r\n\t        return this.af.database.object(url.match_refs(user$key) + (\"/\" + matchRef$key + \"/state\"));\r\n\t    };\r\n\t    /**\r\n\t     * A User fetch operation, only 1 call not a stream.\r\n\t     * @param $key\r\n\t     * @param set$Key If true will set the $key property on the user, since this is a direct object fetch\r\n\t     *                firebase will not plant the $key as it does with lists.\r\n\t     * @returns {Promise<User>}\r\n\t     */\r\n\t    FBUsers.prototype.getMatchRef = function (user$key, matchRef$key) {\r\n\t        return this.getMatchRef$(user$key, matchRef$key)\r\n\t            .take(1)\r\n\t            .toPromise();\r\n\t    };\r\n\t    /**\r\n\t     * Send a bug message to a user.\r\n\t     * @param from the ID of the user ($key)\r\n\t     * @param to the ID of the user ($key)\r\n\t     * @param msg The message\r\n\t     * @returns {Promise<void>}\r\n\t     */\r\n\t    FBUsers.prototype.sendMsg = function (to, msg) {\r\n\t        return this.bus.send(to, msg);\r\n\t    };\r\n\t    /**\r\n\t     * Updates a user object.\r\n\t     * @param user\r\n\t     * @returns {Promise<void>}\r\n\t     */\r\n\t    FBUsers.prototype.update = function (user$key, user) {\r\n\t        var VALID_FB_KEY = /[\\[\\].#$\\/\\u0000-\\u001F\\u007F]/;\r\n\t        var obj = {};\r\n\t        for (var k in user) {\r\n\t            if (user.hasOwnProperty(k) && !VALID_FB_KEY.exec(k)) {\r\n\t                obj[k] = user[k];\r\n\t            }\r\n\t        }\r\n\t        return this.users$.update(user$key, obj);\r\n\t    };\r\n\t    FBUsers.prototype.destroy = function () {\r\n\t        this.unsubscribe();\r\n\t    };\r\n\t    /**\r\n\t     * clear all registered subscriptions\r\n\t     */\r\n\t    FBUsers.prototype.unsubscribe = function () {\r\n\t        while (this.rxWaste.length > 0) {\r\n\t            this.rxWaste.pop().unsubscribe();\r\n\t        }\r\n\t    };\r\n\t    FBUsers = __decorate([\r\n\t        core_1.Injectable(), \r\n\t        __metadata('design:paramtypes', [angularfire2_1.AngularFire, user_bus_1.FBUserBusFactory])\r\n\t    ], FBUsers);\r\n\t    return FBUsers;\r\n\t}());\r\n\texports.FBUsers = FBUsers;\r\n\n\n/***/ },\n\n/***/ 362:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar angularfire2_1 = __webpack_require__(72);\r\n\t(function (MatchRefRole) {\r\n\t    MatchRefRole[MatchRefRole[\"Inviter\"] = 0] = \"Inviter\";\r\n\t    MatchRefRole[MatchRefRole[\"Invitee\"] = 1] = \"Invitee\";\r\n\t})(exports.MatchRefRole || (exports.MatchRefRole = {}));\r\n\tvar MatchRefRole = exports.MatchRefRole;\r\n\t(function (MatchRefState) {\r\n\t    // hard coded values, don't change used in DB.\r\n\t    MatchRefState[MatchRefState[\"Invite\"] = 0] = \"Invite\";\r\n\t    MatchRefState[MatchRefState[\"Ready\"] = 1] = \"Ready\";\r\n\t    MatchRefState[MatchRefState[\"InPlay\"] = 2] = \"InPlay\";\r\n\t    MatchRefState[MatchRefState[\"Done\"] = 3] = \"Done\";\r\n\t    MatchRefState[MatchRefState[\"Canceled\"] = 4] = \"Canceled\";\r\n\t})(exports.MatchRefState || (exports.MatchRefState = {}));\r\n\tvar MatchRefState = exports.MatchRefState;\r\n\tvar User = (function () {\r\n\t    function User() {\r\n\t    }\r\n\t    User.create = function (auth) {\r\n\t        var user = new User();\r\n\t        user.provider = angularfire2_1.AuthProviders[auth.provider];\r\n\t        var info;\r\n\t        switch (auth.provider) {\r\n\t            case angularfire2_1.AuthProviders.Twitter:\r\n\t                info = auth.twitter;\r\n\t                break;\r\n\t            case angularfire2_1.AuthProviders.Facebook:\r\n\t                info = auth.facebook;\r\n\t                break;\r\n\t        }\r\n\t        if (info) {\r\n\t            user.displayName = info.displayName;\r\n\t            user.pic = info.profileImageURL;\r\n\t        }\r\n\t        return user;\r\n\t    };\r\n\t    return User;\r\n\t}());\r\n\texports.User = User;\r\n\n\n/***/ },\n\n/***/ 139:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar User_1 = __webpack_require__(362);\r\n\texports.User = User_1.User;\r\n\texports.MatchRefRole = User_1.MatchRefRole;\r\n\texports.MatchRefState = User_1.MatchRefState;\r\n\tvar FBUser_1 = __webpack_require__(361);\r\n\texports.FBUser = FBUser_1.FBUser;\r\n\tvar FBUsers_service_1 = __webpack_require__(512);\r\n\texports.FBUsers = FBUsers_service_1.FBUsers;\r\n\n\n/***/ },\n\n/***/ 513:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(514));\r\n\n\n/***/ },\n\n/***/ 514:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar sidenav_1 = __webpack_require__(137);\r\n\tvar ng2_chess_1 = __webpack_require__(47);\r\n\tvar dom_svg_board_1 = __webpack_require__(86);\r\n\tvar chessjs_1 = __webpack_require__(141);\r\n\tvar domain_1 = __webpack_require__(355);\r\n\tvar currentUserFilter_pipe_1 = __webpack_require__(509);\r\n\tvar onlineFilter_pipe_1 = __webpack_require__(515);\r\n\tvar Online = (function () {\r\n\t    function Online(users, login, match) {\r\n\t        var _this = this;\r\n\t        this.users = users;\r\n\t        this.login = login;\r\n\t        this.match = match;\r\n\t        this.rxWaste = [];\r\n\t        var subs = users.currentUser$.subscribe(function (user) {\r\n\t            _this.user = user;\r\n\t            if (user) {\r\n\t                user.user$.first().subscribe(function (u) {\r\n\t                    if (u.playing) {\r\n\t                        user.setPlaying(false);\r\n\t                    }\r\n\t                    // TODO: put in an observable.\r\n\t                    // in HTML remove filter, use special firebase query on the users$ list.\r\n\t                    setTimeout(function () { return user.keepAlive(); }, 16);\r\n\t                    // Send keep alive every 2.5 minutes\r\n\t                    var clearCode = setInterval(function () {\r\n\t                        user.keepAlive();\r\n\t                    }, 1000 * 60 * 2.5);\r\n\t                    _this.rxWaste.push({ unsubscribe: function () { return clearInterval(clearCode); } });\r\n\t                });\r\n\t                var subs_1 = user.bus.incoming$.subscribe(function (msg) { return _this.onBusMessage(msg); });\r\n\t                _this.rxWaste.push(subs_1);\r\n\t            }\r\n\t        });\r\n\t        this.rxWaste.push(subs);\r\n\t    }\r\n\t    Online.prototype.ngAfterViewInit = function () {\r\n\t        var _this = this;\r\n\t        this.ctrl = this.board.ctrl;\r\n\t        this.ctrl.init()\r\n\t            .then(function () { return _this.sidenav.toggle(true); });\r\n\t    };\r\n\t    Online.prototype.ngOnDestroy = function () {\r\n\t        while (this.rxWaste.length > 0) {\r\n\t            this.rxWaste.pop().unsubscribe();\r\n\t        }\r\n\t        this.users.destroy();\r\n\t    };\r\n\t    Online.prototype.onAvailabilityChange = function (event) {\r\n\t        this.user.user.available = event.checked;\r\n\t        this.user.update();\r\n\t    };\r\n\t    Online.prototype.userStatus = function (user) {\r\n\t        if (!user.available) {\r\n\t            return \"Not Available\";\r\n\t        }\r\n\t        else if (user.playing) {\r\n\t            return \"Playing\";\r\n\t        }\r\n\t        else {\r\n\t            return \"Available\";\r\n\t        }\r\n\t    };\r\n\t    /**\r\n\t     * return true if the current user can init a new match.\r\n\t     * the user's available property is not a factor in this check.\r\n\t     */\r\n\t    Online.prototype.isFree = function () {\r\n\t        return !this.liveMatch && !this.user.user.playing;\r\n\t    };\r\n\t    Online.prototype.canInvite = function () {\r\n\t        var su = this.selectedUser;\r\n\t        return this.isFree() && su && su.available && !su.playing;\r\n\t    };\r\n\t    Online.prototype.invite = function () {\r\n\t        if (this.canInvite()) {\r\n\t            this.user.invite(this.selectedUser);\r\n\t        }\r\n\t    };\r\n\t    Online.prototype.acceptInvite = function (mref) {\r\n\t        var _this = this;\r\n\t        return this.user.setPlaying(true)\r\n\t            .then(function () { return _this.match.createMatch(mref); })\r\n\t            .then(function () { return _this.user.acceptInvitation(mref); })\r\n\t            .then(function () { return _this.match.loadMatch(mref.matchId, _this.user); })\r\n\t            .then(function (liveMatch) { return _this.initGame(liveMatch); });\r\n\t    };\r\n\t    Online.prototype.logout = function () {\r\n\t        this.selectedUser = undefined;\r\n\t        this.login.logout();\r\n\t    };\r\n\t    Online.prototype.initGame = function (liveMatch) {\r\n\t        var _this = this;\r\n\t        this.liveMatch = liveMatch;\r\n\t        liveMatch.setState(domain_1.MatchRefState.InPlay);\r\n\t        this.ctrl\r\n\t            .setPlayer(ng2_chess_1.PieceColor.BLACK, ng2_chess_1.PlayerType.HUMAN)\r\n\t            .setPlayer(ng2_chess_1.PieceColor.WHITE, ng2_chess_1.PlayerType.HUMAN)\r\n\t            .newGame();\r\n\t        this.ctrl.onMoved$.subscribe(function (move) {\r\n\t            var p;\r\n\t            // if not our turn, it means that this move is for our turn\r\n\t            if (liveMatch.pieceColor !== _this.ctrl.turn) {\r\n\t                _this.board.blockUi(true);\r\n\t                p = liveMatch.setMove(move.toLongAlgebraic());\r\n\t            }\r\n\t            if (_this.ctrl.state !== ng2_chess_1.GAME_STATE.ACTIVE && _this.ctrl.state !== ng2_chess_1.GAME_STATE.CHECK) {\r\n\t                if (_this.liveMatch) {\r\n\t                    p = p || Promise.resolve();\r\n\t                    p.then(function () { return _this.endGameRoutine(domain_1.MatchRefState.Done); });\r\n\t                }\r\n\t            }\r\n\t        });\r\n\t        this.board.blockUi(!liveMatch.myTurn());\r\n\t        this.isInit = true;\r\n\t    };\r\n\t    Online.prototype.onBusMessage = function (msg) {\r\n\t        var _this = this;\r\n\t        //TODO: Handle this else where, to big for here.\r\n\t        var p;\r\n\t        //TODO: rejection is useless here, send message back to sender.\r\n\t        if (domain_1.MessageFactory.isInvite(msg)) {\r\n\t            this.tryHandleInviteResponse(msg);\r\n\t        }\r\n\t        else if (domain_1.MessageFactory.isMove(msg)) {\r\n\t            if (!this.isMatchOf(msg.data.matchId)) {\r\n\t                this.user.sendMsg(msg.sender, this.user.msgFactory.invalid(msg));\r\n\t            }\r\n\t            else {\r\n\t                this.tryMoveOpponent(msg)\r\n\t                    .catch(function (err) {\r\n\t                    _this.user.sendMsg(msg.sender, _this.user.msgFactory.outOfSync(msg.data.matchId, err.toString()));\r\n\t                    _this.endGameRoutine(domain_1.MatchRefState.Canceled); //TODO: Pop up message, why game ended.\r\n\t                });\r\n\t            }\r\n\t        }\r\n\t        else if (domain_1.MessageFactory.isOutOfSync(msg)) {\r\n\t            if (this.isMatchOf(msg.data.matchId)) {\r\n\t                this.endGameRoutine(domain_1.MatchRefState.Canceled); //TODO: Pop up message, why game ended.\r\n\t            }\r\n\t        }\r\n\t        return p;\r\n\t    };\r\n\t    /**\r\n\t     * Returns true if the current match matchId matches the matchId\r\n\t     * @param matchId\r\n\t     * @returns {boolean}\r\n\t       */\r\n\t    Online.prototype.isMatchOf = function (matchId) {\r\n\t        return (!this.liveMatch || this.liveMatch.match$key !== matchId) ? false : true;\r\n\t    };\r\n\t    Online.prototype.tryHandleInviteResponse = function (msg) {\r\n\t        var _this = this;\r\n\t        var reject = function (msg) { return Promise.reject(new Error(msg)); };\r\n\t        if (!this.isFree()) {\r\n\t            return reject('User is not available.');\r\n\t        }\r\n\t        else {\r\n\t            return this.users.getUser(msg.sender)\r\n\t                .then(function (user) { return !user && reject('Invalid sender.'); })\r\n\t                .then(function () { return _this.user.getMatchRef(msg.data.token); })\r\n\t                .then(function (mref) {\r\n\t                if (mref) {\r\n\t                    if (mref.state !== domain_1.MatchRefState.Invite) {\r\n\t                        return _this.user.responedToInvite(mref, false, 'Invalid invitation, try again.')\r\n\t                            .then(function () { return reject('Invite exists but in an invalid state.'); });\r\n\t                    }\r\n\t                    else if (msg.data.response === false) {\r\n\t                        // TODO: display reason?  msg.data.reason\r\n\t                        return Promise.all([\r\n\t                            _this.user.withdrawInvitation(mref, false),\r\n\t                            _this.user.responedToInvite(mref, false, 'Invalid invitation response.')\r\n\t                        ]);\r\n\t                    }\r\n\t                    else if (msg.data.response === true) {\r\n\t                        return _this.match.loadMatch(mref.matchId, _this.user)\r\n\t                            .then(function (liveMatch) {\r\n\t                            // verify the other user created the match as in invitation.\r\n\t                            if (_this.user.user$key !== mref.settings[liveMatch.mySide]) {\r\n\t                                return reject('Invalid match configuration, try again.');\r\n\t                            }\r\n\t                            return _this.user.setPlaying(true)\r\n\t                                .then(function () { return _this.user.updateMatchRefState(mref.matchId, domain_1.MatchRefState.Ready); })\r\n\t                                .then(function () { return _this.initGame(liveMatch); });\r\n\t                        });\r\n\t                    }\r\n\t                    else {\r\n\t                        return reject('Invite exists but message does not have a response');\r\n\t                    }\r\n\t                }\r\n\t                else {\r\n\t                    return _this.user.createMatchRef(domain_1.MatchRefRole.Invitee, msg.data.settings.white, msg.data.settings.black, msg.data.token);\r\n\t                }\r\n\t            });\r\n\t        }\r\n\t    };\r\n\t    Online.prototype.tryMoveOpponent = function (msg) {\r\n\t        var _this = this;\r\n\t        var reject = function (msg) { return Promise.reject(new Error(msg)); };\r\n\t        if (this.liveMatch.myTurn()) {\r\n\t            return reject('Illegal move, not your turn.');\r\n\t        }\r\n\t        try {\r\n\t            var chessMove = ng2_chess_1.util.move.fromLongAlgebraic(msg.data.move), piece = this.ctrl.getPiece(chessMove.from), block = this.ctrl.getBlock(chessMove.to);\r\n\t            if (!piece) {\r\n\t                return reject('Invalid move, no piece on source block.');\r\n\t            }\r\n\t            return this.ctrl.move(piece, block, chessMove.promotion)\r\n\t                .then(function (move) { return move.invalid && Promise.reject(new Error('Invalid move')); })\r\n\t                .then(function () { return _this.board.blockUi(false); });\r\n\t        }\r\n\t        catch (err) {\r\n\t            return Promise.reject(err);\r\n\t        }\r\n\t    };\r\n\t    Online.prototype.endGameRoutine = function (state) {\r\n\t        var _this = this;\r\n\t        this.board.blockUi(true);\r\n\t        var r = function () {\r\n\t            _this.ctrl.destroy();\r\n\t            _this.liveMatch.destroy();\r\n\t            _this.liveMatch = undefined;\r\n\t        };\r\n\t        this.user.setPlaying(false);\r\n\t        return this.liveMatch.setState(state)\r\n\t            .then(r)\r\n\t            .catch(r);\r\n\t    };\r\n\t    __decorate([\r\n\t        core_1.ViewChild('sidenav'), \r\n\t        __metadata('design:type', sidenav_1.MdSidenav)\r\n\t    ], Online.prototype, \"sidenav\", void 0);\r\n\t    __decorate([\r\n\t        core_1.ViewChild('board'), \r\n\t        __metadata('design:type', ng2_chess_1.ChessBoard)\r\n\t    ], Online.prototype, \"board\", void 0);\r\n\t    Online = __decorate([\r\n\t        core_1.Component({\r\n\t            selector: 'online',\r\n\t            providers: chessjs_1.CHESSJS_CHESS_GAME_PROVIDERS.slice(),\r\n\t            directives: dom_svg_board_1.DOM_SVG_KIT_DIRECTIVES.slice(),\r\n\t            pipes: [currentUserFilter_pipe_1.CurrentUserFilter, onlineFilter_pipe_1.OnlineFilter],\r\n\t            styles: [__webpack_require__(555)],\r\n\t            template: __webpack_require__(556)\r\n\t        }), \r\n\t        __metadata('design:paramtypes', [domain_1.FBUsers, domain_1.LoginFirebase, domain_1.FBMatches])\r\n\t    ], Online);\r\n\t    return Online;\r\n\t}());\r\n\texports.Online = Online;\r\n\n\n/***/ },\n\n/***/ 555:\n/***/ function(module, exports) {\n\n\tmodule.exports = \":host {\\n  height: 100%;\\n  display: flex;\\n}\\n\\n.md-sidenav-side {\\n  width: 320px;\\n}\\n\\n.settings-button {\\n  position: absolute;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  z-index: 5000;\\n}\\n\\n.sidenav-layout {\\n  flex: 1;\\n}\\n\\n.sidenav-spinner {\\n  margin: auto;\\n  margin-top: 20%;\\n}\\n\\n.settings-container {\\n  padding: 12px;\\n}\\n\\n.user-list-item {\\n  display: block;\\n  cursor: pointer;\\n}\\n.user-list-item.selected  {\\n  background-color: rgba(0, 150, 136, 0.35);\\n}\\n\\n.invite-button {\\n  width: 100%;\\n}\\n\\n.invitation-container {\\n  display: flex;\\n\\n}\\n.invitation-container img {\\n  width: 50px;\\n  height: 50px;\\n  border-radius: 50%;\\n  margin-right: 10px;\\n}\\n.invitation-actions {\\n  text-align: center;\\n}\\n.board-container {\\n  flex: 5 0px;\\n}\\n.board-container, .board-container:hover {\\n  box-shadow: none;\\n  background-color: transparent;\\n}\\n\\n.game-toolbar {\\n  display: flex;\\n  justify-content: center;\\n}\\n\\n.game-toolbar > * {\\n  margin: 5px;\\n}\\n.svg-chess-board {\\n  margin: auto;\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n@media (min-height: 400px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 200px;\\n    max-height: 200px;\\n  }\\n}\\n\\n@media (min-height: 600px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 400px;\\n    max-height: 400px;\\n  }\\n}\\n\\n@media (min-height: 700px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 500px;\\n    max-height: 500px;\\n  }\\n}\\n\\n@media (min-height: 800px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 600px;\\n    max-height: 600px;\\n  }\\n}\\n\\n@media (min-height: 900px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 700px;\\n    max-height: 700px;\\n  }\\n}\\n\"\n\n/***/ },\n\n/***/ 556:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<button class=\\\"settings-button\\\" md-fab (click)=\\\"sidenav.toggle()\\\">\\n  <md-icon class=\\\"md-24\\\">settings</md-icon>\\n</button>\\n<md-sidenav-layout class=\\\"sidenav-layout\\\">\\n  <md-sidenav #sidenav mode=\\\"side\\\">\\n    <md-spinner class=\\\"sidenav-spinner\\\" *ngIf=\\\"!users.authDone\\\"></md-spinner>\\n\\n    <div class=\\\"settings-container\\\" *ngIf=\\\"users.authDone\\\">\\n      <div class=\\\"logged-out\\\" *ngIf=\\\"!user\\\">\\n        <span>Sign in:</span>\\n        <button md-button (click)=\\\"login.twitter()\\\">Twitter</button>\\n        <button md-button (click)=\\\"login.facebook()\\\">Facebook</button>\\n      </div>\\n      <div class=\\\"logged-in\\\" *ngIf=\\\"user?.user\\\">\\n        <div class=\\\"my-status\\\">\\n          <md-checkbox [checked]=\\\"user.user.available\\\"\\n                       (change)=\\\"onAvailabilityChange($event)\\\"\\n                       align=\\\"end\\\">I'm Available for play</md-checkbox>\\n          <button md-mini-fab (click)=\\\"login.logout()\\\" style=\\\"float: right\\\">\\n            <md-icon class=\\\"md-24\\\">power_settings_new</md-icon>\\n          </button>\\n          <div  *ngFor=\\\"let mr of user.matchRefs$ | async\\\">\\n            <md-card *ngIf=\\\"mr.state === 0 && mr.role === 1\\\">\\n              <md-card-title>Match Pending</md-card-title>\\n              <md-card-subtitle>Waiting for action</md-card-subtitle>\\n              <md-card-content class=\\\"invitation-container\\\">\\n                <img [src]=\\\"mr.user_?.pic\\\" alt=\\\"Image of {{mr.user_?.displayName}}\\\">\\n                <p>You have a pending invitation from {{mr.user_?.displayName}}</p>\\n              </md-card-content>\\n              <md-card-actions class=\\\"invitation-actions\\\">\\n                <button md-raised-button color=\\\"primary\\\" (click)=\\\"acceptInvite(mr)\\\">ACCEPT</button>\\n                <button md-raised-button color=\\\"warn\\\" (click)=\\\"user.withdrawInvitation(mr, true)\\\">DECLINE</button>\\n              </md-card-actions>\\n            </md-card>\\n            <md-card *ngIf=\\\"mr.state === 0 && mr.role === 0\\\">\\n              <md-card-title>Match Pending</md-card-title>\\n              <md-card-subtitle>Waiting for response.</md-card-subtitle>\\n              <md-card-content class=\\\"invitation-container\\\">\\n                <img [src]=\\\"mr.user_?.pic\\\" alt=\\\"Image of {{mr.user_?.displayName}}\\\">\\n                <p>You have sent an invitation to {{mr.user_?.displayName}}</p>\\n              </md-card-content>\\n              <md-card-actions class=\\\"invitation-actions\\\">\\n                <button md-raised-button color=\\\"warn\\\" (click)=\\\"user.withdrawInvitation(mr, true)\\\">CANCEL</button>\\n              </md-card-actions>\\n            </md-card>\\n\\n          </div>\\n        </div>\\n        <div class=\\\"online-users\\\" *ngIf=\\\"user?.user$key\\\">\\n          <md-list>\\n            <h3 style=\\\"text-align: center; margin-top: 20px; border-top: 2px solid lightblue; border-bottom: 2px solid lightblue\\\">ALPHA Release</h3>\\n            <button class=\\\"invite-button\\\" md-raised-button color=\\\"accent\\\" [disabled]=\\\"!canInvite()\\\" (click)=\\\"invite()\\\">Invite to play</button>\\n            <br><br>\\n            <h3 md-subheader>Online Players</h3>\\n            <md-list-item class=\\\"user-list-item\\\"\\n                          *ngFor=\\\"let user of users.users$ | async | online | currentUser:user.user$key\\\"\\n                          *ngIf=\\\"user.available\\\"\\n                          [class.selected]=\\\"selectedUser === user\\\"\\n                          (click)=\\\"selectedUser = user\\\">\\n                <img md-list-avatar [src]=\\\"user.pic\\\" alt=\\\"Image of {{user.displayName}}\\\">\\n                <h3 md-line>{{user.displayName}}</h3>\\n                <span md-line>{{userStatus(user)}}</span>\\n            </md-list-item>\\n          </md-list>\\n        </div>\\n      </div>\\n    </div>\\n  </md-sidenav>\\n  <md-card class=\\\"board-container\\\">\\n    <br>\\n    <chess-board class=\\\"svg-chess-board\\\" #board></chess-board>\\n  </md-card>\\n  <div>\\n    <p style=\\\"text-align: center; margin-top: 0\\\">First alpha release of online support, expect missing features, glitches and bugs!</p>\\n    <p style=\\\"text-align: center; margin-top: 0\\\">Restart should always help :), posting an GH issue is apperciated!</p>\\n  </div>\\n</md-sidenav-layout>\\n\\n\"\n\n/***/ },\n\n/***/ 515:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\tvar OnlineFilter = (function () {\r\n\t    function OnlineFilter() {\r\n\t    }\r\n\t    OnlineFilter.prototype.transform = function (value) {\r\n\t        var d = new Date().getTime(), gap = 1000 * 60 * 7; // 7 minutes\r\n\t        return value ? value.filter(function (u) { return u.lastSeen && d > u.lastSeen && d - u.lastSeen < gap; }) : value;\r\n\t    };\r\n\t    OnlineFilter = __decorate([\r\n\t        core_1.Pipe({\r\n\t            name: 'online'\r\n\t        }), \r\n\t        __metadata('design:paramtypes', [])\r\n\t    ], OnlineFilter);\r\n\t    return OnlineFilter;\r\n\t}());\r\n\texports.OnlineFilter = OnlineFilter;\r\n\n\n/***/ },\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\t/*\r\n\t * Providers provided by Angular\r\n\t */\r\n\tvar platform_browser_dynamic_1 = __webpack_require__(315);\r\n\t/*\r\n\t* Platform and Environment\r\n\t* our providers/directives/pipes\r\n\t*/\r\n\tvar browser_1 = __webpack_require__(545);\r\n\tvar environment_1 = __webpack_require__(548);\r\n\t/*\r\n\t* App Component\r\n\t* our top level component that holds all of our components\r\n\t*/\r\n\tvar app_1 = __webpack_require__(508);\r\n\t/*\r\n\t * Bootstrap our Angular app with a top level component `App` and inject\r\n\t * our Services and Providers into Angular's dependency injection\r\n\t */\r\n\tfunction main(initialHmrState) {\r\n\t    return platform_browser_dynamic_1.bootstrap(app_1.App, browser_1.PROVIDERS.concat(environment_1.ENV_PROVIDERS, browser_1.DIRECTIVES, browser_1.PIPES, app_1.APP_PROVIDERS))\r\n\t        .catch(function (err) { return console.error(err); });\r\n\t}\r\n\texports.main = main;\r\n\t/*\r\n\t * Vendors\r\n\t * For vendors for example jQuery, Lodash, angular2-jwt just import them anywhere in your app\r\n\t * You can also import them in vendors to ensure that they are bundled in one file\r\n\t * Also see custom-typings.d.ts as you also need to do `typings install x` where `x` is your module\r\n\t */\r\n\t/*\r\n\t * Hot Module Reload\r\n\t * experimental version by @gdi2290\r\n\t */\r\n\tif (false) {\r\n\t    // activate hot module reload\r\n\t    var ngHmr = require('angular2-hmr');\r\n\t    ngHmr.hotModuleReplacement(main, module);\r\n\t}\r\n\telse {\r\n\t    // bootstrap when document is ready\r\n\t    document.addEventListener('DOMContentLoaded', function () { return main(); });\r\n\t}\r\n\n\n/***/ },\n\n/***/ 371:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar button_1 = __webpack_require__(342);\r\n\tvar card_1 = __webpack_require__(343);\r\n\tvar checkbox_1 = __webpack_require__(344);\r\n\tvar input_1 = __webpack_require__(348);\r\n\tvar list_1 = __webpack_require__(349);\r\n\tvar progress_bar_1 = __webpack_require__(350);\r\n\tvar progress_circle_1 = __webpack_require__(351);\r\n\tvar radio_1 = __webpack_require__(352);\r\n\tvar sidenav_1 = __webpack_require__(137);\r\n\tvar toolbar_1 = __webpack_require__(354);\r\n\tvar icon_1 = __webpack_require__(347);\r\n\t/*\r\n\t * we are grouping the module so we only need to manage the imports in one location\r\n\t */\r\n\texports.MATERIAL_PIPES = [];\r\n\texports.MATERIAL_DIRECTIVES = sidenav_1.MD_SIDENAV_DIRECTIVES.concat([\r\n\t    button_1.MdAnchor,\r\n\t    button_1.MdButton,\r\n\t    toolbar_1.MdToolbar,\r\n\t    checkbox_1.MdCheckbox,\r\n\t    radio_1.MdRadioButton,\r\n\t    radio_1.MdRadioGroup,\r\n\t    progress_circle_1.MdSpinner,\r\n\t    progress_bar_1.MdProgressBar,\r\n\t    progress_circle_1.MdProgressCircle\r\n\t], input_1.MD_INPUT_DIRECTIVES, list_1.MD_LIST_DIRECTIVES, card_1.MD_CARD_DIRECTIVES, icon_1.MD_ICON_DIRECTIVES);\r\n\texports.MATERIAL_PROVIDERS = [\r\n\t    radio_1.MdRadioDispatcher,\r\n\t    icon_1.MdIconRegistry\r\n\t];\r\n\n\n/***/ },\n\n/***/ 543:\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*\r\n\t * These are globally available directives in any template\r\n\t */\r\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\t// Angular 2 Router\r\n\tvar router_deprecated_1 = __webpack_require__(133);\r\n\t// Angular 2 Material 2\r\n\t// TODO(gdi2290): replace with @angular2-material/all\r\n\tvar angular2_material2_1 = __webpack_require__(371);\r\n\t// application_directives: directives that are global through out the application\r\n\texports.APPLICATION_DIRECTIVES = router_deprecated_1.ROUTER_DIRECTIVES.concat(angular2_material2_1.MATERIAL_DIRECTIVES);\r\n\texports.DIRECTIVES = [\r\n\t    { provide: core_1.PLATFORM_DIRECTIVES, multi: true, useValue: exports.APPLICATION_DIRECTIVES }\r\n\t];\r\n\n\n/***/ },\n\n/***/ 544:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar angularfire2_1 = __webpack_require__(72);\r\n\texports.FIREBASE_PROVIDERS = [\r\n\t    angularfire2_1.FIREBASE_PROVIDERS,\r\n\t    angularfire2_1.defaultFirebase('https://angular2-chess.firebaseio.com')\r\n\t];\r\n\n\n/***/ },\n\n/***/ 545:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(543));\r\n\t__export(__webpack_require__(546));\r\n\t__export(__webpack_require__(547));\r\n\n\n/***/ },\n\n/***/ 546:\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*\r\n\t * These are globally available pipes in any template\r\n\t */\r\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(1);\r\n\t// application_pipes: pipes that are global through out the application\r\n\texports.APPLICATION_PIPES = [];\r\n\texports.PIPES = [\r\n\t    { provide: core_1.PLATFORM_PIPES, multi: true, useValue: exports.APPLICATION_PIPES }\r\n\t];\r\n\n\n/***/ },\n\n/***/ 547:\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*\r\n\t * These are globally available services in any component or any other service\r\n\t */\r\n\t\"use strict\";\r\n\t// Angular 2\r\n\tvar common_1 = __webpack_require__(35);\r\n\t// Angular 2 Http\r\n\tvar http_1 = __webpack_require__(196);\r\n\t// Angular 2 Router\r\n\tvar router_deprecated_1 = __webpack_require__(133);\r\n\t// Angular 2 Material\r\n\t// TODO(gdi2290): replace with @angular2-material/all\r\n\tvar angular2_material2_1 = __webpack_require__(371);\r\n\t// Angular fire 2\r\n\tvar firebase_1 = __webpack_require__(544);\r\n\t/*\r\n\t* Application Providers/Directives/Pipes\r\n\t* providers/directives/pipes that only live in our browser environment\r\n\t*/\r\n\texports.APPLICATION_PROVIDERS = common_1.FORM_PROVIDERS.concat(http_1.HTTP_PROVIDERS, angular2_material2_1.MATERIAL_PROVIDERS, router_deprecated_1.ROUTER_PROVIDERS, [\r\n\t    { provide: common_1.LocationStrategy, useClass: common_1.HashLocationStrategy }\r\n\t], firebase_1.FIREBASE_PROVIDERS);\r\n\texports.PROVIDERS = exports.APPLICATION_PROVIDERS.slice();\r\n\n\n/***/ },\n\n/***/ 548:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\t// Angular 2\r\n\tvar core_1 = __webpack_require__(1);\r\n\t// Environment Providers\r\n\tvar PROVIDERS = [];\r\n\tif (true) {\r\n\t    // Production\r\n\t    core_1.enableProdMode();\r\n\t    PROVIDERS = PROVIDERS.slice();\r\n\t}\r\n\telse {\r\n\t    // Development\r\n\t    PROVIDERS = PROVIDERS.slice();\r\n\t}\r\n\texports.ENV_PROVIDERS = PROVIDERS.slice();\r\n\n\n/***/ }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** main.60520676bce6cba89df2.bundle.js\n **/","import {HmrStore} from './hmr-store';\n\n// noop in parentNode\n// TODO: find a better way to noop\nconst _env = typeof process !== 'undefined' &&\n  process &&\n  process.env &&\n  (process.env.ENV ||\n  process.env.NODE_ENV);\n\nlet _dev: boolean = ((\n    _env &&\n    typeof _env === 'string' &&\n    (_env.indexOf('dev') > -1)\n  ) || // default true\n    _env === undefined);\n\nexport function setDev(newDev: string | boolean): boolean | void {\n  if (typeof newDev === 'string') {\n    return _dev = (newDev.indexOf('dev') > -1);\n  } else if (typeof newDev === 'boolean') {\n    return _dev = newDev;\n  }\n  throw new Error('Please provide a string or boolean');\n}\n\nexport function HmrState(namespaceOrConfig?: string | any, config?: any): Function {\n\n  function decoratorFactory(target: any, decoratedPropertyName?: string, descriptor?: any): void {\n    if (!_dev) { return descriptor; }\n\n    let key = namespaceOrConfig || target.constructor.name + '#' + decoratedPropertyName;\n    HmrStore.select(key, () => HmrStore.get(key));\n\n    Object.defineProperty(target, decoratedPropertyName, {\n      get: () => HmrStore.get(key),\n      set: (newValue?: any) => {\n\n        let currentValue = HmrStore.get(key);\n        if (!currentValue) {\n          HmrStore._initialValues[key] = newValue;\n        } else {\n          newValue = Object.assign(newValue, currentValue);\n        }\n        return HmrStore.set(key, newValue);\n\n      },\n      enumerable: true,\n      configurable: true\n    });\n    return descriptor;\n  }\n\n  return decoratorFactory;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/angular2-hmr/src/hmr-decorator.ts\n **/","\nexport class OpaqueToken {\n  constructor(private _desc: string) {}\n\n  toString(): string { return `Token ${this._desc}`; }\n}\n\nexport const HMR_STATE = new OpaqueToken('hmrState');\n\nexport class HmrStore {\n  static dev = false;\n  static _state = {};\n  static _initialValues = {};\n  static _states = [];\n\n  static set(prop, value) {\n    HmrStore._state[prop] = value;\n    return HmrStore._state[prop];\n  }\n\n  static get(prop) {\n    return HmrStore._state[prop];\n  }\n\n  static select(name, getState) {\n    HmrStore._states.push({ name, getState });\n    let defaultData = getState();\n    let currentData = HmrStore.get(name);\n\n    if (defaultData && !currentData) {\n      return HmrStore.set(name, defaultData);\n    } else if (defaultData && currentData) {\n      return HmrStore.set(name, (<any>Object).assign({}, defaultData, currentData));\n    } else {\n      return HmrStore.set(name, currentData || defaultData);\n    }\n  }\n\n  static dispose() {\n    HmrStore._states = [];\n    HmrStore._state = {};\n    HmrStore._initialValues = {};\n  }\n\n  static getState() {\n    let initialState = (<any>Object).assign({}, HmrStore._state);\n    return HmrStore._states\n      .reduce((memo, item) => {\n        memo[item.name] = item.getState();\n        return memo;\n      }, initialState);\n  }\n  static toJSON() {\n    return HmrStore.getState();\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/angular2-hmr/src/hmr-store.ts\n **/","import {HMR_STATE, HmrStore} from './hmr-store';\n\nexport * from './webpack-hmr';\nexport * from './hmr-decorator';\nexport * from './hmr-store';\n\n\nexport function provideHmrState(initialState = {}): Array<any> {\n  return [\n    {provide: HMR_STATE, useValue: initialState },\n    {provide: HmrStore, useValue: HmrStore}\n  ];\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/angular2-hmr/src/index.ts\n **/","import {HmrStore} from './hmr-store';\n\nexport interface HotModuleReplacementOptions {\n  LOCALSTORAGE_KEY?: string;\n  localStorage?: boolean;\n  storeToken?: any;\n  globalDispose?: string;\n\n  getState?: Function;\n  data?: any;\n}\n\nexport function hotModuleReplacement(bootloader: Function, module: any, options: HotModuleReplacementOptions = {}) {\n  if (!module.hot) {\n    console.warn('Warning: please use webpack hot flag');\n    return document.addEventListener('DOMContentLoaded', () => bootloader());\n  }\n\n  HmrStore.dev = true;\n  const LOCALSTORAGE_KEY = options.LOCALSTORAGE_KEY || '@@WEBPACK_INITIAL_DATA';\n  const LOCAL            = options.localStorage     || false;\n  const TOKEN            = options.storeToken       || HmrStore;\n  const DISPOSE          = options.globalDispose    || 'WEBPACK_HMR_beforeunload';\n  const GET_STATE        = options.getState         || getState;\n  let DATA               = options.data             || module.hot.data && module.hot.data.state;\n  let COMPONENT_REF = null;\n  let disposed = false;\n\n  function getState(appState) {\n    const json = appState.toJSON();\n\n    if (LOCAL) {\n      console.time('localStorage');\n      localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(appState));\n      console.timeEnd('localStorage');\n    }\n    return json;\n  }\n\n  console.log('DATA', DATA);\n  if (!DATA && LOCAL) {\n    try {\n      console.time('start localStorage');\n      DATA = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY)) || DATA;\n      console.timeEnd('start localStorage');\n    } catch (e) {\n      console.log('JSON.parse Error', e);\n    }\n  }\n  console.time('bootstrap');\n  if (document.readyState === 'complete') {\n    bootloader(DATA)\n      .then((cmpRef: any) => COMPONENT_REF = cmpRef)\n      .then((cmpRef => (console.timeEnd('bootstrap'), cmpRef)));\n  } else {\n    document.addEventListener('DOMContentLoaded', () => {\n      bootloader(DATA)\n        .then((cmpRef: any) => COMPONENT_REF = cmpRef)\n        .then((cmpRef => (console.timeEnd('bootstrap'), cmpRef)));\n    });\n  }\n\n\n\n  function beforeunload(event) {\n    const injector = COMPONENT_REF.injector;\n    let appState;\n    if ('getOptional' in injector) {\n      appState = COMPONENT_REF.injector.getOptional(TOKEN) || TOKEN;\n    } else {\n      appState = COMPONENT_REF.injector.get(TOKEN, TOKEN);\n    }\n    return GET_STATE(appState);\n  }\n  (<any>window)[DISPOSE] = () => {\n    disposed = true;\n    window.removeEventListener('beforeunload', beforeunload);\n    if (LOCAL) {\n      localStorage.removeItem(LOCALSTORAGE_KEY);\n    }\n  };\n\n  module.hot.accept();\n\n  window.addEventListener('beforeunload', beforeunload);\n\n  module.hot.dispose((data: any) => {\n    console.time('dispose');\n    const componentNode = COMPONENT_REF.location.nativeElement;\n    const newNode = document.createElement(componentNode.tagName);\n    // display none\n    const currentDisplay = newNode.style.display;\n    newNode.style.display = 'none';\n    const parentNode = componentNode.parentNode;\n    parentNode.insertBefore(newNode, componentNode);\n\n    const injector = COMPONENT_REF.injector;\n    let appState;\n    if ('getOptional' in injector) {\n      appState = COMPONENT_REF.injector.getOptional(TOKEN) || TOKEN;\n    } else {\n      appState = COMPONENT_REF.injector.get(TOKEN, TOKEN);\n    }\n    const json = GET_STATE(appState, COMPONENT_REF);\n\n    data.state = json;\n\n    if ('destroy' in COMPONENT_REF) {\n      COMPONENT_REF.destroy();\n    } else if ('dispose' in COMPONENT_REF) {\n      COMPONENT_REF.dispose();\n    }\n\n    newNode.style.display = currentDisplay;\n\n    if (!disposed) {\n      window.removeEventListener('beforeunload', beforeunload);\n    }\n    disposed = true;\n    console.timeEnd('dispose');\n  });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/angular2-hmr/src/webpack-hmr.ts\n **/","module.exports = \"/*! normalize.css v4.1.1 | MIT License | github.com/necolas/normalize.css */\\n\\n/**\\n * 1. Change the default font family in all browsers (opinionated).\\n * 2. Prevent adjustments of font size after orientation changes in IE and iOS.\\n */\\n\\nhtml {\\n  font-family: sans-serif; /* 1 */\\n  -ms-text-size-adjust: 100%; /* 2 */\\n  -webkit-text-size-adjust: 100%; /* 2 */\\n}\\n\\n/**\\n * Remove the margin in all browsers (opinionated).\\n */\\n\\nbody {\\n  margin: 0;\\n}\\n\\n/* HTML5 display definitions\\n   ========================================================================== */\\n\\n/**\\n * Add the correct display in IE 9-.\\n * 1. Add the correct display in Edge, IE, and Firefox.\\n * 2. Add the correct display in IE.\\n */\\n\\narticle,\\naside,\\ndetails, /* 1 */\\nfigcaption,\\nfigure,\\nfooter,\\nheader,\\nmain, /* 2 */\\nmenu,\\nnav,\\nsection,\\nsummary { /* 1 */\\n  display: block;\\n}\\n\\n/**\\n * Add the correct display in IE 9-.\\n */\\n\\naudio,\\ncanvas,\\nprogress,\\nvideo {\\n  display: inline-block;\\n}\\n\\n/**\\n * Add the correct display in iOS 4-7.\\n */\\n\\naudio:not([controls]) {\\n  display: none;\\n  height: 0;\\n}\\n\\n/**\\n * Add the correct vertical alignment in Chrome, Firefox, and Opera.\\n */\\n\\nprogress {\\n  vertical-align: baseline;\\n}\\n\\n/**\\n * Add the correct display in IE 10-.\\n * 1. Add the correct display in IE.\\n */\\n\\ntemplate, /* 1 */\\n[hidden] {\\n  display: none;\\n}\\n\\n/* Links\\n   ========================================================================== */\\n\\n/**\\n * 1. Remove the gray background on active links in IE 10.\\n * 2. Remove gaps in links underline in iOS 8+ and Safari 8+.\\n */\\n\\na {\\n  background-color: transparent; /* 1 */\\n  -webkit-text-decoration-skip: objects; /* 2 */\\n}\\n\\n/**\\n * Remove the outline on focused links when they are also active or hovered\\n * in all browsers (opinionated).\\n */\\n\\na:active,\\na:hover {\\n  outline-width: 0;\\n}\\n\\n/* Text-level semantics\\n   ========================================================================== */\\n\\n/**\\n * 1. Remove the bottom border in Firefox 39-.\\n * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari.\\n */\\n\\nabbr[title] {\\n  border-bottom: none; /* 1 */\\n  text-decoration: underline; /* 2 */\\n  text-decoration: underline dotted; /* 2 */\\n}\\n\\n/**\\n * Prevent the duplicate application of `bolder` by the next rule in Safari 6.\\n */\\n\\nb,\\nstrong {\\n  font-weight: inherit;\\n}\\n\\n/**\\n * Add the correct font weight in Chrome, Edge, and Safari.\\n */\\n\\nb,\\nstrong {\\n  font-weight: bolder;\\n}\\n\\n/**\\n * Add the correct font style in Android 4.3-.\\n */\\n\\ndfn {\\n  font-style: italic;\\n}\\n\\n/**\\n * Correct the font size and margin on `h1` elements within `section` and\\n * `article` contexts in Chrome, Firefox, and Safari.\\n */\\n\\nh1 {\\n  font-size: 2em;\\n  margin: 0.67em 0;\\n}\\n\\n/**\\n * Add the correct background and color in IE 9-.\\n */\\n\\nmark {\\n  background-color: #ff0;\\n  color: #000;\\n}\\n\\n/**\\n * Add the correct font size in all browsers.\\n */\\n\\nsmall {\\n  font-size: 80%;\\n}\\n\\n/**\\n * Prevent `sub` and `sup` elements from affecting the line height in\\n * all browsers.\\n */\\n\\nsub,\\nsup {\\n  font-size: 75%;\\n  line-height: 0;\\n  position: relative;\\n  vertical-align: baseline;\\n}\\n\\nsub {\\n  bottom: -0.25em;\\n}\\n\\nsup {\\n  top: -0.5em;\\n}\\n\\n/* Embedded content\\n   ========================================================================== */\\n\\n/**\\n * Remove the border on images inside links in IE 10-.\\n */\\n\\nimg {\\n  border-style: none;\\n}\\n\\n/**\\n * Hide the overflow in IE.\\n */\\n\\nsvg:not(:root) {\\n  overflow: hidden;\\n}\\n\\n/* Grouping content\\n   ========================================================================== */\\n\\n/**\\n * 1. Correct the inheritance and scaling of font size in all browsers.\\n * 2. Correct the odd `em` font sizing in all browsers.\\n */\\n\\ncode,\\nkbd,\\npre,\\nsamp {\\n  font-family: monospace, monospace; /* 1 */\\n  font-size: 1em; /* 2 */\\n}\\n\\n/**\\n * Add the correct margin in IE 8.\\n */\\n\\nfigure {\\n  margin: 1em 40px;\\n}\\n\\n/**\\n * 1. Add the correct box sizing in Firefox.\\n * 2. Show the overflow in Edge and IE.\\n */\\n\\nhr {\\n  box-sizing: content-box; /* 1 */\\n  height: 0; /* 1 */\\n  overflow: visible; /* 2 */\\n}\\n\\n/* Forms\\n   ========================================================================== */\\n\\n/**\\n * 1. Change font properties to `inherit` in all browsers (opinionated).\\n * 2. Remove the margin in Firefox and Safari.\\n */\\n\\nbutton,\\ninput,\\nselect,\\ntextarea {\\n  font: inherit; /* 1 */\\n  margin: 0; /* 2 */\\n}\\n\\n/**\\n * Restore the font weight unset by the previous rule.\\n */\\n\\noptgroup {\\n  font-weight: bold;\\n}\\n\\n/**\\n * Show the overflow in IE.\\n * 1. Show the overflow in Edge.\\n */\\n\\nbutton,\\ninput { /* 1 */\\n  overflow: visible;\\n}\\n\\n/**\\n * Remove the inheritance of text transform in Edge, Firefox, and IE.\\n * 1. Remove the inheritance of text transform in Firefox.\\n */\\n\\nbutton,\\nselect { /* 1 */\\n  text-transform: none;\\n}\\n\\n/**\\n * 1. Prevent a WebKit bug where (2) destroys native `audio` and `video`\\n *    controls in Android 4.\\n * 2. Correct the inability to style clickable types in iOS and Safari.\\n */\\n\\nbutton,\\nhtml [type=\\\"button\\\"], /* 1 */\\n[type=\\\"reset\\\"],\\n[type=\\\"submit\\\"] {\\n  -webkit-appearance: button; /* 2 */\\n}\\n\\n/**\\n * Remove the inner border and padding in Firefox.\\n */\\n\\nbutton::-moz-focus-inner,\\n[type=\\\"button\\\"]::-moz-focus-inner,\\n[type=\\\"reset\\\"]::-moz-focus-inner,\\n[type=\\\"submit\\\"]::-moz-focus-inner {\\n  border-style: none;\\n  padding: 0;\\n}\\n\\n/**\\n * Restore the focus styles unset by the previous rule.\\n */\\n\\nbutton:-moz-focusring,\\n[type=\\\"button\\\"]:-moz-focusring,\\n[type=\\\"reset\\\"]:-moz-focusring,\\n[type=\\\"submit\\\"]:-moz-focusring {\\n  outline: 1px dotted ButtonText;\\n}\\n\\n/**\\n * Change the border, margin, and padding in all browsers (opinionated).\\n */\\n\\nfieldset {\\n  border: 1px solid #c0c0c0;\\n  margin: 0 2px;\\n  padding: 0.35em 0.625em 0.75em;\\n}\\n\\n/**\\n * 1. Correct the text wrapping in Edge and IE.\\n * 2. Correct the color inheritance from `fieldset` elements in IE.\\n * 3. Remove the padding so developers are not caught out when they zero out\\n *    `fieldset` elements in all browsers.\\n */\\n\\nlegend {\\n  box-sizing: border-box; /* 1 */\\n  color: inherit; /* 2 */\\n  display: table; /* 1 */\\n  max-width: 100%; /* 1 */\\n  padding: 0; /* 3 */\\n  white-space: normal; /* 1 */\\n}\\n\\n/**\\n * Remove the default vertical scrollbar in IE.\\n */\\n\\ntextarea {\\n  overflow: auto;\\n}\\n\\n/**\\n * 1. Add the correct box sizing in IE 10-.\\n * 2. Remove the padding in IE 10-.\\n */\\n\\n[type=\\\"checkbox\\\"],\\n[type=\\\"radio\\\"] {\\n  box-sizing: border-box; /* 1 */\\n  padding: 0; /* 2 */\\n}\\n\\n/**\\n * Correct the cursor style of increment and decrement buttons in Chrome.\\n */\\n\\n[type=\\\"number\\\"]::-webkit-inner-spin-button,\\n[type=\\\"number\\\"]::-webkit-outer-spin-button {\\n  height: auto;\\n}\\n\\n/**\\n * 1. Correct the odd appearance in Chrome and Safari.\\n * 2. Correct the outline style in Safari.\\n */\\n\\n[type=\\\"search\\\"] {\\n  -webkit-appearance: textfield; /* 1 */\\n  outline-offset: -2px; /* 2 */\\n}\\n\\n/**\\n * Remove the inner padding and cancel buttons in Chrome and Safari on OS X.\\n */\\n\\n[type=\\\"search\\\"]::-webkit-search-cancel-button,\\n[type=\\\"search\\\"]::-webkit-search-decoration {\\n  -webkit-appearance: none;\\n}\\n\\n/**\\n * Correct the text style of placeholders in Chrome, Edge, and Safari.\\n */\\n\\n::-webkit-input-placeholder {\\n  color: inherit;\\n  opacity: 0.54;\\n}\\n\\n/**\\n * 1. Correct the inability to style clickable types in iOS and Safari.\\n * 2. Change font properties to `inherit` in Safari.\\n */\\n\\n::-webkit-file-upload-button {\\n  -webkit-appearance: button; /* 1 */\\n  font: inherit; /* 2 */\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/normalize.css/normalize.css\n ** module id = 549\n ** module chunks = 3\n **/","import { Component, ViewEncapsulation } from '@angular/core';\nimport { RouteConfig } from '@angular/router-deprecated';\n\nimport { AppState } from './app.service';\nimport { Home } from './home';\nimport { Game } from './game';\nimport { Online } from './online';\n\nimport { FIREBASE_DOMAIN_PROVIDERS } from './online/domain';\n/*\n * App Component\n * Top Level Component\n */\n@Component({\n  selector: 'app',\n  pipes: [ ],\n  providers: [ ...FIREBASE_DOMAIN_PROVIDERS ], // make UserFirebase singletone to online page\n  encapsulation: ViewEncapsulation.None,\n  styles: [\n    require('normalize.css'),\n    require('./app.css')\n  ],\n  template: `\n    <md-content>\n      <md-toolbar color=\"primary\">\n          <span>{{ name }}</span>\n          <span class=\"fill\"></span>\n          <button md-button [routerLink]=\" ['Home'] \">Home</button>\n          <button md-button [routerLink]=\" ['Game'] \">Single</button>\n          <button md-button [routerLink]=\" ['Online'] \">Online Chess</button>\n      </md-toolbar>\n\n      <md-progress-bar mode=\"indeterminate\" color=\"primary\" *ngIf=\"loading\"></md-progress-bar>\n\n      <router-outlet></router-outlet>\n    </md-content>\n  `\n})\n@RouteConfig([\n  { path: '/home',  name: 'Home',  component: Home, useAsDefault: true },\n  { path: '/game',  name: 'Game',  component: Game },\n  { path: '/online',  name: 'Online',  component: Online }\n])\nexport class App {\n  loading = false;\n  name = 'Angular 2 Chess';\n\n  constructor(\n    public appState: AppState) {\n\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/app.component.ts\n **/","module.exports = \"html, body{\\n  height: 100%;\\n  background: #F4FAFA;\\n}\\nbutton.active{\\n  background: #fff;\\n  color: #009688;\\n}\\nbutton.active:hover{\\n  color: #fff;\\n}\\n.fill{\\n  flex: 1 1 auto;\\n}\\n.app-state{\\n  margin: 15px;\\n  flex: 1;\\n}\\n.home{\\n  flex: 1;\\n}\\nmd-content{\\n  display: flex;\\n  flex-direction: column;\\n  height: 100%;\\n}\\nfooter{\\n  flex: 0 0 60px;\\n  padding: 10px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  background: #fff;\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/app.css\n ** module id = 550\n ** module chunks = 3\n **/","import { Injectable } from '@angular/core';\nimport { HmrState } from 'angular2-hmr';\n\n@Injectable()\nexport class AppState {\n  // @HmrState() is used by HMR to track the state of any object during a hot module replacement\n  @HmrState() _state = { };\n\n  constructor() {\n\n  }\n\n  // already return a clone of the current state\n  get state() {\n    return this._state = this._clone(this._state);\n  }\n  // never allow mutation\n  set state(value) {\n    throw new Error('do not mutate the `.state` directly');\n  }\n\n\n  get(prop?: any) {\n    // use our state getter for the clone\n    const state = this.state;\n    return state[prop] || state;\n  }\n\n  set(prop: string, value: any) {\n    // internally mutate our state\n    return this._state[prop] = value;\n  }\n\n\n  _clone(object) {\n    // simple object clone\n    return JSON.parse(JSON.stringify( object ));\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/app.service.ts\n **/","import { Component, ViewChild, AfterViewInit, OnDestroy } from '@angular/core';\nimport { MdSidenav } from '@angular2-material/sidenav/sidenav';\nimport { MdRadioChange } from '@angular2-material/radio/radio';\n\nimport { ChessBoard, ChessBoardController, PieceColor, PlayerType, BaseBlock } from 'ng2-chess';\nimport { DOM_SVG_KIT_DIRECTIVES } from '../../packages/ng2-chess/plugins/ui/dom-svg-board';\nimport { CHESSJS_AI_CHESS_GAME_PROVIDERS } from '../../packages/ng2-chess/plugins/game/chessjs-ai';\n\nclass Player {\n  get rawtype(): string {\n    return PlayerType[this.type];\n  }\n  set rawtype(value: string) {\n    this.type = PlayerType[value];\n  }\n  constructor(public color: PieceColor, public type: PlayerType, public aiIndex: number) {\n\n  }\n}\n\n@Component({\n  selector: 'game',\n  providers: [ ...CHESSJS_AI_CHESS_GAME_PROVIDERS ],\n  directives: [ ...DOM_SVG_KIT_DIRECTIVES ],\n  pipes: [ ],\n  styles: [ require('./game.css') ],\n  template: require('./game.html')\n})\nexport class Game implements AfterViewInit, OnDestroy {\n  aiLevels = [1,2,3,4,5,6,7,8,9,10];\n\n  black: Player = new Player(PieceColor.BLACK, PlayerType.AI, 9);\n  white: Player = new Player(PieceColor.WHITE, PlayerType.HUMAN, 9);\n\n  workerSupported: boolean = typeof(Worker) !== \"undefined\";\n\n  @ViewChild('sidenav') private sidenav: MdSidenav;\n  @ViewChild('board') private board: ChessBoard;\n\n  isInit: boolean;\n\n  private ctrl: ChessBoardController;\n\n\n  constructor() {}\n\n  ngAfterViewInit() {\n    this.ctrl = this.board.ctrl;\n    this.ctrl.init()\n      .then( () => this.sidenav.toggle(true) );\n\n  }\n\n  ngOnDestroy() {\n    this.ctrl.destroy();\n  }\n\n  onPlayerTypeChange(event: MdRadioChange, player: Player): void {\n    this.ctrl.setPlayer(player.color, <any>PlayerType[event.value]);\n  }\n\n  onAILevelChange($event: Event, player: Player): void {\n    player.aiIndex = Number( (<any>$event.srcElement).selectedIndex);\n    this.ctrl.setPlayer(player.color, player.type, this.getLevel(player.aiIndex));\n  }\n\n  onNewGame(): void {\n    this.ctrl\n      .setPlayer(this.black.color, this.black.type, this.getLevel(this.black.aiIndex))\n      .setPlayer(this.white.color, this.white.type, this.getLevel(this.white.aiIndex))\n      .newGame();\n\n    this.isInit = true;\n  }\n\n  onStop(): void {\n    this.ctrl.aiStop();\n  }\n\n  hint(): void {\n    this.ctrl.aiNextMove().then( mv =>  this.ctrl.highlight(mv.to, mv.from) );\n  }\n\n  private getLevel(idx: number): number {\n    return this.aiLevels[idx];\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/game/game.component.ts\n **/","module.exports = \":host {\\n  height: 100%;\\n  display: flex;\\n}\\n\\n.md-sidenav-side {\\n  width: 250px;\\n}\\n\\n.settings-button {\\n  position: absolute;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  z-index: 5000;\\n}\\n\\n.sidenav-layout {\\n  flex: 1;\\n}\\n\\n.settings-container {\\n  padding: 24px;\\n\\n  display: flex;\\n  flex-flow: row wrap;\\n  align-items: stretch;\\n\\n  flex: 0 0 250px;\\n}\\n\\n.settings-container > div {\\n  flex: 1 100%;\\n}\\n\\n.form-row {\\n  margin: 15px 0;\\n}\\n\\n.config-section h3 {\\n  border-bottom: 1px solid #009688;\\n}\\n\\n.config-section {\\n  margin-bottom: 50px;\\n}\\n\\n.config-section:last-of-type {\\n  border-top: 1px solid #009688;\\n  border-bottom: 1px solid #009688;\\n  margin-bottom: 0;\\n}\\n\\n.board-container {\\n  flex: 5 0px;\\n}\\n.board-container, .board-container:hover {\\n  box-shadow: none;\\n  background-color: transparent;\\n}\\n\\n.game-toolbar {\\n  display: flex;\\n  justify-content: center;\\n}\\n\\n.game-toolbar > * {\\n  margin: 5px;\\n}\\n.svg-chess-board {\\n  margin: auto;\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n@media (min-height: 400px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 200px;\\n    max-height: 200px;\\n  }\\n}\\n\\n@media (min-height: 600px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 400px;\\n    max-height: 400px;\\n  }\\n}\\n\\n@media (min-height: 700px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 500px;\\n    max-height: 500px;\\n  }\\n}\\n\\n@media (min-height: 800px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 600px;\\n    max-height: 600px;\\n  }\\n}\\n\\n@media (min-height: 900px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 700px;\\n    max-height: 700px;\\n  }\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/game/game.css\n ** module id = 551\n ** module chunks = 3\n **/","module.exports = \"<button class=\\\"settings-button\\\" md-fab (click)=\\\"sidenav.toggle()\\\">\\n  <md-icon class=\\\"md-24\\\">settings</md-icon>\\n</button>\\n<md-sidenav-layout class=\\\"sidenav-layout\\\">\\n  <md-sidenav #sidenav mode=\\\"side\\\">\\n    <div class=\\\"settings-container\\\">\\n      <div class=\\\"config-section\\\">\\n        <h3>Black:</h3>\\n        <form>\\n          <div class=\\\"form-row\\\">\\n            <md-radio-group [(ngModel)]=\\\"black.rawtype\\\" (change)=\\\"onPlayerTypeChange($event, black)\\\">\\n              <md-radio-button value=\\\"HUMAN\\\">Human</md-radio-button>\\n              <md-radio-button value=\\\"AI\\\">Computer</md-radio-button>\\n            </md-radio-group>\\n          </div>\\n          <div class=\\\"form-row\\\">\\n            <label>AI Level:</label>\\n            <select (change)=\\\"onAILevelChange($event, black)\\\">\\n              <option *ngFor=\\\"let i of aiLevels\\\" [attr.value]=\\\"i\\\"\\n                      [attr.selected]=\\\"black.aiIndex === i\\\">{{i}}</option>\\n            </select>\\n          </div>\\n        </form>\\n      </div>\\n      <div class=\\\"config-section\\\">\\n        <h3>White:</h3>\\n        <form>\\n          <div class=\\\"form-row\\\">\\n            <md-radio-group [(ngModel)]=\\\"white.rawtype\\\" (change)=\\\"onPlayerTypeChange($event, white)\\\">\\n              <md-radio-button value=\\\"HUMAN\\\">Human</md-radio-button>\\n              <md-radio-button value=\\\"AI\\\">Computer</md-radio-button>\\n            </md-radio-group>\\n          </div>\\n          <div class=\\\"form-row\\\">\\n            <label>AI Level:</label>\\n            <select (change)=\\\"onAILevelChange($event, white)\\\">\\n              <option *ngFor=\\\"let i of aiLevels\\\" [attr.value]=\\\"i\\\"\\n                      [attr.selected]=\\\"white.aiIndex === i\\\">{{i}}</option>\\n            </select>\\n          </div>\\n        </form>\\n      </div>\\n      <div class=\\\"config-section\\\">\\n        <button md-button color=\\\"primary\\\" (click)=\\\"onNewGame()\\\">New Game</button>\\n        <button md-button color=\\\"accent\\\" (click)=\\\"onStop()\\\" [disabled]=\\\"!board.ctrl.aiProcessing\\\">Stop</button>\\n      </div>\\n    </div>\\n  </md-sidenav>\\n  <md-card class=\\\"board-container\\\">\\n    <br>\\n    <chess-board class=\\\"svg-chess-board\\\" #board></chess-board>\\n    <div class=\\\"game-toolbar\\\">\\n      <button md-mini-fab (click)=\\\"ctrl.undo()\\\" [disabled]=\\\"board.ctrl.aiProcessing || !isInit\\\">\\n        <md-icon class=\\\"md-24\\\">undo</md-icon>\\n      </button>\\n      <button md-mini-fab (click)=\\\"hint()\\\" [disabled]=\\\"board.ctrl.aiProcessing || !isInit\\\" *ngIf=\\\"board.ctrl.aiSupported\\\">\\n        <md-icon class=\\\"md-24\\\">remove_red_eye</md-icon>\\n      </button>\\n    </div>\\n  </md-card>\\n  <div>\\n    <p style=\\\"text-align: center; margin-top: 0\\\" *ngIf=\\\"!workerSupported\\\">Your broswer does not support web workers, expect UI lags while computer thinks</p>\\n  </div>\\n</md-sidenav-layout>\\n\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/game/game.html\n ** module id = 552\n ** module chunks = 3\n **/","export * from './game.component';\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/game/index.ts\n **/","import { Component, ViewChild, AfterViewInit } from '@angular/core';\n\nimport { ChessBoard, ChessBoardController, PieceColor, PlayerType } from 'ng2-chess';\nimport { DOM_SVG_KIT_DIRECTIVES } from 'ng2-chess/plugins/ui/dom-svg-board';\nimport { CHESSJS_CHESS_GAME_PROVIDERS } from 'ng2-chess/plugins/game/chessjs';\n\n@Component({\n  selector: 'home',\n  providers: [ ...CHESSJS_CHESS_GAME_PROVIDERS ],\n  directives: [ ...DOM_SVG_KIT_DIRECTIVES ],\n  pipes: [ ],\n  styles: [ require('./home.css') ],\n  template: require('./home.html')\n})\nexport class Home implements AfterViewInit {\n  \n  @ViewChild('board') private board: ChessBoard;\n\n  constructor() {}\n\n\n  ngAfterViewInit() {\n    this.board.ctrl\n      .init()\n      .then( () => {\n        this.board.ctrl\n          .setPlayer(PieceColor.BLACK, PlayerType.HUMAN)\n          .setPlayer(PieceColor.WHITE, PlayerType.HUMAN)\n          .newGame();\n      });\n  }\n  \n \n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/home/home.component.ts\n **/","module.exports = \".home {\\n  padding-left: 24px;\\n  padding-right: 24px;\\n  text-align: center;\\n  color: #009688;\\n}\\n\\n.home h1 {\\n  color: #9c27b0;\\n}\\n.home p > a {\\n  font-size: 1.15em;\\n}\\n.board-container {\\n  padding-top: 25px;\\n  padding-left: 25%;\\n  width: 50%;\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/home/home.css\n ** module id = 553\n ** module chunks = 3\n **/","module.exports = \"<div class=\\\"home\\\">\\n  <h1>Angular 2 Chess</h1>\\n  <p>A plugin oriented chess module built with Angular 2.</p>\\n  <p>To play, click of the \\\"Game\\\" menu on the top-right corner.</p>\\n  <p>For more infomation please visit the <a href=\\\"https://github.com/shlomiassaf/ng2-chess\\\" target=\\\"_blank\\\">GitHub page</a></p>\\n  <div class=\\\"board-container\\\">\\n    <chess-board class=\\\"svg-chess-board\\\" #board></chess-board>\\n  </div>\\n  <p style=\\\"color: #1fad83\\\">Angular 2 Chess is in early stages, currently alpha.</p>\\n</div>\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/home/home.html\n ** module id = 554\n ** module chunks = 3\n **/","export * from './home.component';\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/home/index.ts\n **/","// App\nexport * from './app.component';\nexport * from './app.service';\n\nimport { AppState } from './app.service';\n\n// Application wide providers\nexport const APP_PROVIDERS = [\n  AppState\n];\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/index.ts\n **/","import { Pipe, PipeTransform } from '@angular/core';\n\nimport { User } from './domain';\n\n@Pipe({\n  name: 'currentUser'\n})\nexport class CurrentUserFilter implements PipeTransform {\n  transform(value: User[], user$key: string): any {\n    return value && user$key ? value.filter( u => u.$key !== user$key) : value;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/currentUserFilter.pipe.ts\n **/","import { LoginFirebase } from './login';\nimport { FBUsers } from './users';\nimport { FBMatches } from \"./match\";\nimport { FBUserBusFactory } from \"./user_bus\";\n\nexport * from './login';\nexport * from './users';\nexport * from './match';\nexport * from './user_bus';\n\nexport const FIREBASE_DOMAIN_PROVIDERS = [\n  LoginFirebase,\n  FBUsers,\n  FBMatches,\n  FBUserBusFactory\n];\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/index.ts\n **/","import { Injectable, ViewChild, AfterViewInit, OnDestroy } from '@angular/core';\nimport { AngularFire, FirebaseListObservable, AuthProviders, AuthMethods } from 'angularfire2';\nimport { Subject } from 'rxjs/Subject';\nimport { Subscription } from 'rxjs/Subscription';\n\nexport class PromiseCompleter<R> {\n  promise: Promise<R>;\n  resolve: (value?: R | PromiseLike<R>) => void;\n  reject: (error?: any, stackTrace?: string) => void;\n\n  constructor() {\n    this.promise = new Promise((res, rej) => {\n      this.resolve = res;\n      this.reject = rej;\n    });\n  }\n}\n\n@Injectable()\nexport class LoginFirebase {\n\n  constructor(private af: AngularFire) {\n\n  }\n\n  logout() {\n    this.af.auth.logout();\n  }\n  \n  facebook() {\n    this.af.auth.login({\n      provider: AuthProviders.Facebook,\n      method: AuthMethods.Popup\n    });\n  }\n\n  twitter() {\n    this.af.auth.login({\n      provider: AuthProviders.Twitter,\n      method: AuthMethods.Redirect\n    });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/login/index.ts\n **/","import { FirebaseListObservable, FirebaseObjectObservable } from 'angularfire2';\nimport { Subscription } from 'rxjs/Subscription';\n\nimport { PieceColor } from 'ng2-chess';\n\nimport { FBUser, MatchRefState } from '../users';\nimport { Match } from './Match';\nimport { FBMatches } from './FBMatches';\n\nexport abstract class FBLiveMatch {\n  public match$: FirebaseObjectObservable<Match>;\n  public blackMoves$: FirebaseListObservable<string[]>;\n  public whiteMoves$: FirebaseListObservable<string[]>;\n\n  /**\n   * This piece color of the user paried with this live match instance.\n   */\n  public pieceColor: PieceColor;\n\n  get mySide(): 'black' | 'white' {\n    return this.myMoves$ === this.blackMoves$ ? 'black' : 'white';\n  }\n\n  protected match: Match;\n  protected myMoves$: FirebaseListObservable<string[]>;\n  protected opponent$key: string;\n\n  protected moves = { w: [], b: [] };\n  protected rxWaste: Array<Subscription> = [];\n\n  constructor(private matchSvc: FBMatches, public match$key: string, private user: FBUser) {\n    this.match$ = matchSvc.getMatch$(match$key);\n    this.blackMoves$ = matchSvc.getMatchMoves$(match$key, 'black');\n    this.whiteMoves$ = matchSvc.getMatchMoves$(match$key, 'white');\n\n    this.rxWaste.push( this.blackMoves$.subscribe(m => this.moves.b = m) );\n    this.rxWaste.push( this.whiteMoves$.subscribe(m => this.moves.w = m) );\n  }\n  \n  movesValid(): boolean {\n    let l = this.moves.w.length - this.moves.b.length;\n    return l === 0 || l === 1;\n  }\n\n  turn(): PieceColor {\n    return this.moves.w.length > this.moves.b.length ? PieceColor.BLACK : PieceColor.WHITE;\n  }\n\n  myTurn(): boolean {\n    switch (this.turn()) {\n      case PieceColor.WHITE:\n        return this.match.white === this.user.user$key;\n      case PieceColor.BLACK:\n        return this.match.black === this.user.user$key;\n    }\n  }\n\n  setState(state: MatchRefState): Promise<void> {\n    return this.matchSvc.getMatchMetaState$(this.match$key, this.mySide).set(state);\n  }\n\n  setMove(move: string): Promise<void> {\n    if (this.myTurn()) {\n      // TODO: Ping/Pong - get approval from remote?.\n      return this.user.sendMsg(this.opponent$key, this.user.msgFactory.move(this.match$key, move))\n        .then( () => this.myMoves$.push(move) );\n    } else {\n      return Promise.reject(new Error('Not your turn.'));\n    }\n  }\n\n  destroy(): void {\n    this.unsubscribe();\n  }\n\n  /**\n   * clear all registered subscriptions\n   */\n  private unsubscribe(): void {\n    while (this.rxWaste.length > 0) {\n      this.rxWaste.pop().unsubscribe();\n    }\n  }\n\n  static load(matchSvc: FBMatches, matchId: string, user: FBUser): Promise<FBLiveMatch> {\n    const liveMatch: FBLiveMatch = new FBLiveMatch_(matchSvc, matchId, user);\n    return liveMatch.match$.take(1).toPromise().then( m => {\n      liveMatch.match = m;\n      liveMatch.myMoves$ = m.black === user.user$key ? liveMatch.blackMoves$ : liveMatch.whiteMoves$;\n      liveMatch.opponent$key = m.black === user.user$key ? m.white: m.black;\n\n      let pc: PieceColor;\n      if (user.user$key === m.black) {\n        pc = PieceColor.BLACK;\n      } else if (user.user$key === m.white) {\n        pc = PieceColor.WHITE;\n      } else {\n        return <any>Promise.reject('Player is not assigned to black/white on this match.')\n      }\n\n      Object.defineProperty(liveMatch, 'pieceColor', { value: pc });\n\n      return liveMatch;\n    });\n  }\n}\n\nclass FBLiveMatch_ extends FBLiveMatch {}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/match/FBLiveMatch.ts\n **/","import { Injectable } from '@angular/core';\nimport { AngularFire, FirebaseListObservable, FirebaseObjectObservable } from 'angularfire2';\n\nimport { FBUser, MatchRefState } from '../users';\nimport { Match, MatchMeta } from './Match';\nimport { FBLiveMatch } from './FBLiveMatch';\nimport { MatchRef } from \"../users/User\";\n\nclass PromiseCompleter<R> {\n  promise: Promise<R>;\n  resolve: (value?: R | PromiseLike<R>) => void;\n  reject: (error?: any, stackTrace?: string) => void;\n\n  constructor() {\n    this.promise = new Promise((res, rej) => {\n      this.resolve = res;\n      this.reject = rej;\n    });\n  }\n}\n\n@Injectable()\nexport class FBMatches {\n  constructor(private af: AngularFire) {}\n\n  /**\n   * Creates a match and returns a promise of the match id.\n   * @param matchId\n   * @param mrefSettings Settings for the game\n   * @returns {Promise<void>}\n     */\n  createMatch(mref: MatchRef): Promise<void> {\n    const match = new Match(mref.settings.white, mref.settings.black, mref.settings.type);\n    return this.af.database.object(`/matches/${mref.matchId}`).set(match);\n  }\n\n  /**\n   * Loads a match\n   * @param matchId\n   * @param user The current logged in user.\n   * @returns {FBLiveMatch}\n     */\n  loadMatch(matchId: string, user: FBUser): Promise<FBLiveMatch> {\n    return FBLiveMatch.load(this, matchId, user);\n  };\n\n  getMatch$(match$key: string): FirebaseObjectObservable<Match> {\n    return this.af.database.object(`/matches/${match$key}`);\n  }\n\n  getMatchMoves$(match$key: string, side: 'black' | 'white'): FirebaseListObservable<string[]> {\n    return this.af.database.list(`/matches/${match$key}/${side}Meta/moves`);\n  }\n\n  getMatchMeta$(match$key: string, side: 'black' | 'white'): FirebaseObjectObservable<MatchMeta> {\n    return this.af.database.object(`/matches/${match$key}/${side}Meta`);\n  }\n\n  getMatchMetaState$(match$key: string, side: 'black' | 'white'): FirebaseObjectObservable<MatchRefState> {\n    return this.af.database.object(`/matches/${match$key}/${side}Meta/state`);\n  }\n\n}\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/match/FBMatches.ts\n **/","import { MatchRefState } from '../users';\n\nexport enum MATCH_TYPE {\n  SuddenDeath\n}\n\nexport interface MatchMeta {\n  state: MatchRefState;\n  moves: string[];\n}\n\nexport class Match {\n  constructor(white: string, black: string, type: MATCH_TYPE = MATCH_TYPE.SuddenDeath) {\n    this.black = black;\n    this.white = white;\n    this.type = type;\n\n    this.blackMeta = {\n      state: MatchRefState.Ready,\n      moves: []\n    };\n\n    this.whiteMeta = {\n      state: MatchRefState.Ready,\n      moves: []\n    };\n  }\n\n  /**\n   * uid of user play with black pieces.\n   */\n  black: string;\n\n  /**\n   * uid of user play with with pieces.\n   */\n  white: string;\n\n  type: MATCH_TYPE;\n\n  blackMeta: MatchMeta;\n  whiteMeta: MatchMeta;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/match/Match.ts\n **/","export { Match, MATCH_TYPE, MatchMeta } from './Match';\nexport { FBMatches } from './FBMatches';\nexport { FBLiveMatch } from './FBLiveMatch';\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/match/index.ts\n **/","import { MATCH_TYPE } from '../match';\nimport { MatchRef, MatchRefSettings } from '../users';\n\nexport enum BUS_MESSAGE_TYPE {\n  Invite,\n  Move,\n  OutOfSync,\n  Invalid,\n  EndGame\n}\n\nexport enum END_GAME_REQUEST_TYPE {\n  Forfit,\n  Draw\n}\n\n\nconst validators: { [type: number]: Array<(bus: BusMessage<any>) => Error> } = <any>{};\nexport function validate(bus: BusMessage<any>): Error {\n  if (typeof BUS_MESSAGE_TYPE[bus.type] === 'undefined') {\n    return new Error(`Unknown MESSAGE_BUS_TYPE ${bus.type}`);\n  }\n\n  const typeValidators = validators[bus.type];\n  if (typeValidators) {\n    let i = typeValidators.length, err: Error;\n\n    while (i--) {\n      if (err = typeValidators[i](bus)) {\n        return err;\n      }\n    }\n  }\n}\nexport function register(type: BUS_MESSAGE_TYPE , validator: (bus: BusMessage<any>) => Error): void {\n  if (typeof validator !== 'function') {\n    throw new Error('Validator must be a function.');\n  } else if (!Array.isArray(validators[type])) {\n    validators[type] = [];\n  }\n\n  validators[type].push(validator);\n}\n\nexport class BusMessage<T> {\n  public $key: string;\n  public type: BUS_MESSAGE_TYPE;\n  public sender: string;\n  public timestamp: number;\n\n  public data: T;\n\n  constructor(type: BUS_MESSAGE_TYPE, sender: string, data?: T) {\n    this.type = type;\n    this.sender = sender;\n    this.timestamp = Date.now();\n    if (data !== undefined) {\n      this.data = data;\n    }\n  }\n}\n\nexport interface InviteMessageData {\n  token: string;\n\n  settings?: MatchRefSettings;\n\n  /**\n   * True to accept, false to decline.\n   */\n  response?: boolean;\n  reason?: string;\n}\n\nexport interface MoveMessageData {\n  matchId: string;\n  move: string;\n}\n\nexport interface OutOfSyncMessageData {\n  matchId: string;\n  reason: string;\n}\n\nexport interface InvalidMessageMessageData {\n  orgMessage: BusMessage<any>;\n  reason?: string;\n}\n\nexport class MessageFactory {\n  constructor(private senderId: string) {}\n\n  invite(mref: MatchRef): BusMessage<InviteMessageData> {\n    return this.create(BUS_MESSAGE_TYPE.Invite, {\n      token: mref.matchId,\n      settings: mref.settings\n    });\n  }\n\n  inviteResponse(mref: MatchRef, response: boolean, reason: string = null): BusMessage<InviteMessageData> {\n    return this.create(BUS_MESSAGE_TYPE.Invite, { token: mref.matchId, response, reason });\n  }\n\n  move(matchId: string, move: string): BusMessage<MoveMessageData> {\n    return this.create(BUS_MESSAGE_TYPE.Move, { matchId, move });\n  }\n\n  outOfSync(matchId: string, reason): BusMessage<OutOfSyncMessageData> {\n    return this.create(BUS_MESSAGE_TYPE.OutOfSync, { matchId, reason });\n  }\n\n  invalid(orgMessage: BusMessage<any>, reason?: string): BusMessage<InvalidMessageMessageData> {\n    return this.create(BUS_MESSAGE_TYPE.Invalid, { orgMessage, reason });\n  }\n\n  endGame(endGameRequest: END_GAME_REQUEST_TYPE): BusMessage<END_GAME_REQUEST_TYPE> {\n    return this.create(BUS_MESSAGE_TYPE.EndGame, endGameRequest);\n  }\n\n  private create<T>(type: BUS_MESSAGE_TYPE, data?: T) : BusMessage<T> {\n    return new BusMessage<T>(type, this.senderId, data);\n  }\n\n  static isInvite(msg: BusMessage<any>): msg is BusMessage<InviteMessageData> {\n    return msg && msg.type === BUS_MESSAGE_TYPE.Invite;\n  }\n\n  static isMove(msg: BusMessage<any>): msg is BusMessage<MoveMessageData> {\n    return msg && msg.type === BUS_MESSAGE_TYPE.Move;\n  }\n\n  static isOutOfSync(msg: BusMessage<any>): msg is BusMessage<OutOfSyncMessageData> {\n    return msg && msg.type === BUS_MESSAGE_TYPE.OutOfSync;\n  }\n\n  static isInvalid(msg: BusMessage<any>): msg is BusMessage<InvalidMessageMessageData> {\n    return msg && msg.type === BUS_MESSAGE_TYPE.Invalid;\n  }\n}\n\n\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/user_bus/BusMessage.ts\n **/","import { ReplaySubject } from 'rxjs/ReplaySubject';\nimport { Observable } from \"rxjs/Observable\";\nimport { Subscription } from \"rxjs/Subscription\";\n\nimport { BusMessage } from './BusMessage';\nimport { url, FBUserBusFactory } from './FBUserBusFactory.service';\n\nexport class FBUserBus {\n  incoming$: Observable<BusMessage<any>>;\n\n  private _subject: ReplaySubject<BusMessage<any>>;\n  private rxWaste: Array<Subscription> = [];\n\n  constructor(private bus: FBUserBusFactory, private user$key: string) {\n    this._subject  = new ReplaySubject<BusMessage<any>>(1);\n    this.incoming$ = this._subject.asObservable();\n\n    bus.getUserBus$(user$key).remove()\n      .then( () => {\n        this.rxWaste.push(\n          bus.getUserBus$(user$key).subscribe( msg => this.onIncomingMessage(msg) )\n        );\n      });\n  }\n\n  send(id: string, message: BusMessage<any>): Promise<void> {\n    return this.bus.send(id, message);\n  }\n\n  destroy(): void {\n    this.unsubscribe();\n  }\n\n  /**\n   * clear all registered subscriptions\n   */\n  private unsubscribe(): void {\n    while (this.rxWaste.length > 0) {\n      this.rxWaste.pop().unsubscribe();\n    }\n  }\n\n  private onIncomingMessage(messages: BusMessage<any>[]): void {\n    if (messages.length === 0) return;\n    for (let m of messages) {\n      this.bus.removeBusMessage(this.user$key, m.$key);\n      this._subject.next(m);\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/user_bus/FBUserBus.ts\n **/","import { v1 as UUID } from 'node-uuid';\n\nimport { Injectable } from '@angular/core';\nimport { AngularFire, FirebaseListObservable } from 'angularfire2';\n\nimport { BusMessage, validate } from './BusMessage';\nimport { FBUserBus } from './FBUserBus';\n\nexport const url = {\n  bus: (id: string) => `/user_bus/${id}`,\n  busMsg: (id: string) => `${url.bus(id)}/${UUID()}`,\n};\n\nclass PromiseCompleter<R> {\n  promise: Promise<R>;\n  resolve: (value?: R | PromiseLike<R>) => void;\n  reject: (error?: any, stackTrace?: string) => void;\n\n  constructor() {\n    this.promise = new Promise((res, rej) => {\n      this.resolve = res;\n      this.reject = rej;\n    });\n  }\n}\n\n\n@Injectable()\nexport class FBUserBusFactory {\n  constructor(private af: AngularFire) {}\n\n  send(id: string, message: BusMessage<any>): Promise<void> {\n    let error = validate(message);\n    if (error) {\n      return Promise.reject(error);\n    } else {\n      return this.af.database.object(url.busMsg(id)).set(message);\n    }\n  }\n\n  create(user$key: string): FBUserBus {\n    return new FBUserBus(this, user$key);\n  }\n\n  getUserBus$(user$key: string): FirebaseListObservable<BusMessage<any>[]> {\n    return this.af.database.list(url.bus(user$key));\n  }\n\n  removeBusMessage(user$key: string, msg$key: string): Promise<void> {\n    return this.af.database.object(`${url.bus(user$key)}/${msg$key}`).remove();\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/user_bus/FBUserBusFactory.service.ts\n **/","export * from './BusMessage';\nexport { FBUserBusFactory } from './FBUserBusFactory.service'\nexport { FBUserBus } from './FBUserBus'\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/user_bus/index.ts\n **/","import { v1 as UUID } from 'node-uuid';\nimport { FirebaseObjectObservable } from 'angularfire2';\nimport { Observable } from \"rxjs/Observable\";\nimport { Subscription } from 'rxjs/Subscription';\n\nimport { User, MatchRef, MatchRefState, MatchRefRole } from './index';\nimport { MessageFactory, BusMessage, FBUserBus } from '../user_bus';\nimport { MATCH_TYPE } from '../match';\nimport { FBUsers } from './FBUsers.service';\n\nexport class FBUser {\n  public user: User;\n  public user$: FirebaseObjectObservable<User>;\n  public matchRefs$: Observable<MatchRef[]>;\n\n  public msgFactory: MessageFactory;\n  private rxWaste: Array<Subscription> = [];\n\n  constructor(public user$key: string, private users: FBUsers, public bus: FBUserBus) {\n    this.user$ = users.getUser$(user$key);\n\n    this.rxWaste.push( this.user$.subscribe( user => this.user = user) );\n\n    this.matchRefs$ = users.getMatchRefs$(user$key)\n      .map (refs => {\n        refs.forEach( m => {\n          if (!m.user_) {\n            users.getUser(m.user).then( u => m.user_ = u);\n          }\n        });\n        return refs;\n      });\n\n    this.msgFactory = new MessageFactory(user$key);\n  }\n\n  update(): Promise<void> {\n    return this.users.update(this.user$key, this.user);\n  }\n\n  setPlaying(playing: boolean): Promise<void> {\n    return this.users.update( this.user$key, <any>{ playing } );\n  }\n\n  /**\n   * Send a bug message to a user.\n   * @param to the ID of the user ($key)\n   * @param msg The message\n   * @returns {Promise<void>}\n   */\n  sendMsg(to: string, msg: BusMessage<any>): Promise<void> {\n    return this.bus.send(to, msg);\n  }\n\n\n  keepAlive() {\n    this.users.getUserResource$(this.user$key, 'lastSeen').set(new Date().getTime())\n  }\n\n  /**\n   * Invite a user ($key) to an online match.\n   * The user is the invitee, the inviter is the current user.\n   * @param invitee\n   * @returns {Promise<void>}\n   **/\n  invite(invitee: User): Promise<void> {\n    if (!invitee.$key) {\n      return Promise.reject(new Error('Invalid user $key.'))\n    } else {\n      // TODO: Allow user to choose sides. (currently hard coded - inviter === white)\n      return this.createMatchRef(MatchRefRole.Inviter, this.user$key, invitee.$key)\n        .then( mref => this.sendMsg(invitee.$key, this.msgFactory.invite(mref)) );\n    }\n  }\n\n  responedToInvite(mref: MatchRef, response: boolean, reason?: string): Promise<void> {\n    return this.sendMsg(mref.user, this.msgFactory.inviteResponse(mref, response, reason))\n  }\n\n  acceptInvitation(mref: MatchRef): Promise<void> {\n    return this.updateMatchRefState(mref.matchId, MatchRefState.Ready)\n      .then( () => {})\n      .then( () => this.sendMsg(mref.user, this.msgFactory.inviteResponse(mref, true)) )\n      .catch( () => this.withdrawInvitation(mref, true) )\n  }\n\n  /**\n   * Remove an invite the user has received.\n   */\n  withdrawInvitation(mref: MatchRef, notify: boolean): Promise<void> {\n    return Promise.all([\n      notify ? this.sendMsg(mref.user, this.msgFactory.inviteResponse(mref, false)) : Promise.resolve(),\n      this.users.getMatchRef$(this.user$key, mref.matchId).remove()\n    ]) as any;\n  }\n\n  /**\n   * Creates a new `MatchRef` and returns a promise of the new match id ($key)\n   * @param role\n   * @param white the firebase user $key of the player who plays white\n   * @param black the firebase user $key of the player who plays black\n   * @param uuid optional matchId, if not supplied created automatically.\n   * @returns {Promise<string>}\n   */\n  createMatchRef(role: MatchRefRole, white: string, black: string, uuid?: string): Promise<MatchRef> {\n    const matchId = uuid ? uuid : UUID(),\n          mref: MatchRef = {\n            timestamp: Date.now(),\n            role,\n            user: white === this.user$key ? black : white,\n            state: MatchRefState.Invite,\n            matchId,\n            settings: { black, white, type: MATCH_TYPE.SuddenDeath }\n          };\n\n    return this.users.getMatchRef$(this.user$key, matchId).set(mref).then( () => mref );\n  }\n\n  updateMatchRefState(matchId: string, state: MatchRefState): Promise<void> {\n    return this.users.getMatchRefState$(this.user$key, matchId).set(state);\n  }\n\n  getMatchRef(matchId: string): Promise<MatchRef> {\n    return this.users.getMatchRef(this.user$key, matchId);\n  }\n\n  destroy(): void {\n    this.unsubscribe();\n  }\n\n  /**\n   * clear all registered subscriptions\n   */\n  private unsubscribe(): void {\n    while (this.rxWaste.length > 0) {\n      this.rxWaste.pop().unsubscribe();\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/users/FBUser.ts\n **/","import { Injectable } from '@angular/core';\nimport { AngularFire, FirebaseListObservable, FirebaseObjectObservable } from 'angularfire2';\nimport { Subject } from 'rxjs/Subject';\nimport { Subscription } from 'rxjs/Subscription';\nimport { Observable } from \"rxjs/Observable\";\nimport 'rxjs/operator/toPromise';\n\nimport { User, MatchRef, MatchRefState } from './User';\nimport { FBUserBusFactory, BusMessage } from '../user_bus';\nimport { FBUser } from './FBUser';\n\nconst url = {\n  users: () => `/users`,\n  user: (id: string) => `${url.users()}/${id}`,\n  match_refs: (id: string) => `${url.user(id)}/match_refs`\n};\n\n@Injectable()\nexport class FBUsers {\n  public users$: FirebaseListObservable<User[]>;\n  public currentUser$: Observable<FBUser>;\n\n  /**\n   * When false means authentication is still running.\n   * True doesn't means a successful authentication, just means it's done.\n   */\n  public authDone: boolean;\n\n  private currentUserEmitter: Subject<FBUser>;\n\n  private rxWaste: Array<Subscription> = [];\n\n  constructor(private af: AngularFire, private bus: FBUserBusFactory) {\n    this.currentUserEmitter = new Subject<FBUser>();\n    this.currentUser$ = this.currentUserEmitter.asObservable();\n    this.users$ = <any>af.database.list(url.users());\n\n    let subscription = af.auth.subscribe( auth => {\n      if (auth && auth.uid) {\n        this.getUser(auth.uid)\n          .then( user => {\n            if (user) {\n              return user;\n            } else {\n              return this.getUser$(auth.uid).set(User.create(auth))\n                .then( () => this.getUser(auth.uid) );\n            }\n          })\n          .then( user => {\n            this.currentUserEmitter.next(new FBUser(user.$key, this, bus.create(user.$key)));\n            this.authDone = true;\n          });\n      } else {\n        this.currentUserEmitter.next(null);\n        this.users$ = undefined;\n        this.unsubscribe();\n        this.authDone = true;\n      }\n    });\n    this.rxWaste.push(subscription);\n  }\n\n  getUser$($key: string): FirebaseObjectObservable<User> {\n    return this.af.database.object(url.user($key));\n  }\n\n  /**\n   * Returns a specific resource in the user object\n   * i.e: /users/1234567/resource\n   * @param $key\n   * @param resource\n   * @returns {FirebaseObjectObservable<any>}\n     */\n  getUserResource$($key: string, resource: string): FirebaseObjectObservable<User> {\n    return this.af.database.object(url.user($key) + `/${resource}`);\n  }\n\n  /**\n   * A User fetch operation, only 1 call not a stream.\n   * @param $key\n   * @param set$Key If true will set the $key property on the user, since this is a direct object fetch\n   *                firebase will not plant the $key as it does with lists.\n   * @returns {Promise<User>}\n     */\n  getUser($key: string, set$Key: boolean = true): Promise<User> {\n    return this.af.database.object(url.user($key))\n      .take(1)\n      .toPromise()\n      .then( user => { // we need the $key\n        if (user && set$Key) user.$key = $key;\n        return user;\n      });\n  }\n\n\n  getMatchRefs$(user$key: string): FirebaseListObservable<MatchRef[]> {\n    return this.af.database.list(url.match_refs(user$key));\n  }\n\n  getMatchRef$(user$key: string, matchRef$key: string): FirebaseObjectObservable<MatchRef> {\n    return this.af.database.object(url.match_refs(user$key) + `/${matchRef$key}`);\n  }\n\n  getMatchRefState$(user$key: string, matchRef$key: string): FirebaseObjectObservable<MatchRefState> {\n    return this.af.database.object(url.match_refs(user$key) + `/${matchRef$key}/state`);\n  }\n\n  /**\n   * A User fetch operation, only 1 call not a stream.\n   * @param $key\n   * @param set$Key If true will set the $key property on the user, since this is a direct object fetch\n   *                firebase will not plant the $key as it does with lists.\n   * @returns {Promise<User>}\n   */\n  getMatchRef(user$key: string, matchRef$key: string): Promise<MatchRef> {\n    return this.getMatchRef$(user$key, matchRef$key)\n      .take(1)\n      .toPromise();\n  }\n\n  /**\n   * Send a bug message to a user.\n   * @param from the ID of the user ($key)\n   * @param to the ID of the user ($key)\n   * @param msg The message\n   * @returns {Promise<void>}\n   */\n  sendMsg(to: string, msg: BusMessage<any>): Promise<void> {\n    return this.bus.send(to, msg);\n  }\n\n\n  /**\n   * Updates a user object.\n   * @param user\n   * @returns {Promise<void>}\n   */\n  update(user$key: string, user: User): Promise<void> {\n    const VALID_FB_KEY = /[\\[\\].#$\\/\\u0000-\\u001F\\u007F]/;\n\n    const obj: any = {};\n    for (let k in user) {\n      if (user.hasOwnProperty(k) && ! VALID_FB_KEY.exec(k)) {\n        obj[k] = user[k];\n      }\n    }\n    return this.users$.update(user$key, obj);\n  }\n\n  destroy(): void {\n    this.unsubscribe();\n  }\n\n  /**\n   * clear all registered subscriptions\n   */\n  private unsubscribe(): void {\n    while (this.rxWaste.length > 0) {\n      this.rxWaste.pop().unsubscribe();\n    }\n  }\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/users/FBUsers.service.ts\n **/","import { FirebaseAuthState, AuthProviders } from 'angularfire2';\nimport { MATCH_TYPE } from '../match';\n\ninterface AuthInfo {\n  displayName: string;\n  profileImageURL: string;\n}\n\ninterface FirebaseRecord {\n  $key: string;\n}\n\nexport enum MatchRefRole {\n  Inviter,\n  Invitee\n}\n\n\nexport enum MatchRefState {\n  // hard coded values, don't change used in DB.\n  Invite = 0,\n  Ready = 1,\n  InPlay = 2,\n  Done = 3,\n  Canceled = 4\n}\n\nexport interface MatchRef {\n  role: MatchRefRole,\n  timestamp: number;\n  user: string;\n  matchId: string;\n  state: MatchRefState;\n  settings: MatchRefSettings\n}\n\nexport interface MatchRefSettings {\n  black: string;\n  white: string;\n  type: MATCH_TYPE;\n}\n\nexport class User implements FirebaseRecord {\n  $key: string;\n\n  displayName: string;\n  pic: string;\n  provider: string;\n  available: boolean;\n  playing: boolean;\n  lastSeen: number;\n  \n  match_refs: MatchRef;\n\n\n  static create(auth: FirebaseAuthState): User {\n    const user = new User();\n    user.provider = AuthProviders[auth.provider];\n\n    let info: AuthInfo;\n    switch (auth.provider) {\n      case AuthProviders.Twitter:\n        info = auth.twitter;\n        break;\n      case AuthProviders.Facebook:\n        info = auth.facebook;\n        break;\n    }\n\n    if (info) {\n      user.displayName = info.displayName;\n      user.pic = info.profileImageURL;\n    }\n\n    return user;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/users/User.ts\n **/","export { User, MatchRef, MatchRefRole, MatchRefState, MatchRefSettings } from './User';\nexport { FBUser } from './FBUser';\nexport { FBUsers } from './FBUsers.service';\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/domain/users/index.ts\n **/","export * from './online.component';\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/index.ts\n **/","import { Component, ViewChild, AfterViewInit, OnDestroy } from '@angular/core';\nimport { MdSidenav } from '@angular2-material/sidenav/sidenav';\nimport { MdCheckboxChange } from '@angular2-material/checkbox/checkbox';\n\nimport { Subscription } from 'rxjs/Subscription';\n\nimport { ChessBoard, ChessBoardController, PieceColor, PlayerType, GAME_STATE, util } from 'ng2-chess';\nimport { DOM_SVG_KIT_DIRECTIVES } from '../../packages/ng2-chess/plugins/ui/dom-svg-board';\nimport { CHESSJS_CHESS_GAME_PROVIDERS } from '../../packages/ng2-chess/plugins/game/chessjs';\n\nimport { User, FBUsers, LoginFirebase, BusMessage, MessageFactory, MatchRef, MatchRefRole, MatchRefState, FBUser, FBMatches, FBLiveMatch, MoveMessageData, InviteMessageData } from './domain';\n\nimport { CurrentUserFilter } from './currentUserFilter.pipe';\nimport { OnlineFilter } from './onlineFilter.pipe';\n\n@Component({\n  selector: 'online',\n  providers: [ ...CHESSJS_CHESS_GAME_PROVIDERS ],\n  directives: [ ...DOM_SVG_KIT_DIRECTIVES ],\n  pipes: [ CurrentUserFilter, OnlineFilter ],\n  styles: [ require('./online.css') ],\n  template: require('./online.html')\n})\nexport class Online implements AfterViewInit, OnDestroy {\n\n  @ViewChild('sidenav') private sidenav: MdSidenav;\n  @ViewChild('board') private board: ChessBoard;\n\n  user: FBUser;\n  selectedUser: User;\n  isInit: boolean;\n  liveMatch: FBLiveMatch;\n\n  private ctrl: ChessBoardController;\n  private rxWaste: Array<Subscription> = [];\n\n  constructor(private users: FBUsers, private login: LoginFirebase, private match: FBMatches) {\n    let subs = users.currentUser$.subscribe(user => {\n      this.user = user;\n      if (user) {\n        user.user$.first().subscribe( u => {\n          if (u.playing) {\n            user.setPlaying(false);\n          }\n\n\n          // TODO: put in an observable.\n          // in HTML remove filter, use special firebase query on the users$ list.\n          setTimeout( () => user.keepAlive(), 16);\n          // Send keep alive every 2.5 minutes\n          const clearCode = setInterval( () => {\n            user.keepAlive();\n          }, 1000 * 60 * 2.5);\n\n          this.rxWaste.push(<any>{ unsubscribe: () => clearInterval(clearCode) })\n\n\n        });\n        let subs = user.bus.incoming$.subscribe( msg => this.onBusMessage(msg) );\n        this.rxWaste.push(subs);\n      }\n    });\n    this.rxWaste.push(subs);\n  }\n\n  ngAfterViewInit() {\n    this.ctrl = this.board.ctrl;\n    this.ctrl.init()\n      .then( () => this.sidenav.toggle(true) );\n  }\n\n  ngOnDestroy() {\n    while (this.rxWaste.length > 0) {\n      this.rxWaste.pop().unsubscribe();\n    }\n    this.users.destroy();\n  }\n\n  onAvailabilityChange(event: MdCheckboxChange) {\n    this.user.user.available = event.checked;\n    this.user.update();\n  }\n\n  userStatus(user: User): string {\n    if (!user.available) {\n      return \"Not Available\";\n    } else if (user.playing) {\n      return \"Playing\";\n    } else {\n      return \"Available\";\n    }\n  }\n\n  /**\n   * return true if the current user can init a new match.\n   * the user's available property is not a factor in this check.\n   */\n  isFree(): boolean {\n    return !this.liveMatch && !this.user.user.playing;\n  }\n\n  canInvite(): boolean {\n    const su = this.selectedUser;\n    return this.isFree() && su && su.available && !su.playing;\n  }\n\n  invite() {\n    if (this.canInvite()) {\n      this.user.invite(this.selectedUser);\n    }\n  }\n\n  acceptInvite(mref: MatchRef): Promise<void> {\n    return this.user.setPlaying(true)\n      .then( () => this.match.createMatch(mref) )\n      .then( () => this.user.acceptInvitation(mref) )\n      .then( () => this.match.loadMatch(mref.matchId, this.user) )\n      .then( liveMatch => this.initGame(liveMatch) );\n  }\n\n  logout() {\n    this.selectedUser = undefined;\n    this.login.logout();\n  }\n\n  private initGame(liveMatch: FBLiveMatch): void {\n      this.liveMatch = liveMatch;\n\n      liveMatch.setState(MatchRefState.InPlay);\n\n      this.ctrl\n        .setPlayer(PieceColor.BLACK, PlayerType.HUMAN)\n        .setPlayer(PieceColor.WHITE, PlayerType.HUMAN)\n        .newGame();\n\n      this.ctrl.onMoved$.subscribe(move => {\n        let p: Promise<void>;\n\n        // if not our turn, it means that this move is for our turn\n        if (liveMatch.pieceColor !== this.ctrl.turn) {\n          this.board.blockUi(true);\n          p = liveMatch.setMove(move.toLongAlgebraic());\n        }\n\n        if(this.ctrl.state !== GAME_STATE.ACTIVE && this.ctrl.state !== GAME_STATE.CHECK) {\n          if (this.liveMatch) {\n            p = p || Promise.resolve();\n            p.then( () => this.endGameRoutine(MatchRefState.Done) );\n          }\n        }\n      });\n\n      this.board.blockUi(!liveMatch.myTurn());\n\n      this.isInit = true;\n  }\n\n  private onBusMessage(msg: BusMessage<any>): any {\n    //TODO: Handle this else where, to big for here.\n    let p;\n\n    //TODO: rejection is useless here, send message back to sender.\n    if (MessageFactory.isInvite(msg)) {\n      this.tryHandleInviteResponse(msg);\n    } else if (MessageFactory.isMove(msg)) {\n      if (!this.isMatchOf(msg.data.matchId)) {\n        this.user.sendMsg(msg.sender, this.user.msgFactory.invalid(msg));\n      } else {\n        this.tryMoveOpponent(msg)\n          .catch(err => {\n            this.user.sendMsg(msg.sender, this.user.msgFactory.outOfSync(msg.data.matchId, err.toString()));\n            this.endGameRoutine(MatchRefState.Canceled); //TODO: Pop up message, why game ended.\n          });\n      }\n    } else if (MessageFactory.isOutOfSync(msg)) {\n      if (this.isMatchOf(msg.data.matchId)) {\n        this.endGameRoutine(MatchRefState.Canceled); //TODO: Pop up message, why game ended.\n      }\n    }\n    return p;\n  }\n\n  /**\n   * Returns true if the current match matchId matches the matchId\n   * @param matchId\n   * @returns {boolean}\n     */\n  private isMatchOf(matchId: string): boolean {\n    return (!this.liveMatch || this.liveMatch.match$key !== matchId) ? false : true;\n  }\n\n  private tryHandleInviteResponse(msg: BusMessage<InviteMessageData>): Promise<void> {\n    const reject = (msg) => Promise.reject(new Error(msg));\n    if (!this.isFree()) {\n      return reject('User is not available.');\n    } else {\n      return this.users.getUser(msg.sender)\n        .then(user => !user && reject('Invalid sender.'))\n        .then(() => this.user.getMatchRef(msg.data.token))\n        .then(mref => {\n          if (mref) {\n            if (mref.state !== MatchRefState.Invite) {\n              return this.user.responedToInvite(mref, false, 'Invalid invitation, try again.')\n                .then(() => reject('Invite exists but in an invalid state.'))\n            } else if (msg.data.response === false) {\n              // TODO: display reason?  msg.data.reason\n              return Promise.all([\n                this.user.withdrawInvitation(mref, false),\n                this.user.responedToInvite(mref, false, 'Invalid invitation response.')\n              ]);\n            } else if (msg.data.response === true) {\n              return this.match.loadMatch(mref.matchId, this.user)\n                .then(liveMatch => {\n                  // verify the other user created the match as in invitation.\n                  if (this.user.user$key !== mref.settings[liveMatch.mySide]) {\n                    return reject('Invalid match configuration, try again.');\n                  }\n                  return this.user.setPlaying(true)\n                    .then(() => this.user.updateMatchRefState(mref.matchId, MatchRefState.Ready))\n                    .then(() => this.initGame(liveMatch));\n                });\n            } else {\n              return reject('Invite exists but message does not have a response');\n            }\n          } else {\n            return this.user.createMatchRef(MatchRefRole.Invitee, msg.data.settings.white, msg.data.settings.black, msg.data.token);\n          }\n        });\n    }\n  }\n\n  private tryMoveOpponent(msg: BusMessage<MoveMessageData>): Promise<void> {\n    let reject = (msg) => Promise.reject(new Error(msg));\n\n    if (this.liveMatch.myTurn()) {\n      return reject('Illegal move, not your turn.');\n    }\n\n\n    try {\n      const chessMove = util.move.fromLongAlgebraic(msg.data.move),\n            piece = this.ctrl.getPiece(chessMove.from),\n            block = this.ctrl.getBlock(chessMove.to);\n\n      if (!piece) {\n        return reject('Invalid move, no piece on source block.');\n      }\n\n      return this.ctrl.move(piece, block, chessMove.promotion)\n        .then(move => move.invalid && Promise.reject(new Error('Invalid move')) )\n        .then( () => this.board.blockUi(false))\n\n    } catch (err) {\n      return Promise.reject(err);\n    }\n\n  }\n\n  private endGameRoutine(state: MatchRefState) {\n    this.board.blockUi(true);\n    const r = () => {\n      this.ctrl.destroy();\n      this.liveMatch.destroy();\n      this.liveMatch = undefined;\n    };\n\n    this.user.setPlaying(false);\n\n    return this.liveMatch.setState(state)\n      .then(r)\n      .catch(r);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/online.component.ts\n **/","module.exports = \":host {\\n  height: 100%;\\n  display: flex;\\n}\\n\\n.md-sidenav-side {\\n  width: 320px;\\n}\\n\\n.settings-button {\\n  position: absolute;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  z-index: 5000;\\n}\\n\\n.sidenav-layout {\\n  flex: 1;\\n}\\n\\n.sidenav-spinner {\\n  margin: auto;\\n  margin-top: 20%;\\n}\\n\\n.settings-container {\\n  padding: 12px;\\n}\\n\\n.user-list-item {\\n  display: block;\\n  cursor: pointer;\\n}\\n.user-list-item.selected  {\\n  background-color: rgba(0, 150, 136, 0.35);\\n}\\n\\n.invite-button {\\n  width: 100%;\\n}\\n\\n.invitation-container {\\n  display: flex;\\n\\n}\\n.invitation-container img {\\n  width: 50px;\\n  height: 50px;\\n  border-radius: 50%;\\n  margin-right: 10px;\\n}\\n.invitation-actions {\\n  text-align: center;\\n}\\n.board-container {\\n  flex: 5 0px;\\n}\\n.board-container, .board-container:hover {\\n  box-shadow: none;\\n  background-color: transparent;\\n}\\n\\n.game-toolbar {\\n  display: flex;\\n  justify-content: center;\\n}\\n\\n.game-toolbar > * {\\n  margin: 5px;\\n}\\n.svg-chess-board {\\n  margin: auto;\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n@media (min-height: 400px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 200px;\\n    max-height: 200px;\\n  }\\n}\\n\\n@media (min-height: 600px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 400px;\\n    max-height: 400px;\\n  }\\n}\\n\\n@media (min-height: 700px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 500px;\\n    max-height: 500px;\\n  }\\n}\\n\\n@media (min-height: 800px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 600px;\\n    max-height: 600px;\\n  }\\n}\\n\\n@media (min-height: 900px) and (orientation: landscape) {\\n  .svg-chess-board {\\n    max-width: 700px;\\n    max-height: 700px;\\n  }\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/online/online.css\n ** module id = 555\n ** module chunks = 3\n **/","module.exports = \"<button class=\\\"settings-button\\\" md-fab (click)=\\\"sidenav.toggle()\\\">\\n  <md-icon class=\\\"md-24\\\">settings</md-icon>\\n</button>\\n<md-sidenav-layout class=\\\"sidenav-layout\\\">\\n  <md-sidenav #sidenav mode=\\\"side\\\">\\n    <md-spinner class=\\\"sidenav-spinner\\\" *ngIf=\\\"!users.authDone\\\"></md-spinner>\\n\\n    <div class=\\\"settings-container\\\" *ngIf=\\\"users.authDone\\\">\\n      <div class=\\\"logged-out\\\" *ngIf=\\\"!user\\\">\\n        <span>Sign in:</span>\\n        <button md-button (click)=\\\"login.twitter()\\\">Twitter</button>\\n        <button md-button (click)=\\\"login.facebook()\\\">Facebook</button>\\n      </div>\\n      <div class=\\\"logged-in\\\" *ngIf=\\\"user?.user\\\">\\n        <div class=\\\"my-status\\\">\\n          <md-checkbox [checked]=\\\"user.user.available\\\"\\n                       (change)=\\\"onAvailabilityChange($event)\\\"\\n                       align=\\\"end\\\">I'm Available for play</md-checkbox>\\n          <button md-mini-fab (click)=\\\"login.logout()\\\" style=\\\"float: right\\\">\\n            <md-icon class=\\\"md-24\\\">power_settings_new</md-icon>\\n          </button>\\n          <div  *ngFor=\\\"let mr of user.matchRefs$ | async\\\">\\n            <md-card *ngIf=\\\"mr.state === 0 && mr.role === 1\\\">\\n              <md-card-title>Match Pending</md-card-title>\\n              <md-card-subtitle>Waiting for action</md-card-subtitle>\\n              <md-card-content class=\\\"invitation-container\\\">\\n                <img [src]=\\\"mr.user_?.pic\\\" alt=\\\"Image of {{mr.user_?.displayName}}\\\">\\n                <p>You have a pending invitation from {{mr.user_?.displayName}}</p>\\n              </md-card-content>\\n              <md-card-actions class=\\\"invitation-actions\\\">\\n                <button md-raised-button color=\\\"primary\\\" (click)=\\\"acceptInvite(mr)\\\">ACCEPT</button>\\n                <button md-raised-button color=\\\"warn\\\" (click)=\\\"user.withdrawInvitation(mr, true)\\\">DECLINE</button>\\n              </md-card-actions>\\n            </md-card>\\n            <md-card *ngIf=\\\"mr.state === 0 && mr.role === 0\\\">\\n              <md-card-title>Match Pending</md-card-title>\\n              <md-card-subtitle>Waiting for response.</md-card-subtitle>\\n              <md-card-content class=\\\"invitation-container\\\">\\n                <img [src]=\\\"mr.user_?.pic\\\" alt=\\\"Image of {{mr.user_?.displayName}}\\\">\\n                <p>You have sent an invitation to {{mr.user_?.displayName}}</p>\\n              </md-card-content>\\n              <md-card-actions class=\\\"invitation-actions\\\">\\n                <button md-raised-button color=\\\"warn\\\" (click)=\\\"user.withdrawInvitation(mr, true)\\\">CANCEL</button>\\n              </md-card-actions>\\n            </md-card>\\n\\n          </div>\\n        </div>\\n        <div class=\\\"online-users\\\" *ngIf=\\\"user?.user$key\\\">\\n          <md-list>\\n            <h3 style=\\\"text-align: center; margin-top: 20px; border-top: 2px solid lightblue; border-bottom: 2px solid lightblue\\\">ALPHA Release</h3>\\n            <button class=\\\"invite-button\\\" md-raised-button color=\\\"accent\\\" [disabled]=\\\"!canInvite()\\\" (click)=\\\"invite()\\\">Invite to play</button>\\n            <br><br>\\n            <h3 md-subheader>Online Players</h3>\\n            <md-list-item class=\\\"user-list-item\\\"\\n                          *ngFor=\\\"let user of users.users$ | async | online | currentUser:user.user$key\\\"\\n                          *ngIf=\\\"user.available\\\"\\n                          [class.selected]=\\\"selectedUser === user\\\"\\n                          (click)=\\\"selectedUser = user\\\">\\n                <img md-list-avatar [src]=\\\"user.pic\\\" alt=\\\"Image of {{user.displayName}}\\\">\\n                <h3 md-line>{{user.displayName}}</h3>\\n                <span md-line>{{userStatus(user)}}</span>\\n            </md-list-item>\\n          </md-list>\\n        </div>\\n      </div>\\n    </div>\\n  </md-sidenav>\\n  <md-card class=\\\"board-container\\\">\\n    <br>\\n    <chess-board class=\\\"svg-chess-board\\\" #board></chess-board>\\n  </md-card>\\n  <div>\\n    <p style=\\\"text-align: center; margin-top: 0\\\">First alpha release of online support, expect missing features, glitches and bugs!</p>\\n    <p style=\\\"text-align: center; margin-top: 0\\\">Restart should always help :), posting an GH issue is apperciated!</p>\\n  </div>\\n</md-sidenav-layout>\\n\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/online/online.html\n ** module id = 556\n ** module chunks = 3\n **/","import { Pipe, PipeTransform } from '@angular/core';\n\nimport { User } from './domain';\n\n@Pipe({\n  name: 'online'\n})\nexport class OnlineFilter implements PipeTransform {\n  transform(value: User[]): any {\n    const d = new Date().getTime(),\n          gap = 1000 * 60 * 7; // 7 minutes\n    \n    return value ? value.filter( u => u.lastSeen && d > u.lastSeen && d - u.lastSeen < gap) : value;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/online/onlineFilter.pipe.ts\n **/","/*\n * Providers provided by Angular\n */\nimport { bootstrap } from '@angular/platform-browser-dynamic';\n\n/*\n* Platform and Environment\n* our providers/directives/pipes\n*/\nimport { DIRECTIVES, PIPES, PROVIDERS } from './platform/browser';\nimport { ENV_PROVIDERS } from './platform/environment';\n\n/*\n* App Component\n* our top level component that holds all of our components\n*/\nimport { App, APP_PROVIDERS } from './app';\n\n/*\n * Bootstrap our Angular app with a top level component `App` and inject\n * our Services and Providers into Angular's dependency injection\n */\nexport function main(initialHmrState?: any): Promise<any> {\n\n  return bootstrap(App, [\n    ...PROVIDERS,\n    ...ENV_PROVIDERS,\n    ...DIRECTIVES,\n    ...PIPES,\n    ...APP_PROVIDERS\n  ])\n  .catch(err => console.error(err));\n\n}\n\n\n/*\n * Vendors\n * For vendors for example jQuery, Lodash, angular2-jwt just import them anywhere in your app\n * You can also import them in vendors to ensure that they are bundled in one file\n * Also see custom-typings.d.ts as you also need to do `typings install x` where `x` is your module\n */\n\n\n/*\n * Hot Module Reload\n * experimental version by @gdi2290\n */\nif ('development' === ENV && HMR === true) {\n  // activate hot module reload\n  let ngHmr = require('angular2-hmr');\n  ngHmr.hotModuleReplacement(main, module);\n} else {\n  // bootstrap when document is ready\n  document.addEventListener('DOMContentLoaded', () => main());\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/main.browser.ts\n **/","import { MdAnchor, MdButton } from '@angular2-material/button';\nimport { MD_CARD_DIRECTIVES } from '@angular2-material/card';\nimport { MdCheckbox } from '@angular2-material/checkbox';\nimport { MD_INPUT_DIRECTIVES } from '@angular2-material/input';\nimport { MD_LIST_DIRECTIVES } from '@angular2-material/list';\nimport { MdProgressBar } from '@angular2-material/progress-bar';\nimport { MdProgressCircle, MdSpinner } from '@angular2-material/progress-circle';\nimport { MdRadioButton, MdRadioDispatcher, MdRadioGroup } from '@angular2-material/radio';\nimport { MD_SIDENAV_DIRECTIVES } from '@angular2-material/sidenav';\nimport { MdToolbar } from '@angular2-material/toolbar';\nimport { MD_ICON_DIRECTIVES, MdIconRegistry } from '@angular2-material/icon';\n\n/*\n * we are grouping the module so we only need to manage the imports in one location\n */\n\nexport const MATERIAL_PIPES = [\n\n];\n\nexport const MATERIAL_DIRECTIVES = [\n  ...MD_SIDENAV_DIRECTIVES,\n  ...[\n    MdAnchor,\n    MdButton,\n    MdToolbar,\n    MdCheckbox,\n    MdRadioButton,\n    MdRadioGroup,\n    MdSpinner,\n    MdProgressBar,\n    MdProgressCircle\n  ],\n  ...MD_INPUT_DIRECTIVES,\n  ...MD_LIST_DIRECTIVES,\n  ...MD_CARD_DIRECTIVES,\n  ...MD_ICON_DIRECTIVES\n];\n\nexport const MATERIAL_PROVIDERS = [\n  MdRadioDispatcher,\n  MdIconRegistry\n];\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/browser/angular2-material2/index.ts\n **/","/*\n * These are globally available directives in any template\n */\n\nimport { PLATFORM_DIRECTIVES } from '@angular/core';\n// Angular 2 Router\nimport { ROUTER_DIRECTIVES } from '@angular/router-deprecated';\n\n// Angular 2 Material 2\n// TODO(gdi2290): replace with @angular2-material/all\nimport { MATERIAL_DIRECTIVES } from './angular2-material2';\n\n// application_directives: directives that are global through out the application\nexport const APPLICATION_DIRECTIVES = [\n  ...ROUTER_DIRECTIVES,\n  ...MATERIAL_DIRECTIVES\n];\n\nexport const DIRECTIVES = [\n  {provide: PLATFORM_DIRECTIVES, multi: true, useValue: APPLICATION_DIRECTIVES }\n];\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/browser/directives.ts\n **/","import {\n  FIREBASE_PROVIDERS as ORG_FIREBASE_PROVIDERS,\n  defaultFirebase\n} from 'angularfire2';\n\n\nexport const FIREBASE_PROVIDERS = [\n  ORG_FIREBASE_PROVIDERS,\n  defaultFirebase('https://angular2-chess.firebaseio.com')\n];\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/browser/firebase/index.ts\n **/","export * from './directives';\nexport * from './pipes';\nexport * from './providers';\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/browser/index.ts\n **/","/*\n * These are globally available pipes in any template\n */\n\nimport { PLATFORM_PIPES } from '@angular/core';\n\n// application_pipes: pipes that are global through out the application\nexport const APPLICATION_PIPES = [\n\n];\n\nexport const PIPES = [\n  {provide: PLATFORM_PIPES, multi: true, useValue: APPLICATION_PIPES }\n];\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/browser/pipes.ts\n **/","/*\n * These are globally available services in any component or any other service\n */\n\n// Angular 2\nimport { FORM_PROVIDERS, HashLocationStrategy, LocationStrategy } from '@angular/common';\n// Angular 2 Http\nimport { HTTP_PROVIDERS } from '@angular/http';\n// Angular 2 Router\nimport { ROUTER_PROVIDERS } from '@angular/router-deprecated';\n\n// Angular 2 Material\n// TODO(gdi2290): replace with @angular2-material/all\nimport { MATERIAL_PROVIDERS } from './angular2-material2';\n\n// Angular fire 2\nimport { FIREBASE_PROVIDERS } from './firebase';\n/*\n* Application Providers/Directives/Pipes\n* providers/directives/pipes that only live in our browser environment\n*/\nexport const APPLICATION_PROVIDERS = [\n  ...FORM_PROVIDERS,\n  ...HTTP_PROVIDERS,\n  ...MATERIAL_PROVIDERS,\n  ...ROUTER_PROVIDERS,\n  {provide: LocationStrategy, useClass: HashLocationStrategy },\n  ...FIREBASE_PROVIDERS\n];\n\nexport const PROVIDERS = [\n  ...APPLICATION_PROVIDERS\n];\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/browser/providers.ts\n **/","\n// Angular 2\nimport { enableProdMode } from '@angular/core';\n\n// Environment Providers\nlet PROVIDERS = [];\n\nif ('production' === ENV) {\n  // Production\n  enableProdMode();\n\n  PROVIDERS = [\n    ...PROVIDERS\n  ];\n\n} else {\n  // Development\n  PROVIDERS = [\n    ...PROVIDERS\n  ];\n\n}\n\n\nexport const ENV_PROVIDERS = [\n  ...PROVIDERS\n];\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/platform/environment.ts\n **/"],"sourceRoot":""}