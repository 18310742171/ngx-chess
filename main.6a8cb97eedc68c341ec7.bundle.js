webpackJsonp([2],{"/N2D":function(t,e,n){"use strict";var o=n("e17S");n.d(e,"a",(function(){return o.a}))},"04On":function(t,e,n){var o=n("3O+w");t.exports="string"==typeof o?o:o.toString()},"13Jr":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o=n("3j3K"),i=n("fYnu"),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},s=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=this&&this.__param||function(t,e){return function(n,o){e(n,o,t)}},c=(function(){function t(t,e){this.dialogRef=t,this.data=e}return t=r([n.i(o._0)({selector:"game-dialog",styles:[n("04On")],template:n("OVRl")}),a(1,n.i(o.d)(i.E)),s("design:paramtypes",[i.F,Object])],t)})()},"2Nc6":function(t,e,n){"use strict";var o=n("BWge");n.d(e,"a",(function(){return o.a}))},"3O+w":function(t,e,n){e=t.exports=n("FZ+f")(void 0),e.push([t.i,"",""])},"4V5o":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o=n("3j3K"),i=n("fYnu"),r=n("X7lK"),s=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},a=[i.a,i.b,i.c,i.d,i.e,i.f,r.a,i.g,i.h,i.i,i.j,i.k,i.l,i.m,i.n,i.o,i.p,i.q,i.r,i.s,i.t,i.u,i.v,i.w,i.x,i.y,i.z,i.A,i.B,r.b,r.c,r.a,r.d,r.e,r.f,i.C,i.D],c=(function(){function t(){}return t=s([n.i(o.z)({imports:a,exports:a})],t)})()},"5hkn":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return f}));var o=n("S/nS"),i=n("3j3K"),r=n("kb0c"),s=n("BBGV"),a=(function(){function t(){}return t.prototype.create=function(){},t})(),c=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),u=(function(t){function e(e,n){var o=t.call(this)||this;return o.stockfishProvider=e,o.zone=n,o}return c(e,t),Object.defineProperty(e.prototype,"aiReady",{get:function(){return this.fishWrap&&this.fishWrap.isInit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aiSupported",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aiLevel",{get:function(){if(this.fishWrap.isInit)return this.fishWrap.meta.option.SkillLevel.value/2;throw new Error("Engine did not initialize.")},set:function(t){if(t>10&&(t=10),t<0&&(t=0),this.aiLevel!==t){if(t*=2,!this.fishWrap.isInit)throw new Error("Engine did not initialize.");var e=Math.round(-.25*t+5),n=Math.round(6.35*t+1);this.fishWrap.setoption(r.a.SkillLevel,t),this.fishWrap.setoption(r.a.SkillLevelMaximumError,e),this.fishWrap.setoption(r.a.SkillLevelProbability,n)}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;return t.prototype.init.call(this).then((function(){return e.fishWrap||(e.fishWrap=new r.b(function(){return e.stockfishProvider.create()})),e.fishWrap.uci()}))},e.prototype.newGame=function(){var e=this;return t.prototype.newGame.call(this).then((function(){return e.init()})).then((function(){return e.fwHistory=[],e.fishWrap.stop().then((function(t){return e.fishWrap.ucinewgame()})).then((function(t){return e.fishWrap.position(r.c.startpos)}))}))},e.prototype.move=function(e,n,o){var i=t.prototype.move.call(this,e,n,o);if(!i.invalid&&this.aiReady){var a=""+i.from+i.to+(i.promotion?s.a.piece.to(i.promotion):"");this.fwHistory.push(a),this.fishWrap.position(r.c.startpos,this.fwHistory.join(" "))}return i},e.prototype.undo=function(){var e=t.prototype.undo.call(this);return!e.invalid&&this.aiReady&&(this.fwHistory.pop(),this.fishWrap.position(r.c.startpos,this.fwHistory.join(" "))),e},e.prototype.aiNextMove=function(t){return this.aiReady?this.fishWrap.goDyn(!0).depth(t.depth).movetime(t.limit).wtime(t.white.time).winc(t.white.inc).btime(t.black.time).binc(t.black.inc).$post().then((function(t){return s.a.move.factoryLongAlg(t.bestMove.move)})):Promise.reject(new Error("AI is not initialized."))},e.prototype.aiStop=function(){return this.fishWrap.stop()},e.prototype.destroy=function(){this.fishWrap&&this.fishWrap.destroy()},e.decorators=[{type:i.c}],e.ctorParameters=function(){return[{type:a},{type:i.k}]},e})(s.b),f=[{provide:o.a,useClass:u}]},"6jZC":function(t,e){function n(t){return new Promise(function(e,n){n(new Error("Cannot find module '"+t+"'."))})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="6jZC"},"8gHW":function(t,e,n){e=t.exports=n("FZ+f")(void 0),e.push([t.i,".home{padding-left:24px;padding-right:24px;text-align:center;color:#009688}.home h1{color:#9c27b0}.home p>a{font-size:1.15em}.board-container{padding-top:25px;padding-left:25%;width:50%}",""])},"9fH+":function(t,e){},BBGV:function(t,e,n){"use strict";function o(t,e){for(var n=0,o=e.length;n<o;n++)if(t.block===e[n].block)return n;return-1}n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return d}));var i=n("S/nS"),r=n("4jZ1"),s=(n.n(r),n("3j3K")),a=/^([a-h]\d)([a-h]\d)([qkbn]?)$/,c={from:function(t){switch(t){case"w":return i.c.WHITE;case"b":return i.c.BLACK;default:return i.c.UNKNOWN}},to:function(t){switch(t){case i.c.WHITE:return"w";case i.c.BLACK:return"b";default:return null}}},u={from:function(t){switch(t){case"p":return i.f.PAWN;case"b":return i.f.BISHOP;case"n":return i.f.KNIGHT;case"r":return i.f.ROOK;case"q":return i.f.QUEEN;case"k":return i.f.KING;default:return i.f.UNKNOWN}},to:function(t){switch(t){case i.f.PAWN:return"p";case i.f.BISHOP:return"b";case i.f.KNIGHT:return"n";case i.f.ROOK:return"r";case i.f.QUEEN:return"q";case i.f.KING:return"k";default:return null}},factory:function(t,e){return new i.j(t,u.from(e.type),c.from(e.color))}},f={from:function(t){switch(t){case"np":case"pn":return i.k.Promotion;case"n":return i.k.Regular;case"b":return i.k.PawnMoveTwo;case"e":return i.k.EnPassant;case"c":return i.k.Capture;case"k":return i.k.KingSideCastling;case"q":return i.k.QueenSideCastling;case"cp":case"pc":return i.k.PromotionWithCapture;default:return i.k.UNKNOWN}},to:function(t){switch(t){case i.k.Regular:return"n";case i.k.PawnMoveTwo:return"b";case i.k.EnPassant:return"e";case i.k.Capture:return"c";case i.k.Promotion:return"p";case i.k.KingSideCastling:return"k";case i.k.QueenSideCastling:return"q";case i.k.PromotionWithCapture:return"cp";default:return null}},factory:function(t){var e=new i.l;return null===t?e.invalid=!0:(e.piece=u.from(t.piece),e.color=c.from(t.color),e.type=f.from(t.flags),e.from=t.from,e.to=t.to,t.captured&&(e.captured=u.from(t.captured)),t.promotion&&(e.promotion=u.from(t.promotion))),e},factoryLongAlg:function(t){var e=new i.l,n=a.exec(t);if(!n)throw new Error("Invalid Long Algebraic Notation instruction "+t);return e.from=n[1],e.to=n[2],4===n.length&&(e.promotion=p.piece.from(n[3])),e}},p={color:c,piece:u,move:f},h=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),l=(function(t){function e(){var e=t.call(this)||this;return e.state=i.d.IDLE,e.stateChanged=new s.F(!0),e.boardSynced=new s.F(!0),e.initBoard(),e}return h(e,t),Object.defineProperty(e.prototype,"rowCount",{get:function(){return 8},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colCount",{get:function(){return 8},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inGame",{get:function(){switch(this.state){case i.d.ACTIVE:case i.d.CHECK:return!0;default:return!1}},enumerable:!0,configurable:!0}),e.prototype.init=function(){return Promise.resolve()},e.prototype.newGame=function(){return this.chess=r?new r:new r.Chess,this.pieces=this.createPieces(),this.capturedPieces=[],this.changeState(i.d.ACTIVE),this.boardSynced.emit(null),Promise.resolve()},e.prototype.isPromotionMove=function(t,e){if(t.type===i.f.PAWN){if(t.color===i.c.BLACK&&e.col===this.rowCount-1)return!0;if(t.color===i.c.WHITE&&0===e.col)return!0}return!1},e.prototype.move=function(t,e,n){if(this.state!==i.d.ACTIVE&&this.state!==i.d.CHECK)return null;var o=p.move.factory(this.chess.move({from:t.block.pos,to:e.pos,promotion:p.piece.to(n)}));return o.invalid||(o.effected=this.updateMove(o,t,e),this.checkState()),o},e.prototype.undo=function(){if(this.state!==i.d.ACTIVE&&this.state!==i.d.CHECK)return p.move.factory(null);var t=p.move.factory(this.chess.undo());if(!t.invalid){var e=this.getPiece(t.to),n=this.getBlock(t.from);t.effected=this.updateMove(t,e,n,!0),this.checkState()}return t},e.prototype.turn=function(){return p.color.from(this.chess.turn())},e.prototype.winner=function(){return this.state===i.d.CHECKMATE?this.turn()===i.c.BLACK?i.c.WHITE:i.c.BLACK:i.c.UNKNOWN},e.prototype.getBlock=function(t){return this.blocks[i.e.posToIndex(t,this.rowCount)]},e.prototype.getPiece=function(t){for(var e=0,n=this.pieces.length;e<n;e++)if(this.pieces[e].block.pos===t)return this.pieces[e]},e.prototype.getBPI=function(t){"string"!=typeof t&&(t=t.pos);for(var e=0,n=this.pieces.length;e<n;e++)if(this.pieces[e].block.pos===t)return e;return-1},e.prototype.moves=function(t){var e=this;return this.chess.moves({square:t.block.pos}).map((function(n){return e.blocks[i.e.sanToIndex(n,t.block.pos)]}))},e.prototype.syncBoard=function(){for(var t=this.createPieces(),e=0,n=this.pieces.length;e<n;e++){var i=o(this.pieces[e],t);if(-1===i)this.pieces.splice(e,1),n--,e--;else{var r=t.splice(i,1)[0];this.pieces[e].color=r.color,this.pieces[e].type=r.type}}(s=this.pieces).splice.apply(s,[this.pieces.length,0].concat(t)),this.boardSynced.emit(null);var s},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.stateChanged.complete(),this.boardSynced.complete()},e.prototype.updateMove=function(t,e,n,o){void 0===o&&(o=!1);var r=[e];if(t.isPromotionMove()&&(e.type=o?t.piece:t.promotion),t.isCaptureMove())if(o){var s=this.capturedPieces.pop();this.pieces.push(s),s.block=e.block,s.captured=!1,r.push(s)}else{var a=n.index;t.type===i.k.EnPassant&&(a+=n.col>e.block.col?-1:1);var s=this.getPiece(this.blocks[a].pos);s.capture(),this.pieces.splice(this.pieces.indexOf(s),1),this.capturedPieces.push(s),r.push(s)}if(t.isCastlingMove())if(o){var c=e.block.row>n.row?[1,-1]:[-2,1],u=e.block.index+this.rowCount*c[0],f=e.block.index+this.rowCount*c[1],s=this.getPiece(this.blocks[f].pos);s.block=this.blocks[u],r.push(s)}else{var c=n.row>e.block.row?[1,-1]:[-2,1],u=n.index+this.rowCount*c[0],f=n.index+this.rowCount*c[1],s=this.getPiece(this.blocks[u].pos);s.block=this.blocks[f],r.push(s)}return e.block=n,r},e.prototype.checkState=function(){if(this.chess.game_over())if(this.chess.in_checkmate())this.changeState(i.d.CHECKMATE);else if(this.chess.in_draw())this.changeState(i.d.DRAW);else if(this.chess.in_stalemate())this.changeState(i.d.STALEMATE);else if(this.chess.in_threefold_repetition())this.changeState(i.d.THREEFOLD_REPETITION);else{if(!this.chess.insufficient_material())throw new Error("Unknown game state");this.changeState(i.d.INSUFFICIENT_MATERIAL)}else this.chess.in_check()?this.changeState(i.d.CHECK):this.state===i.d.CHECK&&this.changeState(i.d.ACTIVE)},e.prototype.changeState=function(t){this.state!==t&&(this.state=t,this.stateChanged.emit(t))},e.prototype.initBoard=function(){this.pieces=void 0,this.capturedPieces=void 0,this.blocks=this.createBlocks()},e.prototype.createBlocks=function(){for(var t=i.e.factory({rowCount:this.rowCount,colCount:this.colCount}),e=[],n=0,o=this.rowCount*this.colCount;n<o;n++)e.push(new t(n));return e},e.prototype.createPieces=function(){var t=this,e=[];return this.blocks.forEach((function(n){var o;(o=t.chess.get(n.pos))&&e.push(p.piece.factory(n,o))})),e},e.decorators=[{type:s.c}],e.ctorParameters=function(){return[]},e})(i.a),d=[{provide:i.a,useClass:l}]},BWge:function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var o=n("Qbdm"),i=n("KN8t"),r=n("NVOs"),s=n("tA9S"),a=n("3j3K"),c=n("NTqS"),u=(n.n(c),n("5oXY")),f=n("aVQ5"),p=n("4V5o"),h=n("qAGD"),l=n("Ea2O"),d=n("ObB1"),g=n("yp+s"),y=n("IOFz"),m=n("/N2D"),v=n("13Jr"),b=n("9fH+"),w=(n.n(b),this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}),k=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},x=[g.a],O=(function(){function t(t,e){this.appRef=t,this.appState=e}return t.prototype.hmrOnInit=function(t){if(t&&t.state){if(console.log("HMR store",JSON.stringify(t,null,2)),this.appState._state=t.state,"restoreInputValues"in t){var e=t.restoreInputValues;setTimeout(e)}this.appRef.tick(),delete t.state,delete t.restoreInputValues}},t.prototype.hmrOnDestroy=function(t){var e=this.appRef.components.map((function(t){return t.location.nativeElement})),o=this.appState._state;t.state=o,t.disposeOldHosts=n.i(c.createNewHosts)(e),t.restoreInputValues=n.i(c.createInputTransfer)(),n.i(c.removeNgStyles)()},t.prototype.hmrAfterDestroy=function(t){t.disposeOldHosts(),delete t.disposeOldHosts},t=w([n.i(a.z)({bootstrap:[d.a],declarations:[d.a,y.a,m.a,v.a],imports:[o.b,i.a,r.a,u.a.forRoot(l.a,{useHash:!0,preloadingStrategy:u.b}),p.a,s.a,f.a],providers:[h.b,x],entryComponents:[v.a]}),k("design:paramtypes",[a.j,g.a])],t)})()},EKZ2:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var o=n("eErF"),i=(n.n(o),n("3j3K")),r=n("fYnu"),s=n("S/nS"),a=n("13Jr"),c=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),u=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},f=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},p=(function(t){function e(e){var n=t.call(this)||this;return n.dialog=e,n}return c(e,t),e.prototype.showMessage=function(t,e){var n={data:t,disableClose:t.blocking};return this.dialog.open(a.a,n).afterClosed().toPromise()},e=u([n.i(i.c)(),f("design:paramtypes",[r.G])],e)})(s.g)},Ea2O:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n("IOFz"),i=n("/N2D"),r=[{path:"home",component:o.a},{path:"game",component:i.a},{path:"**",component:o.a}]},IOFz:function(t,e,n){"use strict";var o=n("ONqt");n.d(e,"a",(function(){return o.a}))},Mi9a:function(t,e,n){"use strict";function o(t){n.e(0).then(function(e){var o=n("VW3/");t(o())}.bind(null,n)).catch(n.oe)}function i(t){var e=new s;e.onmessage=function(){e.onmessage=void 0,t(e),e=void 0}}function r(t){var e,n,r=new Promise(function(t,o){e=t,n=o});return!0===t?i(e):o(e),r}e.a=r;var s=n("Saai")},N0OX:function(t,e,n){e=t.exports=n("FZ+f")(void 0),e.push([t.i,".game-toolbar{margin:10px 0}.game-toolbar>*{margin:5px}.ai-select-container{padding-top:22px}.board-content-left,.board-content-right{padding:0 15px}@media (orientation:landscape){.board-container{height:100%;max-height:100%}.svg-chess-board{margin:auto;height:100%}}@media (orientation:portrait){.board-container{max-width:100%}.board-container,.svg-chess-board{width:100%;height:100%}}",""])},ONqt:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o=n("3j3K"),i=n("S/nS"),r=n("BBGV"),s=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},c=(function(){function t(){}return t.prototype.ngAfterViewInit=function(){var t=this;this.board.ctrl.init().then((function(){t.board.ctrl.setPlayer(i.c.BLACK,i.i.HUMAN).setPlayer(i.c.WHITE,i.i.HUMAN).newGame()}))},s([n.i(o._3)("board"),a("design:type",i.h)],t.prototype,"board",void 0),t=s([n.i(o._0)({selector:"home",providers:r.c.slice(),styles:[n("P/f0")],template:n("ypwn")}),a("design:paramtypes",[])],t)})()},OVRl:function(t,e){t.exports='<h2 md-dialog-title>{{ data.title }}</h2>\n<md-dialog-content>{{ data.message }}</md-dialog-content>\n<md-dialog-actions>\n    <button md-button [md-dialog-close]="true">OK</button>\n</md-dialog-actions>'},ObB1:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var o=n("3j3K"),i=n("yp+s"),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},s=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=(function(){function t(t){this.appState=t,this.loading=!1,this.name="Angular Chess"}return t=r([n.i(o._0)({selector:"app",template:'\n      <main>\n          <div fxLayout="column" fxFill>\n              <div fxFlex="nogrow">\n                  <md-toolbar color="primary">\n                      <span>{{ name }}</span>\n                      <span class="fill"></span>\n                      <button md-button [routerLink]=" [\'./home\'] ">\n                          Home\n                      </button>\n                      <button md-button [routerLink]=" [\'./game\'] ">\n                          Game\n                      </button>\n                  </md-toolbar>\n\n                  <md-progress-bar mode="indeterminate" color="primary" *ngIf="loading"></md-progress-bar>  \n              </div>\n              <div fxFlex>\n                  <router-outlet></router-outlet>\n              </div>\n          </div>\n      </main>'}),s("design:paramtypes",[i.a])],t)})()},"P/f0":function(t,e,n){var o=n("8gHW");t.exports="string"==typeof o?o:o.toString()},PuJq:function(t,e){t.exports='<ng-template #playerGui let-ctx>\n  <div>\n    <md-button-toggle-group [(ngModel)]="ctx.rawtype" (change)="onPlayerTypeChange($event.value, ctx)">\n      <md-button-toggle color="primary" value="HUMAN">\n        <md-icon>face</md-icon>\n      </md-button-toggle>\n      <md-button-toggle value="AI">\n        <md-icon>computer</md-icon>\n      </md-button-toggle>\n    </md-button-toggle-group>\n  </div>\n  <div class="ai-select-container">\n    <md-select placeholder="AI Level" (change)="onAILevelChange($event, ctx)" [ngModel]="ctx.aiIndex">\n      <md-option *ngFor="let i of aiLevels" [value]="i">{{i}}</md-option>\n    </md-select>\n  </div>\n</ng-template>\n\n<ng-template #spinner><md-progress-spinner mode="indeterminate"></md-progress-spinner></ng-template>\n\n<div fxLayout="column" fxFill>\n  <div fxFlex="nogrow" fxLayout="row" fxLayoutAlign="center">\n    <div class="game-toolbar">\n      <button md-mini-fab (click)="onNewGame()"\n              mdTooltip="New Game" mdTooltipPosition="below"\n              [disabled]="board.ctrl.aiProcessing">\n        <md-icon class="md-24">play_arrow</md-icon>\n      </button>\n      <button md-mini-fab (click)="ctrl.undo()"\n              mdTooltip="Undo move" mdTooltipPosition="below"\n              [disabled]="board.ctrl.aiProcessing || !isInit">\n        <md-icon class="md-24">undo</md-icon>\n      </button>\n      <button md-mini-fab (click)="hint()"\n              mdTooltip="Hint next move" mdTooltipPosition="below"\n              [disabled]="board.ctrl.aiProcessing || !isInit" *ngIf="board.ctrl.aiSupported">\n        <md-icon class="md-24">remove_red_eye</md-icon>\n      </button>\n      <button md-mini-fab (click)="onStop()"\n              mdTooltip="Stop AI proccessing" mdTooltipPosition="below"\n              [disabled]="!board.ctrl.aiProcessing">\n        <md-icon class="md-24">pan_tool</md-icon>\n      </button>\n    </div>\n  </div>\n  <div fxFlex="nogrow" *ngIf="board.isPortrait">\n    <div fxLayout="row" fxLayoutAlign="space-between center" [ngStyle]="{\'width.px\': boardRect.clientWidth, \'margin-left.px\': boardRect.xOffset}">\n      <ng-container *ngTemplateOutlet="playerGui; context: {\'$implicit\': black}"></ng-container>\n    </div>\n  </div>\n  <div fxFlex fxFill style="overflow-y: hidden">\n    <div class="board-container">\n      <chess-board class="svg-chess-board" #board (onBoardResize)="onBoardResize($event)">\n        <div fxFlexFill fxLayout="column" fxLayoutAlign="start end" class="board-content-left">\n          <ng-container *ngTemplateOutlet="playerGui; context: {\'$implicit\': black}"></ng-container>\n        </div>\n        <div fxFlexFill fxLayout="column-reverse" fxLayoutAlign="start start" class="board-content-right">\n          <ng-container *ngTemplateOutlet="playerGui; context: {\'$implicit\': white}"></ng-container>\n        </div>\n      </chess-board>\n    </div>\n  </div>\n  <div fxFlex="nogrow" fxLayout="row" fxLayoutAlign="space-between center">\n    <div *ngIf="board.isPortrait" fxLayout="row" fxLayoutAlign="space-between center" [ngStyle]="{\'width.px\': boardRect.clientWidth, \'margin-left.px\': boardRect.xOffset}">\n      <ng-container *ngTemplateOutlet="playerGui; context: {\'$implicit\': white}"></ng-container>\n    </div>\n  </div>\n  <div style="min-height: 25px;">\n    <p *ngIf="!workerSupported" style="text-align: center; margin-top: 0">Your broswer does not support web workers, expect UI lags while computer thinks</p>\n  </div>\n</div>\n'},QGt1:function(t,e,n){"use strict";function o(){return n.i(r.a)().bootstrapModule(a.a).then(s.a).catch((function(t){return console.error(t)}))}function i(){document.removeEventListener("DOMContentLoaded",i,!1),o()}Object.defineProperty(e,"__esModule",{value:!0}),e.main=o;var r=n("O61y"),s=n("qAGD"),a=n("2Nc6");switch(document.readyState){case"loading":document.addEventListener("DOMContentLoaded",i,!1);break;case"interactive":case"complete":default:o()}},"S/nS":function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"f",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"k",(function(){return a})),n.d(e,"i",(function(){return c})),n.d(e,"e",(function(){return p})),n.d(e,"j",(function(){return h})),n.d(e,"l",(function(){return l})),n.d(e,"g",(function(){return d})),n.d(e,"h",(function(){return g})),n.d(e,"a",(function(){return y})),n.d(e,"b",(function(){return m}));var o=n("3j3K"),i={};i.IDLE=0,i.ACTIVE=1,i.CHECK=2,i.CHECKMATE=3,i.DRAW=4,i.STALEMATE=5,i.THREEFOLD_REPETITION=6,i.INSUFFICIENT_MATERIAL=7,i[i.IDLE]="IDLE",i[i.ACTIVE]="ACTIVE",i[i.CHECK]="CHECK",i[i.CHECKMATE]="CHECKMATE",i[i.DRAW]="DRAW",i[i.STALEMATE]="STALEMATE",i[i.THREEFOLD_REPETITION]="THREEFOLD_REPETITION",i[i.INSUFFICIENT_MATERIAL]="INSUFFICIENT_MATERIAL";var r={};r.UNKNOWN=0,r.PAWN=1,r.BISHOP=2,r.KNIGHT=3,r.ROOK=4,r.QUEEN=5,r.KING=6,r[r.UNKNOWN]="UNKNOWN",r[r.PAWN]="PAWN",r[r.BISHOP]="BISHOP",r[r.KNIGHT]="KNIGHT",r[r.ROOK]="ROOK",r[r.QUEEN]="QUEEN",r[r.KING]="KING";var s={};s.UNKNOWN=0,s.BLACK=1,s.WHITE=2,s[s.UNKNOWN]="UNKNOWN",s[s.BLACK]="BLACK",s[s.WHITE]="WHITE";var a={};a.UNKNOWN=0,a.Regular=1,a.PawnMoveTwo=2,a.Capture=3,a.EnPassant=4,a.Promotion=5,a.PromotionWithCapture=6,a.KingSideCastling=7,a.QueenSideCastling=8,a[a.UNKNOWN]="UNKNOWN",a[a.Regular]="Regular",a[a.PawnMoveTwo]="PawnMoveTwo",a[a.Capture]="Capture",a[a.EnPassant]="EnPassant",a[a.Promotion]="Promotion",a[a.PromotionWithCapture]="PromotionWithCapture",a[a.KingSideCastling]="KingSideCastling",a[a.QueenSideCastling]="QueenSideCastling";var c={};c.HUMAN=0,c.AI=1,c[c.HUMAN]="HUMAN",c[c.AI]="AI";var u=(function(){function t(){this.player=c.HUMAN}return t})(),f=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),p=(function(){function t(t){this.index=t,this.row=Math.floor(t/this.meta.rowCount),this.col=t%this.meta.colCount,this.pos=String.fromCharCode(97+this.row)+(this.meta.rowCount-this.col),this.isOdd=this.calcIsOdd(this.row,this.col)}return t.prototype.calcIsOdd=function(t,e){return t%2?!(e%2):!!(e%2)},t.factory=function(e){var n=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e})(t);return Object.defineProperty(n.prototype,"meta",{configurable:!1,enumerable:!1,value:e,writable:!1}),n},t.sanToPos=function(t,e){var n=/[a-h][1-8]/.exec(t);return n?n[0]:"O-O"===t?"g"+e[1]:"O-O-O"===t?"c"+e[1]:null},t.sanToIndex=function(e,n,o){return void 0===o&&(o=8),t.posToIndex(t.sanToPos(e,n))},t.posToIndex=function(t,e){return void 0===e&&(e=8),(t.charCodeAt(t.length-2)-97)*e+(e-Number(t[t.length-1]))},t.pointToIndex=function(t,e,n,o){return void 0===n&&(n=75),void 0===o&&(o=8),Math.floor(t/n)*o+Math.floor(e/n)},t})(),h=(function(){function t(t,e,n){this.block=t,this.type=e,this.color=n}return t.prototype.capture=function(){this.block=void 0,this.captured=!0},t})(),l=(function(){function t(){this.captured=r.UNKNOWN,this.promotion=r.UNKNOWN}return t.prototype.isCaptureMove=function(){switch(this.type){case a.Capture:case a.PromotionWithCapture:case a.EnPassant:return!0}return!1},t.prototype.isPromotionMove=function(){switch(this.type){case a.Promotion:case a.PromotionWithCapture:return!0}return!1},t.prototype.isCastlingMove=function(){switch(this.type){case a.QueenSideCastling:case a.KingSideCastling:return!0}return!1},t})(),d=(function(){function t(){}return t.prototype.showMessage=function(t,e){},t})(),g=(function(){function t(t,e){Object.defineProperty(this,"ctrl",{value:new t(this,e)})}return t.prototype.highlight=function(t){},t.prototype.newGame=function(){},t.prototype.move=function(t){},t.prototype.askPromotionType=function(){},t.prototype.blockUi=function(t){},t.prototype.busy=function(t){},t})(),y=(function(){function t(){this.state=i.IDLE,this.stateChanged=new o.F(!0),this.boardSynced=new o.F(!0)}return Object.defineProperty(t.prototype,"aiReady",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aiSupported",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.newGame=function(){},t.prototype.isPromotionMove=function(t,e){},t.prototype.move=function(t,e,n){},t.prototype.turn=function(){},t.prototype.winner=function(){},t.prototype.undo=function(){},t.prototype.moves=function(t){},t.prototype.getBlock=function(t){},t.prototype.getPiece=function(t){},t.prototype.aiNextMove=function(t){return Promise.reject(new Error("Not implemented."))},t.prototype.aiStop=function(){return Promise.resolve()},t.prototype.destroy=function(){},t})(),m=(function(){function t(t,e){this.board=t,this.engine=e,this.aiProcessing=!1,this.players=[null,new u,new u],this.stateChanged=e.stateChanged.asObservable()}return Object.defineProperty(t.prototype,"white",{get:function(){return this.players[s.WHITE]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"black",{get:function(){return this.players[s.BLACK]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"winner",{get:function(){return this.engine.winner()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPlayer",{get:function(){return this.players[this.engine.turn()]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aiSupported",{get:function(){return this.engine.aiSupported},enumerable:!0,configurable:!0}),t.prototype.setPlayer=function(t,e,n){return t===s.BLACK?(this.black.player=e,n>0&&(this.black.aiLevel=n)):t===s.WHITE&&(this.white.player=e,n>0&&(this.white.aiLevel=n)),this},t.prototype.init=function(){return this.engine.init()},t.prototype.newGame=function(){var t=this;return this.board.newGame().then((function(){return t.engine.newGame()}))},t.prototype.move=function(t,e,n){var o=this,i=this.currentPlayer.player===c.AI;if(!i&&!n&&this.engine.isPromotionMove(t,e))return this.board.askPromotionType().then((function(n){return o.move(t,e,n)}));var r=this.engine.move(t,e,n);return r.invalid||r.effected.filter((function(t){return!!t.block})).forEach((function(t){return o.board.move(t)})),i=this.currentPlayer.player===c.AI,this.engine.aiReady&&i&&setTimeout((function(){return o.doNextMove()}),0),Promise.resolve(r)},t.prototype.highlight=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.board.highlight(e.map((function(e){return"string"==typeof e?t.engine.getBlock(e):e})))},t.prototype.aiNextMove=function(){var t=this;return this.aiProcessing=!0,this.setAILevel(),this.board.blockUi(!0),this.board.busy(!0),this.engine.aiNextMove(this.buildQuery()).then((function(e){return t.aiProcessing=!1,t.board.busy(!1),t.board.blockUi(!1),e}))},t.prototype.aiStop=function(){return this.engine.aiStop()},t.prototype.undo=function(){var t=this,e=this.engine.undo();e.invalid||e.effected.filter((function(t){return!!t.block})).forEach((function(e){return t.board.move(e)}))},t.prototype.destroy=function(){this.engine.destroy()},t.prototype.doNextMove=function(){var t=this;return this.engine.state===i.ACTIVE||this.engine.state===i.CHECK?this.aiNextMove().then((function(e){return t.move(t.engine.getPiece(e.from),t.engine.getBlock(e.to),e.promotion)})):Promise.resolve()},t.prototype.isGameOver=function(t){switch(t){case i.DRAW:case i.STALEMATE:case i.THREEFOLD_REPETITION:case i.INSUFFICIENT_MATERIAL:case i.CHECKMATE:return!0;default:return!1}},t.prototype.setAILevel=function(){var t=this.currentPlayer.aiLevel;if(!isNaN(t)&&this.engine.aiLevel!==t)return this.engine.aiLevel=t,this.depth=this.engine.aiLevel>4?void 0:this.engine.aiLevel,this},t.prototype.buildQuery=function(){var t=this.black,e=this.white;return{depth:this.depth,black:{time:void 0===t.time?144e3:t.time,inc:t.inc},white:{time:void 0===e.time?144e3:e.time,inc:e.inc}}},t})()},Saai:function(t,e,n){t.exports=function(){return new Worker(n.p+"67e7f1143977de6760e3.worker.js")}},aVQ5:function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var o=n("3j3K"),i=n("S/nS"),r=n("rCTf"),s=(n.n(r),n("E7Yq")),a=(n.n(s),n("HcJ8")),c=(n.n(a),n("+pb+")),u=(n.n(c),n("T3fU")),f=(n.n(u),n("okk1")),p=(n.n(f),n("2Je8")),h=(function(){function t(){}return t.prototype.setCoordinates=function(){this.x=this.block.row*this.size,this.y=this.block.col*this.size},t.prototype.getTransform=function(){return"translate("+this.x+", "+this.y+")"},t})(),l=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),d=(function(t){function e(){return t.call(this)||this}return l(e,t),e.prototype.ngOnInit=function(){this.setCoordinates()},e.prototype.ngOnChanges=function(t){"block"in t&&this.setCoordinates()},e.decorators=[{type:o._0,args:[{selector:"[chess-block]",inputs:["block","size"],template:'<svg:rect class="chess-block" [class.chess-block-odd]="block.isOdd" [attr.width]="size" [attr.height]="size" [attr.transform]="getTransform()"> </svg:rect> ',styles:[".chess-block { fill: #debf83; } .chess-block-odd { fill: #fb0006; } "],changeDetection:o._1.OnPush}]}],e.ctorParameters=function(){return[]},e})(h),g=.8,y=(function(){function t(t,e,n){this.game=t,this.cdr=e,this.zone=n,this.pieceDrag=new o.F(!1),this.x=300,this.y=300,this.pointerEvents="all"}return Object.defineProperty(t.prototype,"block",{get:function(){return this._block},set:function(t){this._block!==t&&(this._block=t,t&&(t.piece=this))},enumerable:!0,configurable:!0}),t.prototype.onMousedown=function(t){this.pieceDrag.emit({piece:this,event:t})},t.prototype.dragStart=function(){var t=this.game.pieces.indexOf(this.piece);t>-1&&this.game.pieces.push(this.game.pieces.splice(t,1)[0]),this.pieceFilter="url(#pieceDropShadow)",this.pointerEvents="none",g=.9,this.cdr.markForCheck()},t.prototype.dragEnd=function(){this.pieceFilter=null,this.pointerEvents="all",g=.8,this.cdr.markForCheck()},t.prototype.setCoordinates=function(t,e){this.x+=t,this.y+=e,this.cdr.markForCheck()},t.prototype.reset=function(t){var e=this;if(t>0){var n,o={x:this.x,y:this.y},i=window.performance?window.performance.now():Date.now();this.zone.runOutsideAngular((function(){var r=function(s){var a=(s-i)/t;if(a>=1)return cancelAnimationFrame(n),void e.zone.run((function(){return e.reset()}));e.x=o.x+(e.block.x-o.x)*a,e.y=o.y+(e.block.y-o.y)*a,e.zone.run((function(){return e.cdr.markForCheck()})),n=requestAnimationFrame(r)};n=requestAnimationFrame(r)}))}else this.x=this.block.x,this.y=this.block.y,this.cdr.markForCheck()},t.prototype.getTransform=function(){var t=this.block.size/45,e=this.block.size*((1-g)/2);return t*=g,"translate("+(this.x+e)+", "+(this.y+e)+") scale("+t+")"},t.decorators=[{type:o._0,args:[{selector:"[chess-piece]",template:'<svg:g *ngIf="block" class="chess-piece" [ngSwitch]="piece.type" [attr.transform]="getTransform()" [class.white]="piece.color === 2" [attr.pointer-events]="pointerEvents" [attr.filter]="pieceFilter" (mousedown)="onMousedown($event)"> \x3c!-- PAWN --\x3e <svg:path *ngSwitchCase="1" class="pawn" d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z"> </svg:path> \x3c!-- BISHOP --\x3e <svg:g *ngSwitchCase="2" class="bishop"> <g class="bishop-body"> <path d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" /> <path d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" /> <path d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" /> </g> <path class="bishop-cross" d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"/> </svg:g> \x3c!-- KNIGHT --\x3e <svg:g *ngSwitchCase="3" class="knight"> <path d="M 36,36 C 32.614745,35.027671 25.885256,36.430821 22.5,34 C 19.114744,36.430821 12.385255,35.027671 9,36 C 9,36 7.354102,36.541507 6,38 C 6.677051,38.972328 7.645898,38.986164 9,38.5 C 12.385255,37.527672 19.114744,38.958493 22.5,37.5 C 25.885256,38.958493 32.614745,37.527672 36,38.5 C 37.354102,38.986164 38.322949,38.972328 39,38 C 37.645898,36.055343 36,36 36,36 z" /> <path d="M 30,32 C 27.5,34.5 17.5,34.5 15,32 C 14.5,30.5 15,30 15,30 L 30,30 C 30,30 30.5,30.5 30,32 z"/> <path d="M 30,30 L 15,30" /> <g transform="matrix(-0.7654224,0,0,-0.7654224,37.205613,35.181827)" class="knight-body"> <path d="M 22.028958,36 C 11.528958,35 5.5289585,28 6.0289585,7 L 29.028958,7 C 29.028958,16 19.028958,13.5 21.028958,28" /> <path d="M 20.028958,28 C 19.644497,25.088722 25.581894,20.631376 28.028958,19 C 31.028958,17 30.848156,14.657108 33.028958,15 C 34.070678,15.944016 31.615529,18.037549 33.028958,18 C 34.028958,18 32.841626,16.768273 34.028958,16 C 35.028958,16 38.032119,15.000001 38.028958,20 C 38.028958,22 32.028958,32 32.028958,32 C 32.028958,32 30.143092,33.902129 30.028958,35.5 C 30.755005,36.494369 30.528958,37.5 30.528958,38.5 C 29.528958,39.5 27.528958,36 27.528958,36 L 25.528958,36 C 25.528958,36 24.747177,37.991926 23.028958,39 C 22.028958,39 22.028958,36 22.028958,36" /> <path transform="matrix(-1,0,0,-1,43.528958,44)" d="M 9,23.5 A 0.5,0.5 0 1 1 8,23.5 A 0.5,0.5 0 1 1 9,23.5 z" /> <path transform="matrix(-0.866025,-0.5,0.5,-0.866025,34.336326,51.173394)" d="M 15,15.5 A 0.5,1.5 0 1 1 14,15.5 A 0.5,1.5 0 1 1 15,15.5 z" /> <path d="M 7.0289585,7 C 6.0289585,27 12.528958,34.5 19.028958,35.5" /> </g> </svg:g> \x3c!-- ROOK --\x3e <svg:g *ngSwitchCase="4" class="rook"> <path d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "  style="stroke-linecap:butt;" /> <path d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z " style="stroke-linecap:butt;" /> <path d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14" style="stroke-linecap:butt;" /> <path d="M 34,14 L 31,17 L 14,17 L 11,14" /> <path d="M 31,17 L 31,29.5 L 14,29.5 L 14,17" style="stroke-linecap:butt; stroke-linejoin:miter;" /> <path d="M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5" /> <path d="M 11,14 L 34,14" /> </svg:g> \x3c!-- QUEEN --\x3e <svg:g *ngSwitchCase="5" class="queen"> <path d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z" transform="translate(-1,-1)" /> <path d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z" transform="translate(15.5,-5.5)" /> <path d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z" transform="translate(32,-1)" /> <path d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z" transform="translate(7,-4.5)" /> <path d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z" transform="translate(24,-4)" /> <path d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z " /> <path d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z " /> <path d="M 11.5,30 C 15,29 30,29 33.5,30" /> <path d="M 12,33.5 C 18,32.5 27,32.5 33,33.5" /> </svg:g> \x3c!-- KING --\x3e <svg:g *ngSwitchCase="6" class="king"> <path d="M 22.5,11.63 L 22.5,6" /> <path d="M 20,8 L 25,8" /> <path d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25" /> <path d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z " /> <path d="M 11.5,30 C 17,27 27,27 32.5,30" /> <path d="M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5" /> <path d="M 11.5,37 C 17,34 27,34 32.5,37" /> </svg:g> </svg:g> ',styles:[".chess-piece { cursor: pointer; } /* ======================================================================================== PAWN ======================================================================================== */ .pawn { opacity: 1; fill: #000000; fill-opacity: 1; fill-rule: nonzero; stroke: #ffffff; stroke-width: 1.5; stroke-linecap: round; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-dasharray: none; stroke-opacity: 1; } .white .pawn { opacity: 1; fill: #ffffff; fill-opacity: 1; fill-rule: nonzero; stroke: #000000; stroke-width: 1.5; stroke-linecap: round; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-dasharray: none; stroke-opacity: 1; } /* ======================================================================================== BISHOP ======================================================================================== */ .bishop { opacity: 1; fill: none; fill-rule: evenodd; fill-opacity: 1; stroke: #000000; stroke-width: 1.5; stroke-linecap: round; stroke-linejoin: round; stroke-miterlimit: 4; stroke-dasharray: none; stroke-opacity: 1; } .bishop-body { stroke: #ffffff; fill: #000000; stroke-linecap: butt; } .bishop-cross { fill: none; stroke: #ffffff; stroke-linejoin: miter; } .white .bishop { stroke: #ffffff; } .white .bishop-body { stroke: #000000; fill: #ffffff; } .white .bishop-cross { stroke: #000000; } /* ======================================================================================== KNIGHT ======================================================================================== */ .knight > path, .knight-body > path { fill: #000000; fill-opacity: 1; fill-rule: evenodd; stroke: #ffffff; stroke-width: 1.5; stroke-linecap: butt; stroke-linejoin: round; stroke-miterlimit: 4; stroke-dasharray: none; stroke-opacity: 1; } .knight-body > path { stroke-linecap: round; stroke-linejoin: miter; } .knight-body > path:nth-child(2) { stroke-linejoin: round; } .knight-body > path:nth-child(3), .knight-body > path:nth-child(4) { fill: #ffffff; } .knight-body > path:nth-child(5) { fill: none; fill-opacity: 0.75; stroke: #ffffff; } .white .knight > path:last-child, .knight > path:last-child { fill: none; fill-opacity: 0.75; } .white .knight > path, .white .knight-body > path { fill: #ffffff; stroke: #000000; } .white .knight-body > path:nth-child(3), .white .knight-body > path:nth-child(4) { fill: #000000; } .white .knight-body > path:nth-child(5) { fill: none; stroke: #000000; } /* ======================================================================================== ROOK ======================================================================================== */ .rook { opacity: 1; fill: #000000; fill-opacity: 1; fill-rule: evenodd; stroke: #ffffff; stroke-width: 1.5; stroke-linecap: round; stroke-linejoin: round; stroke-miterlimit: 4; stroke-dasharray: none; stroke-opacity: 1; } .rook > path:last-child { fill: none; stroke: #ffffff; stroke-linejoin: miter; } .white .rook { fill: #ffffff; stroke: #000000; } .white .rook > path:last-child { fill: none; stroke: #000000; } /* ======================================================================================== QUEEN ======================================================================================== */ .queen { opacity: 1; fill: #000000; fill-opacity: 1; fill-rule: evenodd; stroke: #ffffff; stroke-width: 1.5; stroke-linecap: round; stroke-linejoin: round; stroke-miterlimit: 4; stroke-dasharray: none; stroke-opacity: 1; } .queen > path:nth-child(6), .queen > path:nth-child(7) { stroke-linecap: butt; } .queen > path:nth-child(8), .queen > path:nth-child(9) { fill: none; } .white .queen { fill: #ffffff; stroke: #000000; } /* ======================================================================================== KING ======================================================================================== */ .king { fill: none; fill-opacity: 1; fill-rule: evenodd; stroke: #000000; stroke-width: 1.5; stroke-linecap: round; stroke-linejoin: round; stroke-miterlimit: 4; stroke-dasharray: none; stroke-opacity: 1; } .king > path { fill: none; stroke: #ffffff; stroke-linejoin: miter; } .king > path:nth-child(3) { fill: #000000; } .king > path:nth-child(4) { fill: #000000; stroke: #ffffff; } .white .king { stroke: #ffffff; } .white .king > path { fill: none; stroke: #000000; } .white .king > path:nth-child(3) { fill: #ffffff; } .white .king > path:nth-child(4) { fill: #ffffff; stroke: #000000; } "],changeDetection:o._1.OnPush}]}],t.ctorParameters=function(){return[{type:i.a},{type:o.Z},{type:o.k}]},t.propDecorators={piece:[{type:o.O}],pieceDrag:[{type:o._2}]},t})(),m=(function(){function t(){this.textStyle={fill:"#35322a",filter:"url('#money')",fontFamily:"'Playfair Display', 'Georgia', serif",fontSize:"80px",fontWeight:900}}return t.decorators=[{type:o._0,args:[{selector:"[chess-banner]",template:"<svg width='100%' height='100%'> <filter id='money'> <feMorphology in='SourceGraphic' operator='dilate' radius='2' result='expand'/> <feOffset in='expand' dx='1' dy='1' result='shadow_1'/> <feOffset in='expand' dx='2' dy='2' result='shadow_2'/> <feOffset in='expand' dx='3' dy='3' result='shadow_3'/> <feOffset in='expand' dx='4' dy='4' result='shadow_4'/> <feOffset in='expand' dx='5' dy='5' result='shadow_5'/> <feOffset in='expand' dx='6' dy='6' result='shadow_6'/> <feOffset in='expand' dx='7' dy='7' result='shadow_7'/> <feMerge result='shadow'> <feMergeNode in='expand'/> <feMergeNode in='shadow_1'/> <feMergeNode in='shadow_2'/> <feMergeNode in='shadow_3'/> <feMergeNode in='shadow_4'/> <feMergeNode in='shadow_5'/> <feMergeNode in='shadow_6'/> <feMergeNode in='shadow_7'/> </feMerge> <feFlood flood-color='#ebe7e0'/> <feComposite in2='shadow' operator='in' result='shadow'/> <feMorphology in='shadow' operator='dilate' radius='1' result='border'/> <feFlood flood-color='#35322a' result='border_color'/> <feComposite in2='border' operator='in' result='border'/> <feOffset in='border' dx='1' dy='1' result='secondShadow_1'/> <feOffset in='border' dx='2' dy='2' result='secondShadow_2'/> <feOffset in='border' dx='3' dy='3' result='secondShadow_3'/> <feOffset in='border' dx='4' dy='4' result='secondShadow_4'/> <feOffset in='border' dx='5' dy='5' result='secondShadow_5'/> <feOffset in='border' dx='6' dy='6' result='secondShadow_6'/> <feOffset in='border' dx='7' dy='7' result='secondShadow_7'/> <feOffset in='border' dx='8' dy='8' result='secondShadow_8'/> <feOffset in='border' dx='9' dy='9' result='secondShadow_9'/> <feOffset in='border' dx='10' dy='10' result='secondShadow_10'/> <feOffset in='border' dx='11' dy='11' result='secondShadow_11'/> <feMerge result='secondShadow'> <feMergeNode in='border'/> <feMergeNode in='secondShadow_1'/> <feMergeNode in='secondShadow_2'/> <feMergeNode in='secondShadow_3'/> <feMergeNode in='secondShadow_4'/> <feMergeNode in='secondShadow_5'/> <feMergeNode in='secondShadow_6'/> <feMergeNode in='secondShadow_7'/> <feMergeNode in='secondShadow_8'/> <feMergeNode in='secondShadow_9'/> <feMergeNode in='secondShadow_10'/> <feMergeNode in='secondShadow_11'/> </feMerge> <feImage x='0' y='0' width='100%' height='100%' xlink:href='https://s3-us-west-2.amazonaws.com/s.cdpn.io/78779/stripes.svg'/> <feComposite in2='secondShadow' operator='in' result='secondShadow'/> <feMerge> <feMergeNode in='secondShadow'/> <feMergeNode in='border'/> <feMergeNode in='shadow'/> <feMergeNode in='SourceGraphic'/> </feMerge> </filter> <style> @keyframes show { 0% { opacity: 0; transform: scale(0.1); } 100% { opacity: 1; transform: scale(1); } } text { transform: translate3d(0,0,0); animation: show 0.5s ease; } text:last-child { animation-delay: 0.2s; } </style> <text [ngStyle]=\"textStyle\" dominant-baseline='middle' text-anchor='middle' x='50%' y='25%'>{{title}}</text> <text [ngStyle]=\"textStyle\" dominant-baseline='middle' text-anchor='middle' x='50%' y='50%'>{{message}}</text> </svg> ",changeDetection:o._1.OnPush}]}],t.ctorParameters=function(){return[]},t.propDecorators={textStyle:[{type:o.O}],title:[{type:o.O}],message:[{type:o.O}]},t})(),v=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),b=(function(t){function e(e){var n=t.call(this)||this;return n.cdr=e,n}return v(e,t),e.prototype.setCoordinates=function(){t.prototype.setCoordinates.call(this),this.x+=2,this.y+=2},e.prototype.ngOnInit=function(){var t=this;this.setCoordinates(),setTimeout((function(){t.active=!0,t.cdr.markForCheck()}),16)},e.decorators=[{type:o._0,args:[{selector:"[chess-highlight]",inputs:["block","size"],template:'<svg:rect class="chess-highlight" [class.chess-highlight-active]="active" [attr.width]="size-4" [attr.height]="size-4" [attr.transform]="getTransform()"> </svg:rect> ',styles:["/*.chess-highlight {*/ /*stroke-dasharray: 140 540;*/ /*stroke-dashoffset: -474;*/ /*stroke-width: 28px;*/ /*fill: transparent;*/ /*stroke: #2861b5;*/ /*transition: stroke-width 0.5s, stroke-dashoffset 0.5s, stroke-dasharray 0.5s;*/ /*}*/ /*.chess-highlight-active {*/ /*stroke-width: 4.5px;*/ /*stroke-dashoffset: 0;*/ /*stroke-dasharray: 760;*/ /*}*/ .chess-highlight { fill: transparent; stroke-dasharray: 140 540; stroke-dashoffset: -474; stroke-width: 8px; stroke: #19f6e8; } @keyframes highlightEntrance { 0% { stroke-dasharray: 140 540; stroke-dashoffset: -474; stroke-width: 16px; } 99% { stroke-dasharray: 760; stroke-dashoffset: 0; stroke-width: 3px; } 100% { stroke-dasharray: none; stroke-dashoffset: 0; stroke-width: 3px; } } .chess-highlight-active { -webkit-animation: 0.5s highlightEntrance linear forwards; animation: 0.5s highlightEntrance linear forwards; } "],changeDetection:o._1.OnPush}]}],e.ctorParameters=function(){return[{type:o.Z}]},e})(h),w=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),k=(function(t){function e(e,n,r,s){var a=t.call(this,i.b,e)||this;return a.engine=e,a.cdr=n,a.zone=r,a.boardDialogService=s,a.rxWaste=[],a.onBoardResize=new o.F,Object.defineProperty(a,"height",{value:600}),Object.defineProperty(a,"width",{value:600}),Object.defineProperty(a,"viewBox",{value:"0 0 "+a.width+" "+a.height}),a.blockSize=a.height/e.rowCount,window&&(a.onWindowResize=function(t){var e=a._isPortrait;a._isPortrait=window.innerHeight>window.innerWidth,a.updateLastSizeEvent(),a.onBoardResize.emit(a.lastSizeEvent),!0===e&&!1===a._isPortrait&&setTimeout((function(){return a.onWindowResize()}),16)},window.addEventListener("resize",a.onWindowResize)),a}return w(e,t),Object.defineProperty(e.prototype,"isPortrait",{get:function(){return this._isPortrait},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this;this.updateLastSizeEvent(),this.engine.boardSynced.subscribe((function(){return t.syncPiecesToBlocks()})),this.engine.stateChanged.subscribe((function(e){return t.onStateChanged(e)})),this.registerDragAndDrop()},e.prototype.ngAfterContentInit=function(){var t=this,e=this.zone.onStable.subscribe((function(){t.onWindowResize(null),e.unsubscribe()}))},e.prototype.onStateChanged=function(t){var e;if(this.ctrl.isGameOver(t)){var n=this.ctrl.winner===i.c.BLACK?"Black":"White";e=t===i.d.CHECKMATE?{title:"GAME OVER",message:n+" wins!"}:{title:"GAME OVER",message:"It's a draw!"}}if(e)if(this.boardDialogService){var o=this.boardElRef.nativeElement.getBoundingClientRect(),r=this.lastSizeEvent,s={bottom:o.top+r.clientHeight+r.yOffset,height:r.clientHeight,left:o.left+r.xOffset,right:o.left+r.clientWidth+r.xOffset,top:o.top+r.yOffset,width:r.clientWidth};this.boardDialogService.showMessage(e,s)}else this.banner=e,this.cdr.markForCheck();i.d[t]},e.prototype.onPieceDrag=function(t){this.dragPiece=t.piece},e.prototype.ngOnDestroy=function(){this.clearSubscriptions(),this.onWindowResize&&window.removeEventListener("resize",this.onWindowResize)},e.prototype.newGame=function(){return this.busy(!1),this.blockUi(!1),this.banner=void 0,this.cdr.markForCheck(),Promise.resolve()},e.prototype.clearSubscriptions=function(){for(;this.rxWaste.length>0;)this.rxWaste.pop().unsubscribe()},e.prototype.blockUi=function(t){this.isDisabled=t,this.cdr.markForCheck()},e.prototype.busy=function(t){this.isBusy=t,this.cdr.markForCheck()},e.prototype.highlight=function(t){this.highlighted=t,this.cdr.markForCheck()},Object.defineProperty(e.prototype,"ratioX",{get:function(){return this.width/this.lastSizeEvent.clientHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ratioY",{get:function(){return this.height/this.lastSizeEvent.clientWidth},enumerable:!0,configurable:!0}),e.prototype.registerDragAndDrop=function(){var t=this,e=this.boardElRef.nativeElement,n=r.Observable.fromEvent(e,"mousedown"),o=r.Observable.fromEvent(e,"touchstart"),s=r.Observable.fromEvent(e,"mousemove"),a=r.Observable.fromEvent(e,"touchmove"),c=r.Observable.fromEvent(document,"mouseup"),u=r.Observable.fromEvent(document,"touchend"),f=n.mergeMap((function(n){if(t.isDisabled||!t.dragPiece)return[];if(t.dragPiece.piece.color!==t.engine.turn())return[];var o=t.ratioX,i=t.ratioY;t.dragPiece.dragStart();var r=n.pageX,a=n.pageY;return t.highlight(t.engine.moves(t.dragPiece.piece)),s.map((function(t){t.preventDefault();var n=e.currentScale,s=e.currentTranslate,c=(t.pageX-s.x)/n,u=(t.pageY-s.y)/n,f={x:c-r,y:u-a};return r=t.pageX,a=t.pageY,f.x*=o,f.y*=i,f})).takeUntil(c)})),p=o.mergeMap((function(n){if(t.isDisabled)return[];if(n.touches.length<1)return[];var o=e.getBoundingClientRect(),r=o.left,s=o.top;r+=t.lastSizeEvent.xOffset,s+=t.lastSizeEvent.yOffset;var c=function(t){return{x:t.touches[0].pageX-r,y:t.touches[0].pageY-s}},f=c(n),p=i.e.pointToIndex(f.x*t.ratioX,f.y*t.ratioY);if(t.dragPiece=t.pieces.toArray().filter((function(t){return t.piece.block.index===p}))[0],!t.dragPiece)return[];if(t.dragPiece.piece.color!==t.engine.turn())return[];var h=t.ratioX,l=t.ratioY;return t.dragPiece.dragStart(),t.highlight(t.engine.moves(t.dragPiece.piece)),a.map((function(t){t.preventDefault();var n=c(t),o=e.currentScale,i=e.currentTranslate;n.x=(n.x-i.x)/o,n.y=(n.y-i.y)/o;var r={x:(n.x-f.x)*h,y:(n.y-f.y)*l};return f.x=n.x,f.y=n.y,r})).takeUntil(u)})),h=f.subscribe((function(e){return e&&t.dragPiece.setCoordinates(e.x,e.y)}));this.rxWaste.push(h),h=p.subscribe((function(e){return e&&t.dragPiece.setCoordinates(e.x,e.y)})),this.rxWaste.push(h),h=c.subscribe((function(e){return t.dragPiece&&t.dropPiece(e)})),this.rxWaste.push(h),h=u.subscribe((function(e){return t.dragPiece&&t.dropPiece(e)})),this.rxWaste.push(h)},e.prototype.askPromotionType=function(){return Promise.resolve(i.f.QUEEN)},e.prototype.move=function(t){var e=this,n=this.pieces.toArray().filter((function(e){return e.piece===t}))[0];if(n){var o=this.blocks.toArray()[t.block.index];n.block=o,n.reset(150)}else this.engine.pieces.indexOf(t)>-1&&setTimeout((function(){return e.move(t)}))},e.prototype.updateLastSizeEvent=function(){var t=this.boardElRef.nativeElement;this.lastSizeEvent={height:t.clientHeight,width:t.clientWidth,clientHeight:Math.min(t.clientHeight||t.parentNode.clientHeight,t.clientWidth||t.parentNode.clientWidth),clientWidth:Math.min(t.clientWidth||t.parentNode.clientWidth,t.clientHeight||t.parentNode.clientHeight),xOffset:t.clientWidth>t.clientHeight?t.clientWidth/2-t.clientHeight/2:0,yOffset:t.clientHeight>t.clientWidth?t.clientHeight/2-t.clientWidth/2:0}},e.prototype.dropPiece=function(t){var e=this;if(!this.isDisabled){var n=t.clientX,o=t.clientY;void 0!==n&&void 0!==o||(n=t.changedTouches[0].clientX,o=t.changedTouches[0].clientY);var r=this.boardElRef.nativeElement.getBoundingClientRect();n-=r.left,o-=r.top,r.width>r.height?n-=r.width/2-r.height/2:o-=r.height/2-r.width/2;var s=i.e.pointToIndex(n*this.ratioX,o*this.ratioY),a=this.blocks.toArray()[s];a?this.ctrl.move(this.dragPiece.piece,a.block).then((function(t){t.invalid?e.dragPiece.reset(150):t.isCastlingMove()&&e.syncPiecesToBlocks(),e.endDragAndDrop()})):this.endDragAndDrop()}},e.prototype.endDragAndDrop=function(){this.dragPiece.dragEnd(),this.dragPiece=void 0,this.highlighted=[]},e.prototype.syncPiecesToBlocks=function(){var t=this.pieces.toArray();this.blocks.toArray().forEach((function(e){for(var n,o=0,i=t.length;o<i;o++)if(e.block===t[o].piece.block){n=!0,t[o].block=e,t[o].reset(150);break}n||(e.piece=void 0)}))},e.decorators=[{type:o._0,args:[{selector:"chess-board",styles:[":host { display: block; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; } .xyz { position: relative; display: block; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; overflow-y: hidden; margin: auto; height: 100%; } .chess-board { max-height: 100%; max-width: 100%; } @media (orientation: portrait) { .chess-board { height: 100%; } } .stop-watch-svg circle { fill: none; stroke: rgba(255, 255, 255, 0.75); } .stop-watch-svg rect { fill: rgba(255, 255, 255, 0.75); } .basel { stroke-width: 20; stroke-miterlimit: 10; } .hand { stroke-width: 50; stroke-miterlimit: 10; stroke-dasharray: 160 160; stroke-dashoffset: 160; transform: rotate(-90deg); transform-origin: 50% 50%; -webkit-animation: 2s stopWatchHandAnimation linear forwards; animation: 2s stopWatchHandAnimation linear forwards; animation-iteration-count: infinite; } .sw-button { -webkit-animation: 4s stopWatchButtonAnimation linear forwards; animation: 4s stopWatchButtonAnimation linear forwards; animation-iteration-count: infinite; } @keyframes stopWatchHandAnimation { 0% { stroke-dasharray: 160 160; stroke-dashoffset: 160; stroke-width: 50px; } 100% { stroke-dasharray: 160 160; stroke-dashoffset: -160; stroke-width: 50px; } } @keyframes stopWatchButtonAnimation { 0% { transform: scale(1, 1); } 98% { transform: scale(1, 1); } 100% { transform: scale(1, 0.1); } } "],template:'<div class="xyz svg-chess-board"> <svg [attr.viewBox]="viewBox" class="chess-board" preserveAspectRatio="xMidYMid meet" #board> \x3c!-- Drop shadow for a piece --\x3e <defs> <filter id="pieceDropShadow" x="0" y="0" width="500%" height="500%"> <feOffset result="offsetblur" in="SourceGraphic" dx="5" dy="5" /> <feGaussianBlur result="blurOut" in="offsetblur" stdDeviation="4.2" /> <feBlend in="SourceGraphic" in2="blurOut" mode="normal" x="-10" /> </filter> <filter id="blockHighlight"> <feOffset dy="8" dx="8"/> <feGaussianBlur stdDeviation="2.5" result="offset-blur"/> <feComposite operator="out" in2="offset-blur" in="SourceGraphic" result="inverse"/> <feFlood result="color" flood-color="#b33e00" flood-opacity=".8"/> <feComposite operator="in" in2="inverse" in="color" result="shadow"/> <feComposite in2="SourceGraphic" in="shadow"/> </filter> </defs> <svg:g *ngFor="let block of engine.blocks" chess-block [block]="block" [size]="blockSize"> </svg:g> <svg:g *ngFor="let hl of highlighted" chess-highlight [block]="hl" [size]="blockSize"> </svg:g> <svg:g *ngFor="let piece of engine.pieces" chess-piece [piece]="piece" (pieceDrag)="onPieceDrag($event)"> </svg:g> <svg:g *ngIf="banner" chess-banner [title]="banner.title" [message]="banner.message"> </svg:g> <svg class="stop-watch-svg" width="92.5" height="110" viewBox="0 0 185 220" *ngIf="isBusy"> <g> <circle class="hand" cx="90" cy="130" r="25" /> <circle class="basel" cx="90" cy="130" r="79.2" /> <rect x="60" y="0" width="60" height="20" /> <rect x="80" y="19" width="20" height="11" /> <g transform="translate(170, 75) rotate(227)"> <rect class="sw-button" width="31.3" height="20.6" /> </g> </g> </svg> </svg> <ng-container *ngIf="lastSizeEvent"> <ng-container *ngIf="isPortrait"> <div style="position: absolute; left: 0; right: 0; top: 0;" [style.height]="lastSizeEvent.yOffset + \'px\'" [style.bottom]="(lastSizeEvent.yOffset + lastSizeEvent.clientHeight) + \'px\'"> <ng-content select=".board-content-top"></ng-content> </div> <div style="position: absolute; left: 0; right: 0; bottom: 0;" [style.height]="lastSizeEvent.yOffset + \'px\'" [style.top]="(lastSizeEvent.yOffset + lastSizeEvent.clientHeight) + \'px\'"> <ng-content select=".board-content-bottom"></ng-content> </div> </ng-container> <ng-container *ngIf="!isPortrait"> <div style="position: absolute; left: 0; top: 0; bottom: 0;" [style.width]="lastSizeEvent.xOffset + \'px\'"> <ng-content select=".board-content-left"></ng-content> </div> <div style="position: absolute; top: 0; bottom: 0;" [style.width]="lastSizeEvent.xOffset + \'px\'" [style.left]="(lastSizeEvent.xOffset + lastSizeEvent.clientWidth) + \'px\'"> <ng-content select=".board-content-right"></ng-content> </div> </ng-container> </ng-container> </div>',changeDetection:o._1.OnPush}]}],e.ctorParameters=function(){return[{type:i.a},{type:o.Z},{type:o.k},{type:i.g,decorators:[{type:o.m}]}]},e.propDecorators={boardElRef:[{type:o._3,args:["board"]}],blocks:[{type:o._4,args:[d]}],pieces:[{type:o._4,args:[y]}],onBoardResize:[{type:o._2}]},e})(i.h),x=(function(){function t(){}return t.decorators=[{type:o.z,args:[{declarations:[k,d,y,m,b],imports:[p.e],exports:[k,d,y,m,b]}]}],t.ctorParameters=function(){return[]},t})()},e17S:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var o=n("3j3K"),i=n("fYnu"),r=n("S/nS"),s=n("5hkn"),a=n("Mi9a"),c=n("EKZ2"),u=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),f=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},p=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},h=(function(){function t(t,e,n){this.color=t,this.type=e,this.aiIndex=n}return Object.defineProperty(t.prototype,"rawtype",{get:function(){return r.i[this.type]},set:function(t){this.type=r.i[t]},enumerable:!0,configurable:!0}),t})(),l="undefined"!=typeof Worker,d=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.create=function(){return n.i(a.a)(l)},e})(s.a),g=(function(){function t(t){this.dialog=t,this.aiLevels=[1,2,3,4,5,6,7,8,9,10],this.black=new h(r.c.BLACK,r.i.AI,10),this.white=new h(r.c.WHITE,r.i.HUMAN,10),this.workerSupported="undefined"!=typeof Worker,this.boardRect={height:0,width:0,clientHeight:0,clientWidth:0,xOffset:0,yOffset:0}}return t.prototype.ngAfterViewInit=function(){var t=this;this.ctrl=this.board.ctrl,this.ctrl.stateChanged.subscribe((function(e){t.ctrl.isGameOver(e)&&(t.board.blockUi(!0),t.isInit=!1)}));var e=this.dialog.open(this.spinner,{disableClose:!0});this.ctrl.init().then((function(){return e.close()}))},t.prototype.ngOnDestroy=function(){this.ctrl.destroy()},t.prototype.onBoardResize=function(t){this.boardRect=t},t.prototype.onPlayerTypeChange=function(t,e){this.ctrl.setPlayer(e.color,r.i[t])},t.prototype.onAILevelChange=function(t,e){this.ctrl.setPlayer(e.color,e.type,e.aiIndex=t.value)},t.prototype.onNewGame=function(){this.ctrl.setPlayer(this.black.color,this.black.type,this.black.aiIndex).setPlayer(this.white.color,this.white.type,this.white.aiIndex).newGame(),this.isInit=!0},t.prototype.onStop=function(){this.ctrl.aiStop()},t.prototype.hint=function(){var t=this;this.ctrl.aiNextMove().then((function(e){return t.ctrl.highlight(e.to,e.from)}))},f([n.i(o._3)("board"),p("design:type",r.h)],t.prototype,"board",void 0),f([n.i(o._3)("spinner"),p("design:type",o.S)],t.prototype,"spinner",void 0),t=f([n.i(o._0)({selector:"game",providers:[{provide:s.a,useClass:d},{provide:r.g,useClass:c.a}].concat(s.b),styles:[n("z7vK")],template:n("PuJq")}),p("design:paramtypes",[i.G])],t)})()},kb0c:function(t,e,n){"use strict";function o(t){return"string"==typeof t?t:t&&t.data}function i(t,e){return t[e]}n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return N}));var r={};r.uci=0,r.debug=1,r.isready=2,r.setoption=3,r.register=4,r.ucinewgame=5,r.position=6,r.go=7,r.stop=8,r.ponderhit=9,r.quit=10,r[r.uci]="uci",r[r.debug]="debug",r[r.isready]="isready",r[r.setoption]="setoption",r[r.register]="register",r[r.ucinewgame]="ucinewgame",r[r.position]="position",r[r.go]="go",r[r.stop]="stop",r[r.ponderhit]="ponderhit",r[r.quit]="quit";var s={};s.id=0,s.uciok=1,s.readyok=2,s.bestmove=3,s.copyprotection=4,s.registration=5,s.info=6,s.option=7,s[s.id]="id",s[s.uciok]="uciok",s[s.readyok]="readyok",s[s.bestmove]="bestmove",s[s.copyprotection]="copyprotection",s[s.registration]="registration",s[s.info]="info",s[s.option]="option";var a={};a.fen=0,a.startpos=1,a[a.fen]="fen",a[a.startpos]="startpos";var c={};c.WriteDebugLog=0,c.Contempt=1,c.Mobility$Midgame$=2,c.Mobility$Endgame$=3,c.PawnStructure$Midgame$=4,c.PawnStructure$Endgame$=5,c.PassedPawns$Midgame$=6,c.PassedPawns$Endgame$=7,c.Space=8,c.KingSafety=9,c.MinSplitDepth=10,c.Threads=11,c.Hash=12,c.Ponder=13,c.MultiPV=14,c.SkillLevel=15,c.SkillLevelMaximumError=16,c.SkillLevelProbability=17,c.MoveOverhead=18,c.MinimumThinkingTime=19,c.SlowMover=20,c.UCI_Chess960=21,c.ClearHash=22,c[c.WriteDebugLog]="WriteDebugLog",c[c.Contempt]="Contempt",c[c.Mobility$Midgame$]="Mobility$Midgame$",c[c.Mobility$Endgame$]="Mobility$Endgame$",c[c.PawnStructure$Midgame$]="PawnStructure$Midgame$",c[c.PawnStructure$Endgame$]="PawnStructure$Endgame$",c[c.PassedPawns$Midgame$]="PassedPawns$Midgame$",c[c.PassedPawns$Endgame$]="PassedPawns$Endgame$",c[c.Space]="Space",c[c.KingSafety]="KingSafety",c[c.MinSplitDepth]="MinSplitDepth",c[c.Threads]="Threads",c[c.Hash]="Hash",c[c.Ponder]="Ponder",c[c.MultiPV]="MultiPV",c[c.SkillLevel]="SkillLevel",c[c.SkillLevelMaximumError]="SkillLevelMaximumError",c[c.SkillLevelProbability]="SkillLevelProbability",c[c.MoveOverhead]="MoveOverhead",c[c.MinimumThinkingTime]="MinimumThinkingTime",c[c.SlowMover]="SlowMover",c[c.UCI_Chess960]="UCI_Chess960",c[c.ClearHash]="ClearHash";var u=/^[a-h]\d[a-h]\d[qkbn]?$/,f=(function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t})(),p=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),h=(function(t){function e(e){return t.call(this,e)||this}return p(e,t),e})(Error),l=(function(t){function e(e){var n=t.call(this)||this;return n.cmd=e,n}return p(e,t),e})(f),d=(function(){function t(){this.que=[]}return t.prototype.resolve=function(t,e){var n=this.indexOf(t);return-1!==n&&(this.popIdx(n).resolve(e),!0)},t.prototype.reject=function(t,e){var n=this.indexOf(t);return-1!==n&&(this.popIdx(n).reject(e),!0)},t.prototype.add=function(t){if(this.exists(t.cmd))throw new h("UCI command "+s[t.cmd]+" is already queued.");return this.que.push(t),t},t.prototype.indexOf=function(t){for(var e=0,n=this.que.length;e<n;e++)if(this.que[e].cmd===t)return e;return-1},t.prototype.find=function(t){var e=this.indexOf(t);return e>-1?this.que[e]:void 0},t.prototype.exists=function(t){return this.indexOf(t)>-1},t.prototype.clear=function(){return this.que.splice(0,this.que.length-1)},t.prototype.popIdx=function(t){return this.que.splice(t,1)[0]},t})(),g=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),y=(function(){function t(t,e){t&&Object.defineProperty(this,"defaultHandler",{value:t}),e&&Object.defineProperty(this,"unknownHandler",{value:e})}return t.prototype.route=function(t){this.__debug__&&console.log(t);var e=t.split(" "),n=this.transformCommand(e.shift());return this[this._getHandlerName(n)](n,e)},t.prototype._getHandlerName=function(t){var e=this.getHandlerName(t);return e=e?"function"==typeof this[e]?e:"defaultHandler":"unknownHandler"},t.prototype.transformCommand=function(t){return t},t.prototype.getHandlerName=function(t){},t.prototype.defaultHandler=function(t,e){},t.prototype.unknownHandler=function(t,e){},t})(),m=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return g(e,t),e.prototype.transformCommand=function(t){return s[t]||t},e.prototype.getHandlerName=function(t){return t>=0?s[t]+"Handler":void 0},e})(y),v=(function(){function t(){}return t.prototype.$request=function(){var t=["go"];for(var e in this)if(this.hasOwnProperty(e)){var n=this[e];void 0!==n&&(t.push(e),Array.isArray(n)&&(n=n.join(" ")),t.push(n))}return t.join(" ")},t})(),b=(function(){function t(t){var e=this;this.$$=new v,"function"==typeof t&&(this.$post=function(){return t(e.$requestObject())})}return t.prototype.$post=function(){throw new Error("Not Implemented")},t.prototype.$requestObject=function(){return this.$$},t.prototype.$request=function(){return this.$$.$request()},t.prototype.searchmoves=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.$$.searchmoves=t,this},t.prototype.ponder=function(t){return t?this.$$.ponder=!0:delete this.$$.ponder,this},t.prototype.wtime=function(t){return this.$$.wtime=t,this},t.prototype.btime=function(t){return this.$$.btime=t,this},t.prototype.winc=function(t){return this.$$.winc=t,this},t.prototype.binc=function(t){return this.$$.binc=t,this},t.prototype.movestogo=function(t){return this.$$.movestogo=t,this},t.prototype.depth=function(t){return this.$$.depth=t,this},t.prototype.nodes=function(t){return this.$$.nodes=t,this},t.prototype.mate=function(t){return this.$$.mate=t,this},t.prototype.movetime=function(t){return this.$$.movetime=t,this},t.prototype.infinite=function(t){return t?this.$$.infinite=!0:delete this.$$.infinite,this},t})(),w=(function(){var t=function(t,e){return{jump:1,value:e[t+1]}},e=function(t,e){var n=[],o=e.length,i=t+1,r=0;for(i;i<o&&u.exec(e[i]);i++)n.push(e[i]),r++;return{jump:r,value:n}},n={};return["depth","seldepth","time","nodes","multipv","currmove","currmovenumber","hashfull","nps","tbhits","sbhits","cpuload","string"].reduce((function(e,n){return e[n]=t,e}),n),n.pv=e,n.refutation=e,n.score=function(t,e){var n={},o=e.length,i=t+1,r=0;for(i;i<o;i++)switch(e[i]){case"cp":case"mate":n[e[i]]=e[++i],r+=2;break;case"lowerbound":case"upperbound":n[e[i]]=!0,r++;break;default:return{jump:r,value:n}}},n.currline=function(t,n){var o={},i=(n.length,t+1),r=0;u.exec(n[i])||(o.cpunr=n[i].split(",").map((function(t){return Number(t)})).filter((function(t){return!isNaN(t)})),r++);var s=e(i+r,n);return r+=s.jump,o.moves=s.value,{jump:r,value:o}},n})(),k=(function(){function t(t){for(var e=0,n=t.length;e<n;e++){var o=t[e];if(o in w){var i=w[o](e,t);e+=i.jump,this[o]=i.value}}}return t})(),x=(function(){function t(t){this.move=t[0],3===t.length&&"ponder"===t[1]&&(this.ponder=t[2])}return t})(),O=(function(){function t(){}return t})(),C=(function(){function t(){}return Object.defineProperty(t.prototype,"propName",{get:function(){return i(c,this.name)},enumerable:!0,configurable:!0}),t.prototype.$request=function(){return"setoption name "+i(c,this.name).replace(/([A-Z])/g,(function(t){return" "+t})).replace(/\$/," (").replace(/\$$/,")").trim()+" "+(this.value?"value "+this.value:"")},t.create=function(e,n){var o=new t;return o.name=e,o.value=n,o},t})(),P=(function(){function t(t){var e=this;this.$$=new C,"function"==typeof t&&(this.$post=function(){return t(e.$requestObject())})}return t.prototype.$post=function(){throw new Error("Not Implemented")},t.prototype.$requestObject=function(){return this.$$},t.prototype.$request=function(){return this.$$.$request()},t.prototype.name=function(t){return this.$$.name=t,this},t.prototype.value=function(t){return this.$$.value=t,this},t})(),_=(function(){var t=["name","type","default","min","max"],e=function(t,e){return{jump:1,value:e[t+1]}};return{name:function(e,n){var o=[],i=n.length,r=e+1,s=0;for(r;r<i&&-1===t.indexOf(n[r]);r++)o.push(n[r]),s++;return{jump:s,value:o.join(" ")}},type:function(t,e){var n;switch(e[t+1]){case"check":n=function(t){return"true"===t};break;case"spin":n=function(t){return Number(t)};break;default:n=function(t){return t}}return{jump:1,value:n}},default:e,min:e,max:e}})(),S=(function(){function t(t){var e=0,n=t.length;if("name"===t[e]){var o=_.name(e++,t);if(this.name=o.value,this.propName=this.name.replace(/\s/g,"").replace("(","$").replace(")","$"),"type"===t[e+=o.jump]){var i=_.type(e,t).value;for(e+=2;e<n;e++){var r=t[e];r in _&&(o=_[r](e,t),e+=o.jump,this[r]=i(o.value))}"default"in this&&(this.value=this.default)}}}return t})(),E=(function(){function t(){this.id={},this.option={}}return t})(),M=this&&this.__extends||(function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),N=(function(t){function e(e,n){var o=t.call(this)||this;return o.stockfishFactory=e,o.isInit=!1,o.que=new d,!0===n&&(o.__debug__=!0),o}return M(e,t),e.prototype.uci=function(){var t=this,e=s.uciok;return this.isInit?Promise.resolve():this.que.exists(e)?this.que.find(e).promise:this.init().then((function(){return t.post(i(r,r.uci)),t.que.add(new l(e)).promise.then((function(){t.isInit=!0}))}))},e.prototype.isready=function(){var t=this,e=s.readyok,n=this.que.find(e)||this.que.add(new l(e));return this.uci().then((function(){return t.post(i(r,r.isready)),n.promise}))},e.prototype.ucinewgame=function(){var t,e=this,n=s.readyok;return this.isInit?(t=this.que.find(n))?t.promise.then((function(){return e.ucinewgame()})):(this.post(i(r,r.ucinewgame)),this.isready()):this.isready().then((function(){return e.ucinewgame()}))},e.prototype.position=function(t,e){var n=[i(r,r.position),i(a,t)];if(t===a.fen&&!e)throw new Error("FEN positioning requires a FEN string");return t===a.startpos&&e&&n.push("moves"),e&&n.push(e),this.post(n.join(" ")),this},e.prototype.setoption=function(t,e){return"number"==typeof t?this.setoption(C.create(t,e)):(this.post(t.$request()),this.meta.option[t.propName].value=t.value,this)},e.prototype.setoptionDyn=function(){var t=this;return new P(function(e){return t.setoption(e)})},e.prototype.go=function(t,e){var n=this;"boolean"==typeof t&&(e=t,t=void 0),t=t||new v;var o=s.bestmove;return this.que.exists(o)?Promise.reject(new Error("Engine is already processing a go instruction.")):this.isready().then((function(){var i=new l(o);return i.data=!0===e?[]:void 0,n.que.add(i),n.post("string"==typeof t?t:t.$request()),i.promise}))},e.prototype.goDyn=function(t){var e=this;return new b(function(n){return e.go(n.$request(),t)})},e.prototype.stop=function(){var t=this,e=s.readyok,n=this.que.find(e)||this.que.find(s.bestmove);return n&&n.cmd===e?n.promise.then((function(){return t.stop()})):(this.post(i(r,r.stop)),n?n.promise:this.isready())},e.prototype.destroy=function(){this.isInit=!1,this.meta=void 0,this.sf&&("function"==typeof this.sf.terminate&&this.sf.terminate(),this.sf.onmessage=void 0,this.sf=void 0)},e.prototype.init=function(){var t=this;return this.meta=new E,this.stockfishFactory().then((function(e){t.sf=e,t.createStream()}))},e.prototype.post=function(t){this.__debug__&&console.log(t),this.sf.postMessage(t)},e.prototype.createStream=function(){var t=this;this.sf.onmessage=function(e){var n=o(e);n&&t.route(n)}},e.prototype.bestmoveHandler=function(t,e){var n=this.que.find(s.bestmove),o=new O;o.bestMove=new x(e),o.info=Array.isArray(n.data)?n.data:[],this.que.resolve(t,o)},e.prototype.idHandler=function(t,e){e.length&&(this.meta.id[e.shift()]=e.join(" "))},e.prototype.optionHandler=function(t,e){var n=new S(e);void 0===c[n.propName]&&console.warn("Unrecognized option name: "+n.propName),this.meta.option[n.propName]=n},e.prototype.defaultHandler=function(t,e){switch(t){case s.uciok:case s.readyok:this.que.resolve(t);break;case s.info:var n=this.que.find(s.bestmove);n&&n.data&&n.data.push(new k(e))}},e.prototype.unknownHandler=function(t,e){this.__debug__&&console.log("UNKNOWN HANDLER -> ["+t+"]: "+e.join(" "))},e})(m)},qAGD:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var o=n("Qbdm"),i=n("3j3K"),r=[],s=function(t){return t};n.i(i.a)(),s=function(t){return n.i(o.a)(),t},r=r.slice();var a=s,c=r.slice()},"yp+s":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n("3j3K"),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},r=(function(){function t(){this._state={}}return Object.defineProperty(t.prototype,"state",{get:function(){return this._state=this._clone(this._state)},set:function(t){throw new Error("do not mutate the `.state` directly")},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=this.state;return e.hasOwnProperty(t)?e[t]:e},t.prototype.set=function(t,e){return this._state[t]=e},t.prototype._clone=function(t){return JSON.parse(JSON.stringify(t))},t=i([n.i(o.c)()],t)})()},ypwn:function(t,e){t.exports='<div class="home">\n  <h1>Angular 2 Chess</h1>\n  <p>A plugin oriented chess module built with Angular</p>\n  <p>To play, click of the "Game" menu on the top-right corner.</p>\n  <p>For more infomation please visit the <a href="https://github.com/shlomiassaf/ng2-chess" target="_blank">GitHub page</a></p>\n  <div class="board-container">\n    <chess-board class="svg-chess-board" #board></chess-board>\n  </div>\n  <p style="color: #1fad83">Running on Angular @ 4.3.x</p>\n</div>\n'},z7vK:function(t,e,n){var o=n("N0OX");t.exports="string"==typeof o?o:o.toString()}},["QGt1"]);